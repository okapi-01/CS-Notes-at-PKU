<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left: 0.25em solid rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
  --mermaid-theme: night;
}

[lang='mermaid'] .label {
  color: #333;
}

/* CSS Document */

/** code highlight */

.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable {
    color: #b8bfc6;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

.CodeMirror-gutters {
    border-right: none;
}

/* CSS Document */

/** markdown source **/
.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property
{
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
	color: #8aa1e1;
}/* 显示原始URL的样式 */
@import "";
@import "";
@import "";

:root {
    --bg-color:  #283339;
    --side-bar-bg-color: #242E33;
    --text-color: #d3d3d3;

    --select-text-bg-color:#4a89dc;

    --item-hover-bg-color: #0a0d16;
    --control-text-color: #b7b7b7;
    --control-text-hover-color: #eee;
    --window-border: 1px solid #555;

    --active-file-bg-color: rgb(34, 34, 34);
    --active-file-border-color: #8d8df0;

    --primary-color: #a3d5fe;

    --active-file-text-color: white;
    --item-hover-bg-color: #70717d;
    --item-hover-text-color: white;
    --primary-color: #6dc1e7;

    --rawblock-edit-panel-bd: #333;

    --search-select-bg-color: #428bca;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    letter-spacing: 0.05em;
}

html,
body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    background: #363B40;
    background: var(--bg-color);
    fill: currentColor;
    line-height: 1.625rem;
}

#write {
    max-width: 914px;
}


@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
    color: #b8bfc6;
    border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after {
    background: #333;
}

.native-window #md-notification {
    border: 1px solid #70717d;
}

.popover.bottom > .arrow:after {
    border-bottom-color: #333;
}

html,
body,
button,
input,
select,
textarea {
    font-family: "segoe print", "Helvetica Neue", Helvetica, "Segoe UI", Arial, 'Segoe UI Emoji', sans-serif;
}

hr {
    height: 2px;
    border: 0;
    margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: "segoe print", "Lucida Grande", "Corbel", sans-serif;
    font-weight: normal;
    clear: both;
    -ms-word-wrap: break-word;
    word-wrap: break-word;
    margin: 0;
    padding: 0;
    color: #DEDEDE
}

/* Ensure all heading levels strictly occupy their own line. This overrides any inline-block
   declarations elsewhere that might cause headings to appear inline with previous lines. */
#write h1,
#write h2,
#write h3,
#write h4{
    display: block !important;
    width: 100% !important;
    clear: both !important;
    box-sizing: border-box; /* keep padding/border inside width */
}

/* Center h3 text in the document area */
/* Center h1 text in the document area */
#write h1 {
    text-align: center !important;
}

#write h3 {
    text-align: center !important;
}

h1 {
    font-size: 2.5rem;
    /* 36px */
    line-height: 2.75rem;
    /* 40px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: 0.04em;
}

h2 {
    font-size: 1.63rem;
    /* 24px */
    line-height: 1.875rem;
    /* 30px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: 0.05em;
    font-weight: bold;
}

h3 {
    font-size: 1.17rem;
    /* 18px */
    line-height: 1.5rem;
    /* 24px */
    margin-top: 1.5rem;
    margin-bottom: 1.2rem;
    /* 24px */
    letter-spacing: 0.05em;
    font-weight: bold;
    display: inline-block;
    background-color: #28a3f59d;
    padding: 3px 8px;
    border-radius: 6px;
}

h4 {
    font-size: 1.12rem;
    /* 16px */
    line-height: 1.375rem;
    /* 22px */
    margin-top: 1rem;
    margin-bottom: 1.2rem;
    /* 24px */
    color: white;
    border-left: 4px solid #289dec;
    padding-left: 15px;
    letter-spacing: 0.05em;
}

h5 {
    font-size: 0.97rem;
    /* 16px */
    line-height: 1.25rem;
    /* 22px */
    margin-top: 0.75rem;
    margin-bottom: 1rem;
    /* 24px */
    font-weight: bold;
    border-bottom: 2px solid #289dec;
    letter-spacing: 0.05em;
    display: inline-block;
}

h6 {
    font-size: 0.93rem;
    /* 16px */
    line-height: 1rem;
    letter-spacing: 0.05em;
    /* 16px */
    margin-top: 1rem;
    margin-bottom: 0.75rem;
    color: white;
}

@media (min-width: 980px) {
    h3.md-focus:before,
    h4.md-focus:before,
    h5.md-focus:before,
    h6.md-focus:before {
        color: #ddd;
        border: 1px solid #ddd;
        border-radius: 3px;
        position: absolute;
        left: -1.642857143rem;
        top: .357142857rem;
        float: left;
        font-size: 9px;
        padding-left: 2px;
        padding-right: 2px;
        vertical-align: bottom;
        font-weight: normal;
        line-height: normal;
    }

    h3.md-focus:before {
        content: 'h3';
    }

    h4.md-focus:before {
        content: 'h4';
    }

    h5.md-focus:before {
        content: 'h5';
        top: 0px;
    }

    h6.md-focus:before {
        content: 'h6';
        top: 0px;
    }
}

a {
    text-decoration: none;
    outline: 0;
}

a:hover {
    outline: 0;
}

a:focus {
    outline: thin dotted;
}

sup.md-footnote {
    background-color: #555;
    color: #ddd;
}

p {
    -ms-word-wrap: break-word;
    word-wrap: break-word;
}

#write > p,
#write > div > p:not(.md-alert p):not(blockquote p):not(ul p):not(ol p) {
    margin-bottom: 0.75rem !important; /* 数值可调整，默认1.5rem→0.75rem，越小间距越窄 */
}

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode {
    margin-top: 0;
    margin-bottom: 1.5rem;
    /* 24px */
}

audio:not([controls]) {
    display: none;
}

[hidden] {
    display: none;
}

::-moz-selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

*.in-text-selection,
::selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

ul,
ol {
    padding: 0 0 0 1.875rem;
    /* 30px */
}

ul {
    list-style: square;
}

ol {
    list-style: decimal;
}

ul ul,
ol ol,
ul ol,
ol ul {
    margin: 0;
}

b,
th,
dt,
strong {
    font-weight: bold;
}

i,
em,
dfn,
cite {
    font-style: normal;
    font-size: 0.95em;
    color: #b5cea8
}

blockquote {
    /* left indent and vertical spacing consistent with lists */
    padding-left: 20px;
    margin: 0 0 1.5rem 1.5rem;
    border-left: solid 2px #474d54;
}
/*
blockquote {
    padding-left: 1.5rem;
    margin: 0 0 1.5rem 1.5rem;
    border-left: solid 2px #474d54;
    padding-left: 20px;
    margin-top: 10px;
}*/

pre,
code,
kbd,
tt,
var {
    font-size: 0.875em;
    font-family: Monaco, Consolas, "Andale Mono", "DejaVu Sans Mono", monospace;
}

code,
tt,
var {
    background: rgba(255, 255, 255, 0.055);
}

kbd {
    padding: 2px 4px;
    font-size: 90%;
    color: #fff;
    background-color: #333;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
}

pre.md-fences {
    padding: 10px 10px 10px 30px;
    margin-bottom: 20px;
    background: #1f282d;
}

.CodeMirror-gutters {
    background: #333;
    border-right: 1px solid transparent;
}

.enable-diagrams pre.md-fences[lang="sequence"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="flow"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="mermaid"] .code-tooltip {
    bottom: -2.2em;
    right: 4px;
}

code,
kbd,
tt,
var {
    padding: 2px 5px;
}

table {
    max-width: 100%;
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

th,
td {
    padding: 5px 10px;
    vertical-align: top;
}

a {
    -webkit-transition: all .2s ease-in-out;
    transition: all .2s ease-in-out;
}

hr {
    background: #474d54;
    /* variable */
}

h1 {
    margin-top: 2em;
}

a {
    color: #289dec;
    /* text-decoration: underline;*/
}

a:hover {
    color: #43a9ec;
}

.md-url, .md-def-url, /*.md-meta, .md-plain,*/ .md-link-url {
    color: #d3d3d3eb;
}

.md-inline-math script {
    color: #81b1db;
}

b,
th,
dt,
strong {
    color: #e4b763;
    /* variable */
}

mark {
    background: #a7c080;
}

blockquote {
    color: #9DA2A6;
}

/* Ensure blockquote uses the same line-height as the document */
blockquote,
blockquote p,
blockquote ul,
blockquote ol,
blockquote li,
blockquote dd {
    line-height: 1.625rem; /* match document line-height */
}

/* Inside blockquotes, paragraphs should be compact like list items (no extra margin) */
blockquote p {
    margin-bottom: 0.5rem;
}

/* The blockquote itself has a bottom margin, like a list block */
blockquote {
    margin-top: 1rem;
    margin-bottom: 1.5rem;
}
/*
blockquote {
    padding-left: 1.5rem;
    margin: 0 0 1.5rem 1.5rem;
    border-left: solid 2px #474d54;
    padding-left: 20px;
    margin-top: 10px;
}*/

table a {
    color: #DEDEDE;
    /* variable */
}

th,
td {
    border: solid 1px #474d54;
    /* variable */
}

.task-list {
    padding-left: 0;
}

.md-task-list-item {
    padding-left: 1.25rem;
}

.md-task-list-item > input {
    top: auto;
}

.md-task-list-item > input:before {
    content: "";
    display: inline-block;
    width: 0.875rem;
    height: 0.875rem;
    vertical-align: middle;
    text-align: center;
    border: 1px solid #b8bfc6;
    background-color: #363B40;
    margin-top: -0.4rem;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
    content: '\221A';
    /*◘*/
    font-size: 0.625rem;
    line-height: 0.625rem;
    color: #DEDEDE;
}

/** quick open **/
.auto-suggest-container {
    border: 0px;
    background-color: #525C65;
}

#typora-quick-open {
    background-color: #525C65;
}

#typora-quick-open input{
    background-color: #525C65;
    border: 0;
    border-bottom: 1px solid grey;
}

.typora-quick-open-item {
    background-color: inherit;
    color: inherit;
}

.typora-quick-open-item.active,
.typora-quick-open-item:hover {
    background-color: #4D8BDB;
    color: white;
}

.typora-quick-open-item:hover {
    background-color: rgba(77, 139, 219, 0.8);
}

.typora-search-spinner > div {
  background-color: #fff;
}

#write pre.md-meta-block {
    border-bottom: 1px dashed #ccc;
    background: transparent;
    padding-bottom: 0.6em;
    line-height: 1.6em;
}

.btn,
.btn .btn-default {
    background: transparent;
    color: #b8bfc6;
}

.ty-table-edit {
    border-top: 1px solid gray;
    background-color: #363B40;
}

.popover-title {
    background: transparent;
}

.md-image>.md-meta {
    color: #BBBBBB;
    background: transparent;
}

.md-expand.md-image>.md-meta {
    color: #DDD;
}

#write>h3:before,
#write>h4:before,
#write>h5:before,
#write>h6:before {
    border: none;
    border-radius: 0px;
    color: #888;
    text-decoration: underline;
    left: -1.4rem;
    top: 0.2rem;
}

#write>h3.md-focus:before {
    top: 2px;
}

#write>h4.md-focus:before {
    top: 2px;
}

.md-toc-item {
    color: #A8C2DC;
}

#write div.md-toc-tooltip {
    background-color: #363B40;
}

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus {
    color: white;
    background: black;
}

#toc-dropmenu {
    background: rgba(50, 54, 59, 0.93);
    border: 1px solid rgba(253, 253, 253, 0.15);
}

#toc-dropmenu .divider {
    background-color: #9b9b9b;
}

.outline-expander:before {
    top: 2px;
}

#typora-sidebar {
    box-shadow: none;
    border-right: 1px dashed;
    border-right: none;
}

.sidebar-tabs {
    border-bottom:0;
}

#typora-sidebar:hover .outline-title-wrapper {
    border-left: 1px dashed;
}

.outline-title-wrapper .btn {
    color: inherit;
}

.outline-item:hover {
    border-color: #363B40;
    background-color: #363B40;
    color: white;
}

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr {
    color: #8C8E92;
    display: inline;
}

.md-comment {
    color: #5a95e3;
    opacity: 0.8;
}

.md-inline-math svg {
    color: #b8bfc6;
}

#math-inline-preview .md-arrow:after {
    background: black;
}

.modal-content {
    background: var(--bg-color);
    border: 0;
}

.modal-title {
    font-size: 1.5em;
}

.modal-content input {
    background-color: rgba(26, 21, 21, 0.51);
    color: white;
}

.modal-content .input-group-addon {
    color: white;
}

.modal-backdrop {
    background-color: rgba(174, 174, 174, 0.7);
}

.modal-content .btn-primary {
    border-color: var(--primary-color);
}

.md-table-resize-popover {
    background-color: #333;
}

.form-inline .input-group .input-group-addon {
    color: white;
}

#md-searchpanel {
    border-bottom: 1px dashed grey;
}

/** UI for electron */

.context-menu,
#spell-check-panel,
#footer-word-count-info {
    background-color: #42464A;
}

.context-menu.dropdown-menu .divider,
.dropdown-menu .divider {
    background-color: #777777;
    opacity: 1;
}

footer {
    color: inherit;
}

@media (max-width: 1000px) {
    footer {
        border-top: none;
    }
    footer:hover {
        color: inherit;
    }
}

#file-info-file-path .file-info-field-value:hover {
    background-color: #555;
    color: #dedede;
}

.megamenu-content,
.megamenu-opened header {
    background: var(--bg-color);
}

.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn {
    color: inherit;
}

.megamenu-menu-panel input[type='text'] {
    background: inherit;
    border: 0;
    border-bottom: 1px solid;
}

#recent-file-panel-action-btn {
    background: inherit;
    border: 1px grey solid;
}

.megamenu-menu-panel .dropdown-menu > li > a {
    color: inherit;
    background-color: #2F353A;
    text-decoration: none;
}

.megamenu-menu-panel table td:nth-child(1) {
    color: inherit;
    font-weight: bold;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(1) {
    color: white;
}

.modal-footer .btn-default, 
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) {
    border: 1px solid;
    border-color: transparent;
}

.btn-primary {
    color: white;
}

.btn-default:hover, .btn-default:focus, .btn-default.focus, .btn-default:active, .btn-default.active, .open > .dropdown-toggle.btn-default {
    color: white;
    border: 1px solid #ddd;
    background-color: inherit;
}

.modal-header {
    border-bottom: 0;
}

.modal-footer {
    border-top: 0;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
    border: 1px solid #eee;
    background: transparent;
}

.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover {
    background-color: inherit;
}

.typora-node::-webkit-scrollbar {
    width: 5px;
}

.typora-node::-webkit-scrollbar-thumb:vertical {
    background: rgba(250, 250, 250, 0.3);
}

.typora-node::-webkit-scrollbar-thumb:vertical:active {
    background: rgba(250, 250, 250, 0.5);
}

#w-unpin {
    background-color: #4182c4;
}

#top-titlebar, #top-titlebar * {
    color: var(--item-hover-text-color);
}

.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count {
    background: #1f282d/*#333333*/;
}

#toggle-sourceview-btn:hover {
    color: #eee;
    background: #1f282d/*#333333*/;
}

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * {
    color: #686868 !important;
}

.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container)>input {
    opacity: #686868 !important;
}

.on-focus-mode li[cid]:not(.md-focus-container){
    color: #686868;
}

.on-focus-mode .md-fences.md-focus .CodeMirror-code>*:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * {
    color: #686868 !important;
}

.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container {
    color: #fff;
}

.on-focus-mode #typora-source .CodeMirror-code>*:not(.CodeMirror-activeline) * {
    color: #686868 !important;
}


/*diagrams*/
#write .md-focus .md-diagram-panel {
    border: 1px solid #ddd;
    margin-left: -1px;
    width: calc(100% + 2px);
}

/*diagrams*/
#write .md-focus.md-fences-with-lineno .md-diagram-panel {
    margin-left: auto;
}

.md-diagram-panel-error {
    color: #f1908e;
}

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover {
    color: #eee;
}

.sidebar-footer-item:hover,
.footer-item:hover {
    background: inherit;
    color: white;
}

.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after {
    color: white;
}

#sidebar-files-menu {
    border:solid 1px;
    box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.79);
    background-color: var(--bg-color);
}

.file-list-item {
    border-bottom:none;
}

.file-list-item-summary {
    opacity: 1;
}

.file-list-item.active:first-child {
    border-top: none;
}

.file-node-background {
    height: 32px;
}

.file-library-node.active>.file-node-content,
.file-list-item.active {
    color: white;
    color: var(--active-file-text-color);
}

.file-library-node.active>.file-node-background{
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}
.file-list-item.active {
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}

#ty-tooltip {
    background-color: black;
    color: #eee;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: 0.3rem;
    -webkit-appearance: none;
    appearance: none;
}

.md-mathjax-midline {
    background-color: #57616b;
    border-bottom: none;
}

footer.ty-footer {
    border-color: #656565;
}

.ty-preferences .btn-default {
    background: transparent;
}
.ty-preferences .btn-default:hover {
    background: #57616b;
}

.ty-preferences select {
    border: 1px solid #989698;
    height: 21px;
}

.ty-preferences .nav-group-item.active,
.export-item.active,
.export-items-list-control,
.export-detail {
    background: var(--item-hover-bg-color);
}

.ty-preferences input[type="search"] {
    border-color: #333;
    background: #333;
    line-height: 22px;
    border-radius: 6px;
    color: white;
}

.ty-preferences input[type="search"]:focus {
    box-shadow: none;
}

[data-is-directory="true"] .file-node-content {
    margin-bottom: 0;
}

.file-node-title {
    line-height: 22px;
}

.html-for-mac .file-node-open-state, .html-for-mac .file-node-icon {
    line-height: 26px;
}

::-webkit-scrollbar-thumb {
    background: rgba(230, 230, 230, 0.30);
}

::-webkit-scrollbar-thumb:active {
    background: rgba(230, 230, 230, 0.50);
}

#typora-sidebar:hover div.sidebar-content-content::-webkit-scrollbar-thumb:horizontal {
    background: rgba(230, 230, 230, 0.30);
}

.nav-group-item:active {
    background-color: #474d54 !important;
}

.md-search-hit {
    background: rgba(199, 140, 60, 0.81);
    color: #eee;
}

.md-search-hit * {
    color: #eee;
}

#md-searchpanel input {
    color: white;
}

.modal-backdrop.in {
    opacity: 1;
    backdrop-filter: blur(1px);
}

.clear-btn-icon {
    top: 8px;
}

/* try fix https://github.com/typora/typora-issues/issues/5253 */
.file-node-expanded>.file-node-children {
    display: grid;
  }

/* .md-alert-text-note {
    color: #28a3f59d;
}
.md-alert-text-important {
    color: rgb(163, 113, 247);
}
.md-alert-text-warning {
    color:  rgb(210, 153, 34);
} */

/* Make alert boxes use same line-height as blockquotes */
.md-alert {
    line-height: 1.625rem;
}

/* Make prompt/alert boxes use the same background and appearance as code fences */
.md-alert{
    background: #1f282d; /* same as pre.md-fences */
    padding: 10px 10px 10px 25px; /* match code fence padding */
    border-radius: 6px; /* subtle rounding to match code panels */
    border-left: none;
    margin-left: 0;      /* 取消左侧外边距 */
}

.md-alert p,
.md-alert-text-note p,
.md-alert-text-important p,
.md-alert-text-warning p {
    margin-bottom: 0.5rem;
}

/* .md-alert-text-note::before,
.md-alert-text-important::before,
.md-alert-text-warning::before {
    margin-left: -15px;
    padding-left: -15px;
} */


mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG2"] path[data-c], mjx-container[jax="SVG2"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title>信息安全引论</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='信息安全引论'><span>信息安全引论</span></h1><p><span>2025秋</span></p><hr /><p>&nbsp;</p><h1 id='lecture-1-绪论'><span>Lecture 1. 绪论</span></h1><p><span>课程体系：密码学基础、认证理论与技术、网络安全与应用安全、软件与系统安全、专题讲座</span></p><ul><li><p><span>信息安全的含义 CIA: Confidentiality, Integrity, Availability</span></p><ul><li><p><span>Confidentiality 数据机密性：外人不可阅读</span></p></li><li><p><span>Privacy 隐私性：个人控制与其相关的信息的收集、存储、披露</span></p></li><li><p><span>Integrity 数据完整性</span></p></li><li><p><span>Integrity 系统完整性：系统未被非授权操纵，按既定的功能运行</span></p></li><li><p><span>Availability 可用性：保证信息和信息系统随时为授权者提供服务，而不要出现非授权者滥用却对授权者拒绝服务的情况</span></p></li><li><p><span>其他：真实性Authenticity</span><code>确认实体是它所声明的</code><span>、可审计性Accountability、可靠性Reliability</span><code>行为和结果的一致性</code><span>、不可否认性Non-repudiation</span><code>防止源点或终点的抵赖</code></p></li></ul></li><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.403ex" height="1.934ex" role="img" focusable="false" viewBox="0 -833.9 2830 854.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.048ex;"><defs><path id="MJX-3-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-3-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-3-TEX-I-1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D443" xlink:href="#MJX-3-TEX-I-1D443"></use></g><g data-mml-node="mn" transform="translate(839.5,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"></use></g></g><g data-mml-node="mi" transform="translate(1243,0)"><use data-c="1D437" xlink:href="#MJX-3-TEX-I-1D437"></use></g><g data-mml-node="mi" transform="translate(2071,0)"><use data-c="1D445" xlink:href="#MJX-3-TEX-I-1D445"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>P</mi><mn>2</mn></msup><mi>D</mi><mi>R</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">P^2DR</script><span>安全模型：policy</span><code>意味着网络安全要达到的目标</code><span>, protection, detection, response</span></p><p><span>要求：Pt &gt; Dt + Rt </span><code>保护机制有效发挥作用的时间&gt;检测到+反应时间</code></p></li></ul><hr /><p>&nbsp;</p><h1 id='lecture-2-古典密码'><span>Lecture 2. 古典密码</span></h1><p><span>密码学 = 密码编码学</span><code>(编码)</code><span> + 密码分析学</span><code>(破译)</code></p><h2 id='一密码学'><span>一、密码学</span></h2><ul><li><p><span>密码算法的安全性</span></p><ul><li><p><span>【无条件安全】无论破译者有多少密文，他也无法解出对应的明文，即使他解出了，他也无法验证结果的正确性。</span></p></li><li><p><span>【计算上安全】破译的代价超出信息本身的价值 或 破译的时间超出了信息的有效期。</span></p></li></ul></li></ul><h3 id='密码编码'><span>密码编码</span></h3><ul><li><p><span>密码体制：五元组（P, C K, E, D）</span></p><ul><li><p><span>P: 明文空间（所有可能的明文的有限集）</span></p></li><li><p><span>C: 密文空间</span></p></li><li><p><span>K: 密钥空间</span></p></li><li><p><span>E: 加密算法</span></p></li><li><p><span>D: 解密算法</span></p></li></ul></li><li><p><span>密码算法分类</span></p><ol start='' ><li><p><span>按保密内容分为</span></p><ul><li><p><span>基于算法的算法：需要保证算法不公开，aka受限制的算法)</span></p></li><li><p><span>基于密钥的算法：这个更好，可以让大家都来测试该算法是否安全</span></p></li></ul></li><li><p><span>按密钥特点分为</span></p><ul><li><p><span>对称密钥算法：加密&amp;解密使用一致的密钥，aka 传统密码算法、秘密密钥、单密钥</span></p></li><li><p><span>非对称密码算法：aka公开密钥算法，用一个密钥进行加密，而用另一个进行解密。其中的加密密钥可以公开，又称公开密钥（public key)，简称公钥。解密密钥必须保密，又称私人密钥（private key），简称私钥。</span></p></li></ul></li><li><p><span>按明文的处理方法分为</span></p><ul><li><p><span>分组密码：将明文分成固定长度的组，用同一密钥和算法对每一块加密，输出也是固定长度的密文。</span><code>公钥密码一般为分组密码</code><span> </span><code>加密解密速度慢</code></p></li><li><p><span>流密码：又称序列密码。序列密码每次加密一位或一字节的明文，也可以称为流密码。</span></p></li></ul></li></ol></li><li><p><span>Kerckhoff原则 【古典密码和现代密码的分界线】：加密算法应建立在算法的公开不影响明文和密钥的安全的基础上。</span></p></li></ul><h3 id='密码分析'><span>密码分析</span></h3><ul><li><p><span>攻击类型：</span></p><ol start='' ><li><p><span>唯密文攻击：面前只有一串密文串。</span></p></li><li><p><span>已知明文攻击: 知道明文串x和相应的密文y。</span></p></li><li><p><span>选择明文攻击：可获得对加密机的暂时访问，因此能选择明文串x并构造出相应的密文串y。</span></p></li><li><p><span>选择密文攻击：可暂时接近密码机，可选择密文串y，并构造出相应的明文x。</span></p></li></ol></li></ul><p>&nbsp;</p><h2 id='二密码学的起源和发展'><span>二、密码学的起源和发展</span></h2><p><span>1949年之前 密码学是一门艺术（思想：代替、置换，仍是当今基本思想）</span>
<span>1949～1975年 密码学成为科学</span>
<span>1976年以后 密码学的新方向——公钥密码学</span></p><p>&nbsp;</p><h2 id='三古典密码'><span>三、古典密码</span></h2><h3 id='代替密码'><span>代替密码</span></h3><h4 id='简单代替密码'><span>简单代替密码</span></h4><ul><li><p><span>aka单字母密码，只替换一位字母</span></p><p><a href='#逆元'><span>前置知识：逆元</span></a></p><p><span>(1) 移位密码：x+a </span><code>密钥个数：25</code></p><p><span>(2) 乘数密码：ax </span><code>密钥个数：11（需要a与26互素）</code></p><p><span>(3) 仿射密码：ax+b </span><code>密钥个数：311</code></p><p>&nbsp;</p><p><span>(4) 密钥短语密码：eg. 取university为密钥，首先找出其中发生重复的字母，去掉重复字母i，成为universty。其次，字母一共10个，从第11个字母开始，写成universty。然后把其余17个字母按自然顺序接在后面。</span><img src="./信息安全引论.assets/image-20250918222155163.png" alt="image-20250918222155163" style="zoom:33%;" /></p><p>&nbsp;</p><p><span>(5) 任意的单表代替密码：一个任意的一一映射 </span><code>密钥空间很大，不能暴力枚举</code></p><ul><li><p><span>Sol. 利用语言的统计特性（字母的频率特征、</span><a href='q后接u，两个e间接r'><span>连接特征</span></a><span>、</span><a href='th, tion, tious'><span>重复特征</span></a><span>）</span><code>偏用现象：每个字母使用频率不一致</code></p><ul><li><p><span>Anti_Sol1. 多名代替密码：一对多转换，A可能对应于5、13、25，B可能对应于7、9、31、42。</span></p></li><li><p><span>Anti_Sol2. 多表代替密码：使用多张表来映射</span></p><p>&nbsp;</p></li></ul></li></ul></li></ul><h4 id='多表代替密码'><span>多表代替密码</span></h4><ul><li><p><span>多表代替：</span></p><p><span>i. 维吉尼亚密码 </span><img src="./信息安全引论.assets/image-20250918164725370.png" alt="image-20250918164725370" style="zoom:33%;" /></p><ul><li><p><span>维吉尼亚密码的破译：只需要确定密钥长度，即可分表进行统计学分析。</span></p><ul><li><p><span>Kasiski测试法：寻找“合拍”现象，求间隔的最大公因数。</span><code>可能会有偶然重合，从统计意义角度看即可</code><img src="./信息安全引论.assets/image-20250918223814668.png" alt="image-20250918223814668" style="zoom:33%;" /></p></li><li><p><span>重合指数法：对于一篇正常的英语文章&amp;正常的字母出现频率，可以求得随机抽两个字母，抽到两个相同字母的概率为 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="25.783ex" height="2.573ex" role="img" focusable="false" viewBox="0 -833.9 11396.2 1137.4" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.687ex;"><defs><path id="MJX-4-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-4-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-4-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-4-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-4-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-4-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path id="MJX-4-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-4-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-4-TEX-N-38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z"></path><path id="MJX-4-TEX-N-37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-4-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g><g data-mml-node="mn" transform="translate(536,-287.9) scale(0.707)"><use data-c="31" xlink:href="#MJX-4-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(1161.8,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="msubsup" transform="translate(2162,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-4-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g><g data-mml-node="mn" transform="translate(536,-287.9) scale(0.707)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(3101.6,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="mo" transform="translate(3879.6,0)"><use data-c="2E" xlink:href="#MJX-4-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4324.2,0)"><use data-c="2E" xlink:href="#MJX-4-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(4768.9,0)"><use data-c="2E" xlink:href="#MJX-4-TEX-N-2E"></use></g><g data-mml-node="mo" transform="translate(5213.6,0)"><use data-c="2B" xlink:href="#MJX-4-TEX-N-2B"></use></g><g data-mml-node="msubsup" transform="translate(5991.6,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-4-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(536,-287.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use><use data-c="36" xlink:href="#MJX-4-TEX-N-36" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(7562.4,0)"><use data-c="3D" xlink:href="#MJX-4-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(8618.2,0)"><use data-c="30" xlink:href="#MJX-4-TEX-N-30"></use><use data-c="2E" xlink:href="#MJX-4-TEX-N-2E" transform="translate(500,0)"></use><use data-c="30" xlink:href="#MJX-4-TEX-N-30" transform="translate(778,0)"></use><use data-c="36" xlink:href="#MJX-4-TEX-N-36" transform="translate(1278,0)"></use><use data-c="38" xlink:href="#MJX-4-TEX-N-38" transform="translate(1778,0)"></use><use data-c="37" xlink:href="#MJX-4-TEX-N-37" transform="translate(2278,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>p</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>p</mi><mn>2</mn><mn>2</mn></msubsup><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msubsup><mi>p</mi><mrow data-mjx-texclass="ORD"><mn>26</mn></mrow><mn>2</mn></msubsup><mo>=</mo><mn>0.0687</mn></math></mjx-assistive-mml></mjx-container><script type="math/tex">p_1^2+p_2^2+...+p_{26}^2=0.0687</script><span>，则拆分为d组计算平均重合指数，若接近0.0687则周期为d。</span></p></li></ul></li></ul><p><span>ii. 滚动密钥密码：密钥与明文一样长。</span><em><span>缺陷：不易保管密钥</span></em></p><p><img src="./信息安全引论.assets/image-20250925151904312.png" alt="image-20250925151904312" style="zoom:33%;" /></p><p><span>iii. Vernam密码：异或一段等长二进制串（思想：密钥与明文一样长且没有统计关系）。加密解密均异或该二进制串即可。</span></p><p><span>iv. 转轮密码机：分为快、慢、中转子，每个转子实现一个映射，每个转子都可以转26个位置，则有26 * 26 * 26 = 175756的密码空间（可以更多转子）。</span><em><span>在现代密码发明之前是最常用的密码实现</span></em></p><p>&nbsp;</p></li></ul><h4 id='多字母代替密码'><span>多字母代替密码</span></h4><ul><li><p><span>明文中的字符映射到密文空间的字符还依赖于它在上下文中的位置。</span></p><p><span>i. Playfair密码：将明文中的双字母组合作为一个单元转换成密文的双字母组合。</span></p><p><img src="./信息安全引论.assets/image-20250925153725859.png" alt="image-20250925153725859" style="zoom:33%;" /></p><p><span>ii. Hill密码：假设 K 是一个 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.739ex" height="1.136ex" role="img" focusable="false" viewBox="0 -491 2978.4 502" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-5-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-5-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-5-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(1100.2,0)"><use data-c="D7" xlink:href="#MJX-5-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(2100.4,0)"><use data-c="1D45A" xlink:href="#MJX-5-TEX-I-1D45A"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>×</mo><mi>m</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">m \times m</script><span> 矩阵，在 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.297ex" height="1.92ex" role="img" focusable="false" viewBox="0 -683 1457.1 848.6" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.375ex;"><defs><path id="MJX-6-TEX-D-2124" d="M39 -1Q29 9 29 12Q29 23 60 77T219 337L410 648H364Q261 648 210 628Q168 612 142 588T109 545T97 509T88 490Q85 489 80 489Q72 489 61 503L70 588Q72 607 75 628T79 662T81 675Q84 677 88 681Q90 683 341 683H592Q604 673 604 666Q604 662 412 348L221 37Q221 35 301 35Q406 35 446 48Q504 68 543 111T597 212Q602 239 617 239Q624 239 629 234T635 223Q635 215 621 113T604 8L597 1Q595 -1 317 -1H39ZM148 637L166 648H112V632Q111 629 110 622T108 612Q108 608 110 608T116 612T129 623T148 637ZM552 646Q552 648 504 648Q452 648 450 643Q448 639 266 343T77 37Q77 35 128 35H179L366 339L552 646ZM572 35Q581 89 581 97L561 77Q542 59 526 48L508 37L539 35H572Z"></path><path id="MJX-6-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-6-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="2124" xlink:href="#MJX-6-TEX-D-2124"></use></g></g><g data-mml-node="TeXAtom" transform="translate(700,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-6-TEX-N-32"></use><use data-c="36" xlink:href="#MJX-6-TEX-N-36" transform="translate(500,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">Z</mi></mrow><mrow data-mjx-texclass="ORD"><mn>26</mn></mrow></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\mathbb{Z}_{26} </script><span> 上可逆，即存在 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.361ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1927.7 833.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-7-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-7-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-7-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-7-TEX-I-1D43E"></use></g><g data-mml-node="TeXAtom" transform="translate(974,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-7-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-7-TEX-N-31"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>K</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">K^{-1}</script><span> 使得：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="10.53ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 4654.2 915.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-8-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-8-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-8-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-8-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-8-TEX-I-1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-8-TEX-I-1D43E"></use></g><g data-mml-node="msup" transform="translate(889,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-8-TEX-I-1D43E"></use></g><g data-mml-node="TeXAtom" transform="translate(974,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-8-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-8-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(3094.5,0)"><use data-c="3D" xlink:href="#MJX-8-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(4150.2,0)"><use data-c="1D43C" xlink:href="#MJX-8-TEX-I-1D43C"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><msup><mi>K</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">KK^{-1} = I</script><span>, 对每一个 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.956ex" height="1.661ex" role="img" focusable="false" viewBox="0 -694 2632.6 734" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.09ex;"><defs><path id="MJX-9-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-9-TEX-N-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJX-9-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-9-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(798.8,0)"><use data-c="2208" xlink:href="#MJX-9-TEX-N-2208"></use></g><g data-mml-node="mi" transform="translate(1743.6,0)"><use data-c="1D43E" xlink:href="#MJX-9-TEX-I-1D43E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>∈</mo><mi>K</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">k \in K</script><span>，定义</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="20.88ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 9229 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-10-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-10-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-10-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-10-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-10-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-10-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-10-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-10-TEX-N-A0" d=""></path><path id="MJX-10-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-10-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-10-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-10-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-10-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-10-TEX-I-1D452"></use></g><g data-mml-node="mi" transform="translate(499,-150) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-10-TEX-I-1D458"></use></g></g><g data-mml-node="mo" transform="translate(917.4,0)"><use data-c="28" xlink:href="#MJX-10-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1306.4,0)"><use data-c="1D465" xlink:href="#MJX-10-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(1878.4,0)"><use data-c="29" xlink:href="#MJX-10-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(2545.2,0)"><use data-c="3D" xlink:href="#MJX-10-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(3601,0)"><use data-c="1D465" xlink:href="#MJX-10-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(4173,0)"><use data-c="1D43E" xlink:href="#MJX-10-TEX-I-1D43E"></use></g><g data-mml-node="mtext" transform="translate(5062,0)"><use data-c="A0" xlink:href="#MJX-10-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(5312,0)"><use data-c="28" xlink:href="#MJX-10-TEX-N-28"></use></g><g data-mml-node="mtext" transform="translate(5701,0)"><use data-c="6D" xlink:href="#MJX-10-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-10-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-10-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mtext" transform="translate(7590,0)"><use data-c="A0" xlink:href="#MJX-10-TEX-N-A0"></use></g><g data-mml-node="mn" transform="translate(7840,0)"><use data-c="32" xlink:href="#MJX-10-TEX-N-32"></use><use data-c="36" xlink:href="#MJX-10-TEX-N-36" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(8840,0)"><use data-c="29" xlink:href="#MJX-10-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>e</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi>K</mi><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><mtext>mod</mtext><mtext>&nbsp;</mtext><mn>26</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">e_k(x) = xK \ (\text{mod}\ 26)</script><span> 和 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="22.981ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 10157.6 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-11-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-11-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-11-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-11-TEX-I-1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-11-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-11-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-11-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-11-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-11-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-11-TEX-N-A0" d=""></path><path id="MJX-11-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-11-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-11-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-11-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-11-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-11-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-11-TEX-I-1D458"></use></g></g><g data-mml-node="mo" transform="translate(971.4,0)"><use data-c="28" xlink:href="#MJX-11-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1360.4,0)"><use data-c="1D466" xlink:href="#MJX-11-TEX-I-1D466"></use></g><g data-mml-node="mo" transform="translate(1850.4,0)"><use data-c="29" xlink:href="#MJX-11-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(2517.2,0)"><use data-c="3D" xlink:href="#MJX-11-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(3573,0)"><use data-c="1D466" xlink:href="#MJX-11-TEX-I-1D466"></use></g><g data-mml-node="msup" transform="translate(4063,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-11-TEX-I-1D43E"></use></g><g data-mml-node="TeXAtom" transform="translate(974,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-11-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-11-TEX-N-31"></use></g></g></g><g data-mml-node="mtext" transform="translate(5990.6,0)"><use data-c="A0" xlink:href="#MJX-11-TEX-N-A0"></use></g><g data-mml-node="mo" transform="translate(6240.6,0)"><use data-c="28" xlink:href="#MJX-11-TEX-N-28"></use></g><g data-mml-node="mtext" transform="translate(6629.6,0)"><use data-c="6D" xlink:href="#MJX-11-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-11-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-11-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mtext" transform="translate(8518.6,0)"><use data-c="A0" xlink:href="#MJX-11-TEX-N-A0"></use></g><g data-mml-node="mn" transform="translate(8768.6,0)"><use data-c="32" xlink:href="#MJX-11-TEX-N-32"></use><use data-c="36" xlink:href="#MJX-11-TEX-N-36" transform="translate(500,0)"></use></g><g data-mml-node="mo" transform="translate(9768.6,0)"><use data-c="29" xlink:href="#MJX-11-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>d</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi><msup><mi>K</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mtext>&nbsp;</mtext><mo stretchy="false">(</mo><mtext>mod</mtext><mtext>&nbsp;</mtext><mn>26</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">d_k(y) = yK^{-1} \ (\text{mod}\ 26)</script></p><p><img src="./信息安全引论.assets/image-20250927192546095.png" alt="image-20250927192546095" style="zoom:40%;" /></p><p><em><span>很难被唯密文攻击攻破，但易被已知明文攻击攻破（直接解方程即可得到矩阵）</span></em></p></li></ul><p>&nbsp;</p><h3 id='置换密码'><span>置换密码</span></h3><ol start='' ><li><p><span>栅栏密码</span></p><p><img src="./信息安全引论.assets/image-20250925155147031.png" alt="image-20250925155147031" style="zoom:33%;" /></p></li><li><p><span>置换密码：按行写入，按列读出，密钥包含行宽、列高、读出顺序。</span><code>可多轮置换减少结构性排列</code></p><p><img src="./信息安全引论.assets/image-20250927192906123.png" alt="image-20250927192906123" style="zoom:33%;" /></p></li></ol><hr /><p>&nbsp;</p><p><span>前置知识-逆元</span><a name="逆元"></a></p><ul><li><p><span>如果 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="33.079ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 14621.1 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-12-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-12-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-12-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-12-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-12-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-12-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-12-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-12-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-12-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-12-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-12-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-12-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(389,0)"><use data-c="1D44E" xlink:href="#MJX-12-TEX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(1140.2,0)"><use data-c="D7" xlink:href="#MJX-12-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(2140.4,0)"><use data-c="1D44F" xlink:href="#MJX-12-TEX-I-1D44F"></use></g><g data-mml-node="mo" transform="translate(2569.4,0)"><use data-c="29" xlink:href="#MJX-12-TEX-N-29"></use></g><g data-mml-node="mspace" transform="translate(2958.4,0)"></g><g data-mml-node="mi" transform="translate(3792.1,0)"><use data-c="6D" xlink:href="#MJX-12-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-12-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-12-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(5681.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(5848.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6181.8,0)"><use data-c="1D45E" xlink:href="#MJX-12-TEX-I-1D45E"></use></g><g data-mml-node="mo" transform="translate(6919.6,0)"><use data-c="3D" xlink:href="#MJX-12-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(7975.3,0)"><use data-c="28" xlink:href="#MJX-12-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(8364.3,0)"><use data-c="1D44E" xlink:href="#MJX-12-TEX-I-1D44E"></use></g><g data-mml-node="mo" transform="translate(9115.6,0)"><use data-c="D7" xlink:href="#MJX-12-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(10115.8,0)"><use data-c="1D450" xlink:href="#MJX-12-TEX-I-1D450"></use></g><g data-mml-node="mo" transform="translate(10548.8,0)"><use data-c="29" xlink:href="#MJX-12-TEX-N-29"></use></g><g data-mml-node="mspace" transform="translate(10937.8,0)"></g><g data-mml-node="mi" transform="translate(11771.4,0)"><use data-c="6D" xlink:href="#MJX-12-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-12-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-12-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(13660.4,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(13827.4,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(14161.1,0)"><use data-c="1D45E" xlink:href="#MJX-12-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mo>×</mo><mi>b</mi><mo stretchy="false">)</mo><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>×</mo><mi>c</mi><mo stretchy="false">)</mo><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">(a \times b)\mod q = (a \times c) \mod q</script><span>，当 a 与 q 互素时，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="13.301ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 5878.9 888" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-13-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-13-TEX-N-2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path><path id="MJX-13-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-13-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-13-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-13-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-13-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D44F" xlink:href="#MJX-13-TEX-I-1D44F"></use></g><g data-mml-node="mo" transform="translate(706.8,0)"><use data-c="2261" xlink:href="#MJX-13-TEX-N-2261"></use></g><g data-mml-node="mi" transform="translate(1762.6,0)"><use data-c="1D450" xlink:href="#MJX-13-TEX-I-1D450"></use></g><g data-mml-node="mspace" transform="translate(2195.6,0)"></g><g data-mml-node="mi" transform="translate(3029.2,0)"><use data-c="6D" xlink:href="#MJX-13-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-13-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-13-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(4918.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(5085.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(5418.9,0)"><use data-c="1D45E" xlink:href="#MJX-13-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>≡</mo><mi>c</mi><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">b \equiv c \mod q</script><span>。</span></p></li><li><p><span>如果 q 是一个素数，对每一个非 0 元 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="6.819ex" height="2.195ex" role="img" focusable="false" viewBox="0 -683 3013.8 970.2" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.65ex;"><defs><path id="MJX-14-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-14-TEX-N-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJX-14-TEX-D-2124" d="M39 -1Q29 9 29 12Q29 23 60 77T219 337L410 648H364Q261 648 210 628Q168 612 142 588T109 545T97 509T88 490Q85 489 80 489Q72 489 61 503L70 588Q72 607 75 628T79 662T81 675Q84 677 88 681Q90 683 341 683H592Q604 673 604 666Q604 662 412 348L221 37Q221 35 301 35Q406 35 446 48Q504 68 543 111T597 212Q602 239 617 239Q624 239 629 234T635 223Q635 215 621 113T604 8L597 1Q595 -1 317 -1H39ZM148 637L166 648H112V632Q111 629 110 622T108 612Q108 608 110 608T116 612T129 623T148 637ZM552 646Q552 648 504 648Q452 648 450 643Q448 639 266 343T77 37Q77 35 128 35H179L366 339L552 646ZM572 35Q581 89 581 97L561 77Q542 59 526 48L508 37L539 35H572Z"></path><path id="MJX-14-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-14-TEX-I-1D464"></use></g><g data-mml-node="mo" transform="translate(993.8,0)"><use data-c="2208" xlink:href="#MJX-14-TEX-N-2208"></use></g><g data-mml-node="msub" transform="translate(1938.6,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="2124" xlink:href="#MJX-14-TEX-D-2124"></use></g></g><g data-mml-node="mi" transform="translate(700,-150) scale(0.707)"><use data-c="1D45E" xlink:href="#MJX-14-TEX-I-1D45E"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>∈</mo><msub><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">Z</mi></mrow><mi>q</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">w \in \mathbb{Z}_q</script><span>，都存在 z，使得 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="17.919ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 7920.3 888" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.439ex;"><defs><path id="MJX-15-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-15-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-15-TEX-I-1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path><path id="MJX-15-TEX-N-2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path><path id="MJX-15-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-15-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-15-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-15-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-15-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-15-TEX-I-1D464"></use></g><g data-mml-node="mo" transform="translate(938.2,0)"><use data-c="D7" xlink:href="#MJX-15-TEX-N-D7"></use></g><g data-mml-node="mi" transform="translate(1938.4,0)"><use data-c="1D467" xlink:href="#MJX-15-TEX-I-1D467"></use></g><g data-mml-node="mo" transform="translate(2681.2,0)"><use data-c="2261" xlink:href="#MJX-15-TEX-N-2261"></use></g><g data-mml-node="mn" transform="translate(3737,0)"><use data-c="31" xlink:href="#MJX-15-TEX-N-31"></use></g><g data-mml-node="mspace" transform="translate(4237,0)"></g><g data-mml-node="mi" transform="translate(5070.7,0)"><use data-c="6D" xlink:href="#MJX-15-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-15-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-15-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(6959.7,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(7126.7,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7460.3,0)"><use data-c="1D45E" xlink:href="#MJX-15-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi><mo>×</mo><mi>z</mi><mo>≡</mo><mn>1</mn><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">w \times z \equiv 1 \mod q</script><span>，z 称作 w 的乘法逆元 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.852ex" height="1.912ex" role="img" focusable="false" viewBox="0 -833.9 1702.7 844.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-16-TEX-I-1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path><path id="MJX-16-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-16-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D464" xlink:href="#MJX-16-TEX-I-1D464"></use></g><g data-mml-node="TeXAtom" transform="translate(749,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-16-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-16-TEX-N-31"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>w</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">w^{-1}</script><span>。</span></p></li><li><p><span>乘法逆元计算</span></p><ul><li><p><span>裴蜀定理：若a、b是整数且他们的最大公约数gcd(a,b) =d，那么对于任意的整数x，y，ax+by都一定是d的倍数，特别地，一定存在整数x与y，使得ax + by = d = gcd(a,b)成立。</span><em><span>即a、b的公因数为a、b线性组合所能得到的最小正整数.</span></em></p></li><li><p><span>扩展Euclid算法：</span></p><p><span>目的：求出ax + by = gcd(a,b)中的x和y</span></p><p><span>本质：还原辗转相除法所得到余数的过程</span></p><p><span>	</span><span>eg. 100 35 --&gt; 35 30 --&gt; 30 5</span></p><p><span>	</span><span>则5 = 35 - 30 = 35 * 1 - (100 * 1 - 35 * 2) = 100 * (-1) + 35 * 3</span></p><p><span>	</span><span>则x=-1, y=3</span></p><p><span>具体公式：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="35.314ex" height="2.167ex" role="img" focusable="false" viewBox="0 -750 15608.9 958" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.471ex;"><defs><path id="MJX-17-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-17-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-17-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-17-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-17-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-17-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-17-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-17-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-17-TEX-I-1D460"></use></g><g data-mml-node="TeXAtom" transform="translate(502,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2B" xlink:href="#MJX-17-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-17-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(1977.4,0)"><use data-c="3D" xlink:href="#MJX-17-TEX-N-3D"></use></g><g data-mml-node="msub" transform="translate(3033.2,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-17-TEX-I-1D460"></use></g><g data-mml-node="TeXAtom" transform="translate(502,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2212" xlink:href="#MJX-17-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-17-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(4955,0)"><use data-c="2212" xlink:href="#MJX-17-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(5955.3,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-17-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g></g><g data-mml-node="msub" transform="translate(6751.2,0)"><g data-mml-node="mi"><use data-c="1D45E" xlink:href="#MJX-17-TEX-I-1D45E"></use></g><g data-mml-node="mi" transform="translate(479,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g></g><g data-mml-node="mi" transform="translate(7524.2,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="msub" transform="translate(8408.7,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-17-TEX-I-1D461"></use></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2B" xlink:href="#MJX-17-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-17-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(10278.2,0)"><use data-c="3D" xlink:href="#MJX-17-TEX-N-3D"></use></g><g data-mml-node="msub" transform="translate(11333.9,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-17-TEX-I-1D461"></use></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2212" xlink:href="#MJX-17-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-17-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(13147.8,0)"><use data-c="2212" xlink:href="#MJX-17-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(14148,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-17-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(394,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g></g><g data-mml-node="msub" transform="translate(14836,0)"><g data-mml-node="mi"><use data-c="1D45E" xlink:href="#MJX-17-TEX-I-1D45E"></use></g><g data-mml-node="mi" transform="translate(479,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-17-TEX-I-1D456"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>s</mi><mi>i</mi></msub><msub><mi>q</mi><mi>i</mi></msub><mi>，</mi><msub><mi>t</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>t</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub><msub><mi>q</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">s_{i+1}=s_{i-1}-s_iq_i，t_{i+1}=t_{i-1}-t_iq_i</script><span> (</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="43.518ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 19235.1 950" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.452ex;"><defs><path id="MJX-18-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-18-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-18-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-18-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-18-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-18-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-18-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-18-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45E" xlink:href="#MJX-18-TEX-I-1D45E"></use></g><g data-mml-node="mtext" transform="translate(460,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">为</text></g><g data-mml-node="mtext" transform="translate(1347.5,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">商</text></g><g data-mml-node="mi" transform="translate(2232,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="msub" transform="translate(3116.6,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-18-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="30" xlink:href="#MJX-18-TEX-N-30"></use></g></g><g data-mml-node="mo" transform="translate(4300,0)"><use data-c="3D" xlink:href="#MJX-18-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(5355.7,0)"><use data-c="30" xlink:href="#MJX-18-TEX-N-30"></use></g><g data-mml-node="mo" transform="translate(5855.7,0)"><use data-c="2C" xlink:href="#MJX-18-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(6300.4,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-18-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-18-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(7483.7,0)"><use data-c="3D" xlink:href="#MJX-18-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(8539.5,0)"><use data-c="31" xlink:href="#MJX-18-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(9039.5,0)"><use data-c="2C" xlink:href="#MJX-18-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(9484.2,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-18-TEX-I-1D461"></use></g><g data-mml-node="mn" transform="translate(394,-150) scale(0.707)"><use data-c="30" xlink:href="#MJX-18-TEX-N-30"></use></g></g><g data-mml-node="mo" transform="translate(10559.5,0)"><use data-c="3D" xlink:href="#MJX-18-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(11615.3,0)"><use data-c="31" xlink:href="#MJX-18-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(12115.3,0)"><use data-c="2C" xlink:href="#MJX-18-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(12559.9,0)"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-18-TEX-I-1D461"></use></g><g data-mml-node="mn" transform="translate(394,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-18-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(13635.3,0)"><use data-c="3D" xlink:href="#MJX-18-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(14691.1,0)"><use data-c="30" xlink:href="#MJX-18-TEX-N-30"></use></g><g data-mml-node="mi" transform="translate(15191.1,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="mtext" transform="translate(16075.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">从</text></g><g data-mml-node="mn" transform="translate(16963.1,0)"><use data-c="32" xlink:href="#MJX-18-TEX-N-32"></use></g><g data-mml-node="mtext" transform="translate(17463.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">开</text></g><g data-mml-node="mtext" transform="translate(18350.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">始</text></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mtext>为</mtext><mtext>商</mtext><mi>，</mi><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo>,</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>t</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo>,</mo><msub><mi>t</mi><mn>1</mn></msub><mo>=</mo><mn>0</mn><mi>，</mi><mtext>从</mtext><mn>2</mn><mtext>开</mtext><mtext>始</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">q为商，s_0=0, s_1=1,t_0=1,t_1=0，从2开始</script><span>)</span></p></li></ul></li></ul><hr /><p>&nbsp;</p><h1 id='lecture-3-现代对称密码'><span>Lecture 3. 现代对称密码</span></h1><h2 id='一分组密码的设计原理与方法'><span>一、分组密码的设计原理与方法</span></h2><p><img src="./信息安全引论.assets/image-20250928163451707.png" alt="image-20250928163451707" style="zoom:33%;" /></p><p><span>现实中DES的有效密钥长度仅为56 位，AES 的密钥长度为128/196/256。希望找到的算法，能在密钥的控制之下，从一个足够大而且足够好的代替子集中，简单而迅速地选取出一个代替。要求：分组长度够长；密钥空间大；密钥长度不能过长；由密钥确定代替的算法足够复杂。</span></p><h5 id='两个基本设计方法'><span>两个基本设计方法</span></h5><p><span>理想密码系统中，密文的所有统计特性都与所使用的密钥独立。</span></p><ul><li><p><span>Diffusion 扩散：密文没有统计特征；明文一位影响密文多位；增加明文密文关系复杂性。</span><em><span>置换</span></em></p></li><li><p><span>Confusion 混淆：强调密钥的作用；增加密钥密文关系复杂性。</span><em><span>代替</span></em></p></li></ul><p>&nbsp;</p><h2 id='二乘积密码'><span>二、乘积密码</span></h2><p><span>考虑连续使用两个或两个以上的基本密码的方式来增强密码强度。</span></p><ul><li><p><span>要求：第一个方法的密文空间与第二个方法的明文空间一致；两个方法不满足交换性；两个方法相互独立</span></p></li><li><p><span>群：某些密码体制M具有以上性质，取自M的两个加密步的合成仍属于M，也就是说这一密码体制形成群。</span></p></li></ul><p>&nbsp;</p><h2 id='三数据加密标准des'><span>三、数据加密标准DES</span></h2><p><span>征集标准加密算法时的要求：</span></p><ul><li><p><span>算法必须提供高度的安全性</span></p></li><li><p><span>算法必须有详细的说明 并易于理解</span></p></li><li><p><span>算法的安全性取决于密钥 不依赖于算法</span></p></li><li><p><span>算法适用于所有用户</span></p></li><li><p><span>算法适用于不同应用场合</span></p></li><li><p><span>算法必须高效、经济</span></p></li><li><p><span>算法必须能被证实有效</span></p></li><li><p><span>算法必须是可出口的</span></p></li></ul><h3 id='feistel-密码结构'><span>Feistel 密码结构</span></h3><p><img src="./信息安全引论.assets/image-20250925165725956.png" alt="image-20250925165725956" style="zoom:40%;" /></p><ul><li><p><span>分组大小。越大安全性越高，但速度下降，64 比特较合理</span></p></li><li><p><span>密钥位数。越大安全性越高，但速度下降，64 比特广泛使用，但现在已经不够用→ 128 比特</span></p></li><li><p><span>循环次数，典型16次</span></p></li><li><p><span>子钥产生算法。算法越复杂，就增加密码分析的难度</span></p></li><li><p><span>round轮函数。函数越复杂，就增加密码分析的难度</span></p></li><li><p><span>快速软件实现，包括加密和解密算法</span></p></li><li><p><span>易于分析。便于掌握算法的保密强度以及扩展办法。</span></p></li><li><p><span>软件实现的要求：使用子块和简单的运算。密码运算在子块上进行，要求子块的长度能自然地适应软件编程，如8 、16 、32 比特等。应尽量避免按比特置换，在子块上所进行的密码运算尽量采用易于软件实现的运算。最好是用标准处理器所具有的一些基本指令，如加法、乘法、移位等。</span></p></li><li><p><span>硬件实现的要求：加密和解密的相似性，即加密和解密过程的不同应仅仅在密钥使用方式上，以便采用同样的器件来实现加密和解密，以节省费用和体积。尽量采用标准的组件结构，以便能适应于在超大规模集成电路中实现。</span></p></li></ul><h3 id='des'><span>DES</span></h3><p><strong><span>分组长度64bit；密钥长度64bit（有效56bit）；循环次数16次。</span></strong></p><p><span>整体流程：</span><img src="./信息安全引论.assets/image-20250928172512333.png" alt="image-20250928172512333" style="zoom:40%;" /><span>  轮操作：</span><img src="./信息安全引论.assets/image-20250928172403373.png" alt="image-20250928172403373" style="zoom:40%;" /></p><h4 id='轮操作'><span>轮操作</span></h4><ol start='' ><li><p><span>IP：初始置换，64bits-&gt;64bits</span></p></li><li><p><span>切成两半 64bits-&gt;32bits，并对右半32bits开始做轮操作</span></p></li><li><p><span>扩展置换E：32bits-&gt;48bits</span></p><p><img src="./信息安全引论.assets/image-20250928173112648.png" alt="image-20250928173112648" style="zoom:43%;" /></p></li><li><p><span>和密钥产生器产生的48bits密钥异或，48bits-&gt;48bits</span></p></li><li><p><span>S盒选择压缩：48bits-&gt;32bits</span></p><ul><li><p><span>共8个S盒。对每个盒，输入6进制输出4进制，第1和6位确定行，2345位确定列，通过表确定输出。</span></p></li></ul></li><li><p><span>P盒置换：置换. 32bits-&gt;32bits</span></p></li><li><p><span>和左半异或。32bits-&gt;32bits</span></p></li><li><p><span>反复迭代16轮</span></p></li><li><p><span>64bits通过IP</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.232ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 986.7 833.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-19-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-19-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"></g><g data-mml-node="TeXAtom" transform="translate(33,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-19-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-19-TEX-N-31"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">^{-1}</script><span> 置换，得到密文。</span></p></li></ol><h4 id='密钥产生器'><span>密钥产生器</span></h4><p><span>有64位初始密钥，需要生成16个不同48位密钥。</span></p><p><img src="./信息安全引论.assets/image-20250928173705480.png" alt="image-20250928173705480" style="zoom:50%;" /></p><ol start='' ><li><p><span>去掉校验位 64bits-&gt;56bits</span></p></li><li><p><span>置换选择，通过置换表</span></p></li><li><p><span>分成左右两半并各自根据移位表移位</span></p><p><img src="./信息安全引论.assets/image-20250928173852072.png" alt="image-20250928173852072" style="zoom:50%;" /></p></li><li><p><span>置换选择，通过置换表56bits-&gt;48bits</span></p></li></ol><p><span>*明文或密钥的一点小的变动应该使密文发生一个大的变化，这叫</span><strong><span>雪崩效应</span></strong><span>。</span></p><h4 id='雪崩效应'><span>雪崩效应</span></h4><ul><li><p><span>严格雪崩准则SAC（Strict avalanche criterion)：对于任何的i j，当任何一个输入比特i变化时，一个S盒子的任何输出比特j变化的概率为1/2 。</span></p></li><li><p><span>比特独立准则BIC (bit independence criterion)：对于任意的i j k，当任意一个输入比特i变化时，输出j和k应当独立地变化。</span></p></li></ul><p><span>雪崩准则的目标：消除明文与密文的统计依赖性，对抗统计分析攻击防止“局部篡改可预测”，模拟 “伪随机性”，确保密文无可识别模式。雪崩准则是“扩散特性”的量化实现。</span></p><p><span>P盒的设计准则：</span></p><ol start='' ><li><p><span>第 i 次循环时从每个 S 盒子输出的四个比特被分布开，以便其中的两个影响第i+1 次循环的中间比特，而另外的两个影响两端的比特。</span></p></li><li><p><span>每个 S 盒的 4 位输出都要影响下一循环的 6 个S 盒，且没有任何两位影响同一个 S 盒。</span></p></li><li><p><span>如果一个 S 盒的 4 位输出位影响另一个 S 盒的中间 1 位，那么后一个的输出位不会影响前一个S 盒的中间1 位</span></p></li></ol><h3 id='对des的讨论'><span>对DES的讨论</span></h3><h4 id='弱密钥'><span>弱密钥</span></h4><ul><li><p><span>定义：若密钥 K 满足</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="17.852ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7890.8 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-20-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-20-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-20-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-20-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-20-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-20-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-20-TEX-I-1D438"></use></g><g data-mml-node="mi" transform="translate(771,-150) scale(0.707)"><use data-c="1D43E" xlink:href="#MJX-20-TEX-I-1D43E"></use></g></g><g data-mml-node="mo" transform="translate(1449.6,0)"><use data-c="28" xlink:href="#MJX-20-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1838.6,0)"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-20-TEX-I-1D438"></use></g><g data-mml-node="mi" transform="translate(771,-150) scale(0.707)"><use data-c="1D43E" xlink:href="#MJX-20-TEX-I-1D43E"></use></g></g><g data-mml-node="mo" transform="translate(3288.2,0)"><use data-c="28" xlink:href="#MJX-20-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(3677.2,0)"><use data-c="1D440" xlink:href="#MJX-20-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(4728.2,0)"><use data-c="29" xlink:href="#MJX-20-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5117.2,0)"><use data-c="29" xlink:href="#MJX-20-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5784,0)"><use data-c="3D" xlink:href="#MJX-20-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(6839.8,0)"><use data-c="1D440" xlink:href="#MJX-20-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>K</mi></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mi>K</mi></msub><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex"> E_K(E_K(M)) = M</script><span>（即加密两次后恢复明文），则 K 为弱密钥。</span></p></li><li><p><span>DES共有4个弱密钥：左右两半各自全为1/全为0.（除了校验位）</span><em><span>DES 的加密和解密流程几乎相同，唯一区别是子密钥的使用顺序。对于全0/全1密钥，由于所有子密钥相同，因此加密=解密。</span></em></p><p><img src="./信息安全引论.assets/image-20251011140922158.png" alt="image-20251011140922158" style="zoom:30%;" /></p></li></ul><h4 id='半弱密钥'><span>半弱密钥</span></h4><ul><li><p><span>定义：若存在两个不同密钥使得 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="19.121ex" height="2.276ex" role="img" focusable="false" viewBox="0 -750 8451.6 1006.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.579ex;"><defs><path id="MJX-21-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-21-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-21-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-21-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-21-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-21-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-21-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-21-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-21-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-21-TEX-I-1D43E"></use></g><g data-mml-node="mn" transform="translate(882,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-21-TEX-N-31"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1730,0)"><use data-c="28" xlink:href="#MJX-21-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(2119,0)"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-21-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-21-TEX-I-1D43E"></use></g><g data-mml-node="mn" transform="translate(882,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-21-TEX-N-32"></use></g></g></g></g><g data-mml-node="mo" transform="translate(3849,0)"><use data-c="28" xlink:href="#MJX-21-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(4238,0)"><use data-c="1D440" xlink:href="#MJX-21-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(5289,0)"><use data-c="29" xlink:href="#MJX-21-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(5678,0)"><use data-c="29" xlink:href="#MJX-21-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(6344.8,0)"><use data-c="3D" xlink:href="#MJX-21-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(7400.6,0)"><use data-c="1D440" xlink:href="#MJX-21-TEX-I-1D440"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mn>1</mn></msub></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mn>2</mn></msub></mrow></msub><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>M</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_1}(E_{K_2}(M)) = M</script><span>（即 K1 加密后可用 K2 解密），则称K1K2为半弱密钥对。</span><em><span>半弱密钥对生成的子密钥序列互为逆序，导致加解密操作可相互抵消。</span></em></p></li><li><p><span>DES共有12个半弱密钥</span></p><p><img src="./信息安全引论.assets/image-20251011141236069.png" alt="image-20251011141236069" style="zoom:35%;" /></p></li></ul><h4 id='互补密钥'><span>互补密钥</span></h4><p><span>将密钥的0换成1，1换成0，就得到该密钥的补密钥。如果用原密钥加密一组明文，则用补密钥可以将明文的补码加密成密文的补码。即</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="26.628ex" height="2.362ex" role="img" focusable="false" viewBox="0 -759 11769.7 1044.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.645ex;"><defs><path id="MJX-22-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-22-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-22-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-22-TEX-I-1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path><path id="MJX-22-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-22-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-22-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path><path id="MJX-22-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-22-TEX-I-1D438"></use></g><g data-mml-node="mi" transform="translate(771,-150) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-22-TEX-I-1D458"></use></g></g><g data-mml-node="mo" transform="translate(1189.4,0)"><use data-c="28" xlink:href="#MJX-22-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1578.4,0)"><use data-c="1D440" xlink:href="#MJX-22-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(2629.4,0)"><use data-c="29" xlink:href="#MJX-22-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3296.2,0)"><use data-c="3D" xlink:href="#MJX-22-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(4352,0)"><use data-c="1D436" xlink:href="#MJX-22-TEX-I-1D436"></use></g><g data-mml-node="mi" transform="translate(5112,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g><g data-mml-node="msubsup" transform="translate(5996.5,0)"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-22-TEX-I-1D438"></use></g><g data-mml-node="mo" transform="translate(848.3,363) scale(0.707)"><use data-c="2032" xlink:href="#MJX-22-TEX-V-2032"></use></g><g data-mml-node="mi" transform="translate(771,-277.3) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-22-TEX-I-1D458"></use></g></g><g data-mml-node="mo" transform="translate(7185.9,0)"><use data-c="28" xlink:href="#MJX-22-TEX-N-28"></use></g><g data-mml-node="msup" transform="translate(7574.9,0)"><g data-mml-node="mi"><use data-c="1D440" xlink:href="#MJX-22-TEX-I-1D440"></use></g><g data-mml-node="mo" transform="translate(1138,363) scale(0.707)"><use data-c="2032" xlink:href="#MJX-22-TEX-V-2032"></use></g></g><g data-mml-node="mo" transform="translate(8957.4,0)"><use data-c="29" xlink:href="#MJX-22-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(9624.2,0)"><use data-c="3D" xlink:href="#MJX-22-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(10680,0)"><g data-mml-node="mi"><use data-c="1D436" xlink:href="#MJX-22-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(845.3,363) scale(0.707)"><use data-c="2032" xlink:href="#MJX-22-TEX-V-2032"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mi>，</mi><msubsup><mi>E</mi><mi>k</mi><mo data-mjx-alternate="1">′</mo></msubsup><mo stretchy="false">(</mo><msup><mi>M</mi><mo data-mjx-alternate="1">′</mo></msup><mo stretchy="false">)</mo><mo>=</mo><msup><mi>C</mi><mo data-mjx-alternate="1">′</mo></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_k (M)=C，E_k'(M' )=C'</script><span>。</span></p><p><span>那么在选择明文攻击中，选择明文X，使用机器得到E(X)=Y1和E(X&#39;)=Y2。然后穷举密钥T，对X进行加密运算，如果得到结果为Y1或Y2&#39;，则找到了密钥：T或T&#39;。这样即可减少一半的计算量，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.848ex" height="2.339ex" role="img" focusable="false" viewBox="0 -833.9 3468.8 1033.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.452ex;"><defs><path id="MJX-23-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-23-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-23-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-23-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="35" xlink:href="#MJX-23-TEX-N-35"></use><use data-c="36" xlink:href="#MJX-23-TEX-N-36" transform="translate(500,0)"></use></g></g></g><g data-mml-node="mtext" transform="translate(1290.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">到</text></g><g data-mml-node="msup" transform="translate(2178.7,0)"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-23-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="35" xlink:href="#MJX-23-TEX-N-35"></use><use data-c="35" xlink:href="#MJX-23-TEX-N-35" transform="translate(500,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>56</mn></mrow></msup><mtext>到</mtext><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>55</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{56}到2^{55}</script><span>。</span></p><p><em><span>其实现在算力发展，已经可以一天之内穷举出一个密钥了，所以DES已经不安全了。</span></em></p><h4 id='des的破译'><span>DES的破译</span></h4><ul><li><p><span>差分密码分析法：使用2^47对明密文的选择明文攻击</span></p></li><li><p><span>线性密码分析法：使用2^47对明密文的已知明文攻击 </span><em><span>思想：找到一个线性拟合函数</span></em></p></li></ul><h4 id='des的轮数'><span>DES的轮数</span></h4><p><span>一般来说，循环次数的选择准则是要使已知的密码分析的工作量大于简单的穷举式密钥搜索的工作量。</span></p><p><span>对于16 个循环的DES 来说，差分密码分析的运算次数为2</span><sup><span>55.1</span></sup><span>，而穷举式搜索要求2</span><sup><span>55</span></sup><span>，前者比后者效率稍低，如果DES循环15次，那么差分密码分析比穷举式搜索的工作量要小。</span></p><h4 id='s盒设计原理未知'><span>S盒设计原理未知</span></h4><p><span>S盒是许多密码算法的唯一非线性部件 因此 它的密码强度决定了整个算法的安全强度，提供了密码算法所必须的混淆作用。</span></p><p><span>如何全面准确地度量S 盒的密码强度和设计有效的S 盒是分组密码设计和分析中的难题：非线性度、差分均匀性、严格雪崩准则、可逆性、没有陷门</span></p><h3 id='double-des'><span>Double DES</span></h3><p><span>已经证明DES不能成为群（即用k1做一遍加密、再用k2做一遍加密，无法等效于用k3做一遍加密）。所以：做两遍DES！</span></p><h4 id='弱点'><span>弱点</span></h4><p><strong><span>中间相遇攻击</span></strong><span>：如果拿到了一对明文密文对(P, C)，则对所有</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.919ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1290.1 833.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-25-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-25-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-25-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-25-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="35" xlink:href="#MJX-25-TEX-N-35"></use><use data-c="36" xlink:href="#MJX-25-TEX-N-36" transform="translate(500,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>56</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{56}</script><span>个密钥，加密P，对结果排序；对所有</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.919ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1290.1 833.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-25-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-25-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-25-TEX-N-36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-25-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="35" xlink:href="#MJX-25-TEX-N-35"></use><use data-c="36" xlink:href="#MJX-25-TEX-N-36" transform="translate(500,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>56</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{56}</script><span>个密钥，解密C，对结果排序；逐个比较，即可找出K1 K2 使得</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="18.319ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8096.9 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-26-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-26-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-26-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-26-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-26-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-26-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-26-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-26-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-26-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-26-TEX-I-1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-26-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-26-TEX-I-1D43E"></use></g><g data-mml-node="mn" transform="translate(889,0)"><use data-c="31" xlink:href="#MJX-26-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(1803.2,0)"><use data-c="28" xlink:href="#MJX-26-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(2192.2,0)"><use data-c="1D443" xlink:href="#MJX-26-TEX-I-1D443"></use></g><g data-mml-node="mo" transform="translate(2943.2,0)"><use data-c="29" xlink:href="#MJX-26-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3609.9,0)"><use data-c="3D" xlink:href="#MJX-26-TEX-N-3D"></use></g><g data-mml-node="msub" transform="translate(4665.7,0)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-26-TEX-I-1D437"></use></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-26-TEX-I-1D43E"></use></g><g data-mml-node="mn" transform="translate(889,0)"><use data-c="32" xlink:href="#MJX-26-TEX-N-32"></use></g></g></g><g data-mml-node="mo" transform="translate(6558.9,0)"><use data-c="28" xlink:href="#MJX-26-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(6947.9,0)"><use data-c="1D436" xlink:href="#MJX-26-TEX-I-1D436"></use></g><g data-mml-node="mo" transform="translate(7707.9,0)"><use data-c="29" xlink:href="#MJX-26-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mi>K</mi><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow data-mjx-texclass="ORD"><mi>K</mi><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K1} (P) = D_{K2} (C)</script></p><p><span>给定一个明文P，经二重DES 加密有2</span><sup><span>64</span></sup><span>个可能的密文。而二重DES 所用密钥的长度应是112 bits，所以选择密钥有2</span><sup><span>112</span></sup><span> 个可能性。于是对给定一个明文P 加密成同样密文有2</span><sup><span>112</span></sup><span> /2</span><sup><span>64</span></sup><span> =2</span><sup><span>48</span></sup><span> 种可能。拿这么多种可能去试第二对明密文对，因为密文空间是2</span><sup><span>64</span></sup><span>，所以只有2</span><sup><span>48-64</span></sup><span> =2</span><sup><span>-16</span></sup><span> 的概率又蒙对一个。所以说，对已知2个明文 密文对的中间相遇攻击成功的概率为1-2</span><sup><span>-16</span></sup><span> 。</span>
<span>攻击用的代价(加密或解密所用运算次数) ≤ 4 * 2</span><sup><span>56</span></sup><span>，需要大量的存储器。</span></p><h3 id='triple-des'><span>Triple DES</span></h3><p><span>有多种模式：</span></p><ul><li><p><span>DES-EEE3：三个不同密钥，顺序使用三次加密</span></p></li><li><p><span>DES-EDE3：三个不同密钥，依次加密-解密-加密 </span><em><span>与DES 的兼容性可以通过令K3 =K2 或 K1 = K2得到。</span></em></p></li><li><p><span>DES-EEE2：K1=K3</span></p></li><li><p><span>DES-EDE2：K1=K3</span></p></li></ul><p><span>目前还没发现有效攻击方式，密码有效长度可达168位。对其密钥空间中密钥进行蛮干搜索，那么由于空间太大为</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="13.677ex" height="2.139ex" role="img" focusable="false" viewBox="0 -863.3 6045.3 945.3" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-27-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-27-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-27-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-27-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-27-TEX-I-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path><path id="MJX-27-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-27-TEX-N-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-27-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-27-TEX-N-31"></use><use data-c="31" xlink:href="#MJX-27-TEX-N-31" transform="translate(500,0)"></use><use data-c="32" xlink:href="#MJX-27-TEX-N-32" transform="translate(1000,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(1921.4,0)"><use data-c="3D" xlink:href="#MJX-27-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(2977.2,0)"><use data-c="35" xlink:href="#MJX-27-TEX-N-35"></use></g><g data-mml-node="mi" transform="translate(3477.2,0)"><use data-c="D7" xlink:href="#MJX-27-TEX-I-D7"></use></g><g data-mml-node="msup" transform="translate(4255.2,0)"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-27-TEX-N-31"></use><use data-c="30" xlink:href="#MJX-27-TEX-N-30" transform="translate(500,0)"></use></g><g data-mml-node="TeXAtom" transform="translate(1033,393.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="33" xlink:href="#MJX-27-TEX-N-33"></use><use data-c="33" xlink:href="#MJX-27-TEX-N-33" transform="translate(500,0)"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mn>112</mn></mrow></msup><mo>=</mo><mn>5</mn><mi>×</mi><msup><mn>10</mn><mrow data-mjx-texclass="ORD"><mn>33</mn></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">2^{112}=5 × 10^{33}</script><span>，这实际上是不可行的。若用差分攻击的方法，相对于单一DES来说复杂性以指数形式增长，要超过1e52 。</span></p><p><span>许多基于Internet 的应用里用到：PGP 和S/MIME。</span></p><p>&nbsp;</p><h2 id='四其他现代对称分组密码'><span>四、其他现代对称分组密码</span></h2><h3 id='aesrijndael'><span>AES（Rijndael）</span></h3><p><span>Advanced Encryption Standard，Rijndael算法胜出。</span></p><p><span>要求：比三重DES快、至少与三重DES一样安全、</span><strong><span>数据分组长度为128比特、密钥长度为128/192/256比特（分别循环10、12、14轮）</span></strong><span>。</span></p><h4 id='数学基础'><span>数学基础</span></h4><p><strong><span>一元多项式环。</span></strong></p><h4 id='加密流程'><span>加密流程</span></h4><p><img src="./信息安全引论.assets/image-20251011163942832.png" alt="image-20251011163942832" style="zoom:43%;" /></p><h5 id='初始变换'><span>初始变换</span></h5><p><span>和子密钥K0进行异或（以字节为单位排成矩阵）。</span><img src="./信息安全引论.assets/image-20251011164213965.png" alt="image-20251011164213965" style="zoom:43%;" /></p><h5 id='轮操作-2'><span>轮操作</span></h5><ol start='' ><li><p><span>字节代替</span></p><p><img src="./信息安全引论.assets/image-20251009165418383.png" alt="image-20251009165418383" style="zoom:40%;" /></p><p><span>是由有限域算出来的，具备抗差分分析的能力。</span></p></li><li><p><span>行移位变换</span></p><p><img src="./信息安全引论.assets/image-20251011164347837.png" alt="image-20251011164347837" style="zoom:50%;" /></p></li><li><p><span>列混淆变化（最后一轮没有这个步骤）</span></p><p><img src="./信息安全引论.assets/image-20251011215212902.png" alt="image-20251011215212902" style="zoom:50%;" /></p><p><span>可以理解为每一列左乘一个矩阵。但是“乘法”的实际进行为↓</span></p><p><img src="./信息安全引论.assets/image-20251011215306713.png" alt="image-20251011215306713" style="zoom:50%;" /></p></li><li><p><span>轮密钥加：密钥经过密钥扩展得到十个子密钥，每一轮最后和该轮子密钥异或。</span></p></li></ol><h5 id='密钥扩展'><span>密钥扩展</span></h5><ol start='' ><li><p><span>对于不整除4的轮密钥：W[i] = W[i-4] ^ W[i-1]</span></p></li><li><p><span>对于整除4的轮密钥：W[i] = W[i-4] ^ G(W[i-1])</span></p><p><span>G函数：i. 一字节左移：[b0,b1,b2,b3] -&gt; [b1,b2,b3,b0]</span></p><p><span>	</span><span>ii. 用S盒进行字节替换</span></p><p><span>	</span><span>iii. 前两步的结果异或轮常数Rcon[j]</span></p><p><span>	</span><img src="./信息安全引论.assets/image-20251011215748798.png" alt="image-20251011215748798" style="zoom:43%;" /></p></li></ol><h4 id='安全性'><span>安全性</span></h4><p><span>Rijndael 能够抵抗目前已知的攻击算法（线性攻击、差分攻击），没有发现弱密钥或补密钥。</span></p><p><img src="./信息安全引论.assets/image-20251016151734348.png" alt="image-20251016151734348" style="zoom:33%;" /></p><h3 id='sm4'><span>SM4</span></h3><ul><li><p><span>商密SM4.0（原名SMS4.0）是我国政府采用的一种分组密码标准，由国家密码管理局于2012年发布。</span></p></li><li><p><span>国密即国家密码管理局认定的国产密码算法。</span><a href='https://www.oscca.gov.cn/' target='_blank' class='url'>https://www.oscca.gov.cn/</a></p></li><li><p><span>SM1为对称加密。其加密强度与AES相当。该算法不公开。</span></p></li><li><p><span>SM4</span><strong><span>分组长度与密钥长度均为128bit，迭代轮数 32 轮</span></strong><span>，改进的Feistel结构</span></p></li><li><p><span>政策依据：《密码法》要求关键信息基础设施必须使用国密算法；等保 2.0 三级以上系统需采用 SM4 加密传输。</span></p></li><li><p><span>国产化改造：金融领域需替换 AES 为 SM4。</span></p></li></ul><p>&nbsp;</p><h2 id='五分组密码的操作模式'><span>五、分组密码的操作模式</span></h2><p><span>《如何安全地使用密码》</span></p><h3 id='操作模式们'><span>操作模式们</span></h3><blockquote><p><span>有很多操作模式，比如：</span></p><ul><li><p><span>电子密码本ECB (electronic codebook mode)</span></p></li><li><p><span>密码分组链接CBC (cipher block chaining)</span></p></li><li><p><span>密码反馈CFB (cipher feedback)</span></p></li><li><p><span>输出反馈OFB (output feedback)</span></p></li><li><p><span>计数器CTR (counter)</span></p></li><li><p><span>分组链接BC</span></p></li><li><p><span>带有非线性函数的输出反馈模式OFBNLF</span></p></li></ul></blockquote><h5 id='电子密码本ecb'><span>电子密码本ECB</span></h5><p><img src="./信息安全引论.assets/image-20251016154000735.png" alt="image-20251016154000735" style="zoom:50%;" /></p><ul><li><p><span>优势：简单有效；可以并行实现。</span></p></li><li><p><span>缺点：不能隐藏明文的模式信息，相同明文=相同密文，同样信息多次出现造成泄漏；对明文的主动攻击是可能的；信息块可被替换、重排、删除、重放。</span></p></li><li><p><span>误差传递：1密文块损坏--&gt; 1明文块损坏</span></p></li><li><p><span>适合于传输短信息</span></p></li></ul><h5 id='密码分组链接cbc'><span>密码分组链接CBC</span></h5><p><img src="./信息安全引论.assets/image-20251016154215410.png" alt="image-20251016154215410" style="zoom:43%;" /></p><ul><li><p><span>需要共同的初始化向量IV</span></p></li><li><p><span>优势：能隐藏明文模式信息；对明文的主动攻击是不容易的；信息块不容易被替换、重排、删除、重放。</span></p></li><li><p><span>缺点：无法并行</span></p></li><li><p><span>误差传递：1密文块损坏--&gt; 2明文块损坏</span></p></li></ul><h5 id='密码反馈cfb'><span>密码反馈CFB</span></h5><p><img src="./信息安全引论.assets/image-20251016154610460.png" alt="image-20251016154610460" style="zoom:33%;" /><img src="./信息安全引论.assets/image-20251016155817313.png" alt="image-20251016155817313" style="zoom:33%;" /></p><ul><li><p><span>误差传递：1密文块损坏--&gt; 多个明文块损坏（看b/s值）。</span></p></li><li><p><span>初始化向量IV需要每次都不一致，不然容易出现相同明文-密文对。其余同上。</span></p></li></ul><h5 id='输出反馈ofb'><span>输出反馈OFB</span></h5><p><img src="./信息安全引论.assets/image-20251016155723665.png" alt="image-20251016155723665" style="zoom:33%;" /><img src="./信息安全引论.assets/image-20251016155743399.png" alt="image-20251016155743399" style="zoom:33%;" /></p><ul><li><p><span>误差传递：1密文块损坏--&gt; 1明文块损坏</span></p></li><li><p><span>对明文的主动攻击是可能的（可以直接在密文上修改bit即修改了对应的明文bit），安全性较CFB差。</span></p></li></ul><h5 id='counter-ctr'><span>Counter (CTR)</span></h5><p><img src="./信息安全引论.assets/image-20251016161135535.png" alt="image-20251016161135535" style="zoom:43%;" /></p><ul><li><p><span>优势：可以并行实现，可以预处理，适用于高速网络，可以随机访问加密的数据分组；隐藏了明文模式</span></p></li><li><p><span>误差传递：1密文块损坏--&gt; 1明文块损坏</span></p></li><li><p><span>对于每次加密，需要使用不同的密钥的计数器值</span></p></li></ul><h3 id='分组填充'><span>分组填充</span></h3><p><span>不是分组长度整数倍的报文就需要填充。因为想自动处理，所以通常总是要填充的。</span></p><h5 id='rc5的填充方式'><span>RC5的填充方式</span></h5><p><span>读最后一个字节，读出来是多少就去掉最后多少个字节。eg. 如果有8字节的填充，则最后8字节每个字节都为00001000。</span></p><p><strong><span>密文挪用（CTS模式）</span></strong><span>：cipher text stealing</span></p><ul><li><p><span>想要保持密文和明文长度一致，于是把最后一个完整块的密文的后半部分砍掉↓</span></p><p><img src="./信息安全引论.assets/image-20251018164908405.png" alt="image-20251018164908405" style="zoom:33%;" /></p></li><li><p><span>可以通过以下方法还原：</span><em><span>X 是从完整密文块中截取的 “补位片段”</span></em></p><p><img src="./信息安全引论.assets/image-20251018165602223.png" alt="image-20251018165602223" style="zoom:43%;" /></p></li></ul><h3 id='其他加密需求'><span>其他加密需求</span></h3><h4 id='存储数据加密'><span>存储数据加密</span></h4><p><span>存储数据的加密与传输数据的加密要求不同，P1619标准的设计要求如下:</span></p><ol start='' ><li><p><span>攻击者可以随意获取密文</span></p></li><li><p><span>数据的布局不能改变，加密后的数据和明文数据有相同大小</span></p></li><li><p><span>授权用户可以定长分组为单位访问数据，分组之间独立</span></p></li><li><p><span>加密以16-byte的分组为单位，分组相互独立</span></p></li><li><p><span>除数据在数据集中的位置外，不使用其他元数据</span></p></li><li><p><span>不同位置的相同明文加密为不同的密文，但在写同一位置时，总写为相同密文</span></p></li><li><p><span>一个与标准兼容的加密设备加密的数据，可以用另一个与标准兼容的设备解密</span></p></li></ol><h5 id='基础思想'><span>基础思想</span></h5><p><strong><span>可调分组密码（Tweakable Block Cipher）</span></strong><span>：引入了一个额外的参数 “调节因子（Tweak，图中的 T</span><sub><span>j</span></sub><span> ）”，使得相同的明文和密钥在不同调节因子下能产生不同的密文。（Hash function：将调节因子(比如位置描述)映射成随机数）</span></p><p><img src="./信息安全引论.assets/image-20251018170636871.png" alt="image-20251018170636871" style="zoom:43%;" /></p><h5 id='xts-aes模式'><span>XTS-AES模式</span></h5><p><img src="./信息安全引论.assets/image-20251018171116462.png" alt="image-20251018171116462" style="zoom:33%;" /><img src="./信息安全引论.assets/image-20251018171130305.png" alt="image-20251018171130305" style="zoom:33%;" /></p><ol start='' ><li><p><span>生成调整因子 T：输入 128 位</span><a href='i为时变值'><span>调整值 i</span></a><span>，用密钥 Key2 对其进行 AES 加密，再与有限域  GF(2^{128})  中的本原元 </span><a href='j 是数据单元内分组的序号，为计数器'><span>α</span><sup><span>j</span></sup></a><span> 进行乘法运算，得到调整因子 T。</span></p></li><li><p><span>处理明文分组  Pj ：将明文分组 (Pj) 与调整因子 T 进行异或运算，得到中间结果 PP。</span></p></li><li><p><span>AES 加密与最终密文生成</span></p><p>&nbsp;</p></li></ol><h4 id='保留格式加密'><span>保留格式加密</span></h4><p><span>保留格式加密 Format-Preserving Encryption (FPE) 指的是一种输出密文保留明文格式的加密技术。</span><img src="./信息安全引论.assets/image-20251018171916727.png" alt="image-20251018171916727" style="zoom:43%;" /></p><ul><li><p><span>应用场景：</span></p><ol start='' ><li><p><span>数据库：采用字符串格式的字段不能存储二进制格式的密文</span></p></li><li><p><span>高效传输：FPE算法加密的数据可以有效压缩</span></p></li><li><p><span>数据脱敏：是指对某些敏感信息通过脱敏规则进行数据的变形，实现敏感隐私数据的可靠保护。如身份证号、手机号、卡号、客户号等个人信息都需要进行数据脱敏。</span></p></li></ol></li><li><p><span>要求：</span></p><ol start='' ><li><p><span>数据类型相同、长度相同（能处理各种明文长度）</span></p></li><li><p><span>可适用于各种字符和数字类型</span></p></li><li><p><span>对于非常短的明文也具有强安全性（安全强度与AES相当）</span></p></li></ol></li></ul><p><span>算法包括：openssl，Crypto++，Criptix，Criplib，PGP SDK</span></p><p>&nbsp;</p><h2 id='六流密码'><span>六、流密码</span></h2><p><span>流密码的基本思想是利用密钥k产生一个密钥流z=z0z1…zm，用明文串异或密钥流的方式来加密明文串。</span><em><span>流密码的关键不是 “是否分块”，而是加密过程是否基于 “密钥流 + XOR”—— 无论密钥流是逐比特生成还是逐块生成，只要最终通过 “密钥流块 XOR 明文块” 得到密文，就属于流密码的工作模式</span></em><span> </span><code>使用密码反馈CFB、输出反馈OFB和计数器CTR模式即将分组密码转换为了流密码</code></p><ul><li><p><span>流密码特点：加密速度快、资源占用低、安全性有缺陷</span></p></li><li><p><span>适用场景：特定轻量化或高速场景。</span></p></li></ul><h3 id='同步流密码'><span>同步流密码</span></h3><p><span>同步流密码：密钥流的生成与明文、密文完全独立，仅依赖初始密钥和初始向量（IV），且加密和解密端需保持 “同步” 才能正确还原数据。</span></p><p><span>构成：（P,C,K,L,E,D) 和函数f。即P明文空间、C密文空间、K密钥空间、L密钥流字母表、f</span><a href='使用密钥K作为输入，产生无限的密钥流z=z0z1…zi∈L,i≥1'><span>密钥流生成器</span></a><span>、E加密算法集、D解密算法集。</span></p><h4 id='设计流密码的准则'><span>设计流密码的准则</span></h4><ol start='' ><li><p><span>加密序列的周期要长</span></p></li><li><p><span>密钥流应该尽可能地接近于一个真正的随机数流的特征.</span></p></li><li><p><span>为防止强力攻击，密钥应该足够长。不小于128位。</span></p></li></ol><h4 id='rc4'><span>RC4</span></h4><p><span>RC4是一个密钥大小可变的序列密码，于1987年由</span><a href='RSA算法中的R'><span>Ron Rivest</span></a><span> 开发，是目前应用和影响力都最为广泛的一种流密码算法。是一个面向字节的流密码，对线性和差分分析免疫，密钥长度从1字节到256字节，或8比特到2048比特可变。所需要代码少。由于RC4是流密码，必须避免重复使用密钥。</span></p><h5 id='原理'><span>原理</span></h5><p><span>摸球模型：256个外形完全一致分别标有0，1,…,255的球放在一个口袋中，将所有球充分混合后，每次随机取一球。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c++" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c++"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 11px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//第一阶段：S盒初始化</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> <span class="cm-variable">i</span><span class="cm-operator">=</span><span class="cm-number">0</span> <span class="cm-variable">to</span> <span class="cm-number">255</span> <span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">S</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=</span><span class="cm-variable">i</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">T</span>[<span class="cm-variable">i</span>]<span class="cm-operator">=</span><span class="cm-variable">K</span>[<span class="cm-variable">i</span> <span class="cm-variable">mod</span> <span class="cm-variable">keylen</span>] <span class="cm-comment">//将K赋给T</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">j</span><span class="cm-operator">=</span><span class="cm-number">0</span>;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> (<span class="cm-variable">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span> <span class="cm-variable">to</span> <span class="cm-number">255</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">j</span> <span class="cm-operator">=</span> (<span class="cm-variable">j</span> <span class="cm-operator">+</span> <span class="cm-variable">S</span>[<span class="cm-variable">i</span>] <span class="cm-operator">+</span> <span class="cm-variable">T</span>[<span class="cm-variable">i</span>]) <span class="cm-variable">mod</span> <span class="cm-number">256</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Swap</span> <span class="cm-variable">S</span>[<span class="cm-variable">i</span>] <span class="cm-variable">and</span> <span class="cm-variable">S</span>[<span class="cm-variable">j</span>] <span class="cm-comment">//充分混合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//第二阶段：密钥流的生成</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">i</span>,<span class="cm-variable">j</span><span class="cm-operator">=</span><span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">while</span>(<span class="cm-atom">true</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-variable">i</span> <span class="cm-operator">=</span> (<span class="cm-variable">i</span> <span class="cm-operator">+</span> <span class="cm-number">1</span>) <span class="cm-variable">mod</span> <span class="cm-number">256</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">j</span> <span class="cm-operator">=</span> (<span class="cm-variable">j</span> <span class="cm-operator">+</span> <span class="cm-variable">S</span>[<span class="cm-variable">i</span>]) <span class="cm-variable">mod</span> <span class="cm-number">256</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">Swap</span> <span class="cm-variable">S</span>[<span class="cm-variable">i</span>] <span class="cm-variable">and</span> <span class="cm-variable">S</span>[<span class="cm-variable">j</span>] <span class="cm-comment">//希望每取一次球，就对袋子中的球“搅和一把”</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">t</span> <span class="cm-operator">=</span> (<span class="cm-variable">S</span>[<span class="cm-variable">i</span>] <span class="cm-operator">+</span> <span class="cm-variable">S</span>[<span class="cm-variable">j</span>]) <span class="cm-variable">mod</span> <span class="cm-number">256</span> <span class="cm-comment">//希望取出的第t个球是随机取出的；</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">k</span> <span class="cm-operator">=</span> <span class="cm-variable">S</span>[<span class="cm-variable">t</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">//然后k与明文异或产生密文，与密文异或产生明文</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 443px;"></div><div class="CodeMirror-gutters" style="display: none; height: 443px;"></div></div></div></pre><hr /><p>&nbsp;</p><h1 id='lecture-4-公钥密码'><span>Lecture 4. 公钥密码</span></h1><h2 id='一公钥密码的基本思想'><span>一、公钥密码的基本思想</span></h2><h5 id='对称算法的不足'><span>对称算法的不足</span></h5><ol start='' ><li><p><span>密钥管理量的困难：两两分别用一个密钥的话，则n 个用户需要C(n,2)=n(n-1)/2 个密钥。</span></p></li><li><p><span>密钥传递：密钥必须通过某一信道协商，对这个信道的安全性的要求比正常的传送消息的信道的安全性要高。</span></p></li><li><p><span>数字签名的问题：传统加密算法无法实现抗抵赖的需求。</span></p></li></ol><h5 id='希望公钥密码满足'><span>希望公钥密码满足</span></h5><ol start='' ><li><p><span>加密与解密由不同的密钥完成。KU: public key. KR: private key.</span></p><p><span>加密: X -&gt; Y: Y = E</span><sub><span>KU</span></sub><span> (X) </span></p><p><span>解密: Y -&gt; X: X = D</span><sub><span>KR</span></sub><span>(Y) = D</span><sub><span>KR</span></sub><span>(E</span><sub><span>KU</span></sub><span>(X)</span></p></li><li><p><span>产生一对密钥是计算可行的</span></p></li><li><p><span>已知公钥和明文，产生密文是计算可行的</span></p></li><li><p><span>接收方利用私钥来解密密文是计算可行的</span></p></li><li><p><span>对于攻击者，利用公钥来推断私钥是计算不可行的</span></p></li><li><p><span>已知公钥和密文，恢复明文是计算不可行的</span></p></li><li><p><span>两个密钥中任何一个都可以用作加密而另一个用作解密（不是必须的）</span></p><p><span>X = E</span><sub><span>KU</span></sub><span>(D</span><sub><span>KR</span></sub><span>(X) = D</span><sub><span>KR</span></sub><span>(E</span><sub><span>KU</span></sub><span>(X)</span></p></li></ol><p><span>即想寻找陷门单向函数。</span></p><h5 id='陷门单向函数'><span>陷门单向函数</span></h5><p><span>单向陷门函数是满足下列条件的函数f：</span></p><ol start='' ><li><p><span>给定x，计算y= f</span><sub><span>k</span></sub><span>(x) 是容易的</span></p></li><li><p><span>给定y，计算x 使 x=f</span><sub><span>k</span></sub><sup><span>-1</span></sup><span>(y) 是不可行的。</span></p></li><li><p><span>存在k，已知k 时，对给定的任何y，若相应的x 存在，则计算x=f</span><sub><span>k</span></sub><sup><span>-1</span></sup><span>(y) 是容易的。</span></p></li></ol><h5 id='应用方法'><span>应用方法</span></h5><p><span>每个用户拥有自己的密钥对(KU, KR）</span></p><ol start='' ><li><p><span>保密：Alice给Bob发消息，用Bob的公钥进行加密，Bob用私钥解密。</span></p></li><li><p><span>数字签名：Alice要保证这是自己发的消息，就用自己的私钥加密，别人可以通过Alice的公钥来验证。</span></p></li><li><p><span>密钥交换：在公用信道上商议出密钥</span></p></li></ol><p>&nbsp;</p><h2 id='二公钥数学基础'><span>二、公钥数学基础</span></h2><h4 id='复杂性'><span>复杂性</span></h4><h5 id='算法复杂性'><span>算法复杂性</span></h5><p><span>一般地，一个可以在多项式时间内解决的问题被认为是可解的，而任何比多项式时间更长的时间，尤其是指数时间，被认为是不可解的。指数时间：O(t</span><sup><span>h(n)</span></sup><span>))，其中t 是一个常数，h(n) 是一个多项式。</span></p><h5 id='问题复杂性'><span>问题复杂性</span></h5><p><span>图灵机是一种具有无限读写能力的有限状态机，并且可以做无限的并行操作。图灵机分为确定型和非确定型两种。确定型是指图灵机的每一步操作的结果是唯一确定的。所谓非确定型图灵机的每一步操作结果及下一步操作都有多种选择，不是唯一确定的。一个问题的复杂性由在图灵机上解此问题的最难实例所需要的最小时间与空间决定。即解此问题的最有效的算法所需的时间与空间来度量。</span></p><ul><li><p><span>在确定型图灵机上用多项式时间可解的问题，称为易处理问题。易处理判定问题的全体称为确定型多项式时间可解判定问题类，记为P。</span><em><span>验证容易</span></em></p></li><li><p><span>在非确定型图灵机上用多项式时间可解的判定问题，称为非确定型多项式时间可解判定问题，简称NP 问题。NP 问题的全体称为非确定型多项式时间可解判定问题类，记为NP 。求解分为猜测和验证阶段。</span><em><span>求解不容易</span></em></p></li><li><p><span>还没有人证明P = NP 或 </span><strong><span>P != NP</span></strong></p><ul><li><p><span>如果 “P=NP” 成立：意味着现在看起来很难的 NP 问题（比如密码破解、物流最优路径规划），其实都存在未被发现的多项式时间算法，未来能被轻松解决。</span></p></li><li><p><span>如果 “P≠NP” 成立：意味着 NP 问题中存在一些问题，它们的 “验证” 和 “求解” 效率有本质差距 —— 就算能快速验证答案，也找不到快速求解的方法，这也是目前学术界更倾向的猜想。 </span></p></li></ul></li><li><p><span>背包问题，又称子集和问题（subset sum）属于NP 问题。</span></p><p>&nbsp;</p></li></ul><h4 id='公钥密码基于的数学难题'><span>公钥密码基于的数学难题</span></h4><ul><li><p><span>背包问题</span></p></li><li><p><span>大整数分解问题（The Integer Factorization Problem，RSA 体制）</span></p></li><li><p><span>离散对数问题</span></p><ul><li><p><span>有限域的乘法群上的离散对数问题（The Discrete Logarithm ProblemProblem，ElGamal 体制）</span></p></li><li><p><span>定义在有限域的椭圆曲线上的离散对数问题（The Elliptic Curve Discrete Logarithm ProblemProblem，类比的ElGamal 体制）</span></p><p>&nbsp;</p></li></ul></li></ul><h3 id='一些数学定理们'><span>一些数学定理们</span></h3><h4 id='中国剩余定理'><span>中国剩余定理</span></h4><p><img src="./信息安全引论.assets/image-20251023153759458.png" alt="image-20251023153759458" style="zoom:40%;" /></p><p>&nbsp;</p><h4 id='fermat定理费马小定理'><span>Fermat定理（费马小定理）</span></h4><ul><li><p><span>p是素数，a是整数且不能被p整除，则 </span><strong><span>a</span><sup><span>p-1</span></sup><span> = 1 mod p</span></strong></p></li><li><p><span>推论：p是素数，a是任意整数，则 a</span><sup><span>p</span></sup><span> = a mod p</span></p><p><img src="./信息安全引论.assets/image-20251023154218001.png" alt="image-20251023154218001" style="zoom:40%;" /></p><p><span>eg. 计算 7</span><sup><span>201</span></sup><span> mod 11</span></p><p><em><span>由定理得 7</span><sup><span>10</span></sup><span> = 1 mod 11,</span></em><span> </span><em><span>则 7</span><sup><span>201</span></sup><span> = (7</span><sup><span>10</span></sup><span>)</span><sup><span>20</span></sup></em><span> * </span><em><span>7 = 7 mod 11</span></em></p><p>&nbsp;</p></li></ul><h4 id='欧拉定理'><span>欧拉定理</span></h4><h5 id='欧拉函数'><span>欧拉函数</span></h5><p><span>欧拉函数Φ(n)定义为小于n且与n互素的正整数个数。</span></p><ul><li><p><span>若n为素数，Φ(n)显然为n-1</span></p></li><li><p><span>若n可以质因数分解，则Φ(n)=n * Π(1-1/质因数)</span></p><p><span>eg. n = 20 = 2 * 2 * 5, Φ(n) = 20 * 1/2 * 4/5 = 8，即20有8个不含2也不含5的数，即有8个互素的数。</span></p><p><span>特别的，当n = p * q 时 (p,q为素数)，有Φ(n) = (1-p) * (1-q)</span></p></li></ul><h5 id='欧拉定理-2'><span>欧拉定理</span></h5><p><span>若a与n互素，则 </span><strong><span>a</span><sup><span>Φ(n)</span></sup><span> = 1 mod n</span></strong></p><p><span>推论：m</span><sup><span>k(p-1)(q-1)+1</span></sup><span> = m mod n，k为任意整数，</span><a href='可以证明m为p或q时也成立'><span>m为任意小于n非负整数</span></a></p><p><img src="./信息安全引论.assets/image-20251027101301629.png" alt="image-20251027101301629" style="zoom:40%;" /></p><p>&nbsp;</p><h4 id='有限域上的离散对数'><span>有限域上的离散对数</span></h4><ul><li><p><span>如果 a 是素数 p 的原根，则数 a mod p, a</span><sup><span>2</span></sup><span> mod p，…，a</span><sup><span>p-1</span></sup><span> mod p 是不同的并且包含1 到 p-1 的整数的某种排列，则称为一个</span><strong><span>有限循环群</span></strong><span>。</span></p></li><li><p><span>设G是一个阶为p的有限循环群，g是它的生成元，则G的元素可表示为： G = </span><span>{</span><span>1, g, g</span><sup><span>2</span></sup><span>, ..., g</span><sup><span>p-1</span></sup><span>} ，由此可见，对G的任何元素y，一定存在某一个正整数x∈(0, p-1) ，使得 y = g</span><sup><span>x</span></sup><span> mod p ，这里，称整数x是群G上元素y关于生成元g的</span><strong><span>离散对数</span></strong><span>。</span></p></li><li><p><span>离散对数难题（Discrete Logarithm Problem，DLP）是：在G上，对于方程 y = g</span><sup><span>x</span></sup><span> mod p </span></p><ul><li><p><span>已知g，x，p，计算y是容易的，</span></p></li><li><p><span>已知y，g，p，计算x是困难的。</span></p></li></ul></li><li><p><span>密码学中常用的主要有三个群的离散对数</span></p><ul><li><p><span>有限域 GF(p) 的乘法群</span></p></li><li><p><span>有限域 GF(2</span><sup><span>n</span></sup><span>) 上的乘法群</span></p></li><li><p><span>有限域F上的椭圆曲线群</span></p></li></ul></li></ul><p>&nbsp;</p><h2 id='三经典公钥密码算法'><span>三、经典公钥密码算法</span></h2><h3 id='diffie-hellman-密钥交换算法'><span>Diffie-Hellman 密钥交换算法</span></h3><p><span>只能用于交换密钥。算法的安全性依赖于有限域上计算离散对数的难度。</span></p><h5 id='算法'><span>算法</span></h5><ol start='' ><li><p><span>双方选择素数p以及p的一个原根a</span></p></li><li><p><span>用户A随机选择一个随机数 r</span><sub><span>a</span></sub><span>，计算 a</span><sup><span>ra</span></sup><span> mod p = m</span><sub><span>a</span></sub></p></li><li><p><span>用户B随机选择一个随机数 r</span><sub><span>b</span></sub><span>，计算 a</span><sup><span>rb</span></sup><span> mod p = m</span><sub><span>b</span></sub></p></li><li><p><span>双方保密r值，将取模得到的m值交换</span></p></li><li><p><span>用户A计算出m</span><sub><span>b</span></sub><sup><span>ra</span></sup><span> mod p</span></p></li><li><p><span>用户B计算出m</span><sub><span>a</span></sub><sup><span>rb</span></sup><span> mod p</span></p></li><li><p><span>双方获得共享密钥 a</span><sup><span>rxrb</span></sup><span> mod p</span></p></li></ol><h5 id='中间人攻击'><span>中间人攻击</span></h5><p><span>中间来个用户O，使得A和O商议出了一个密码，O和B商议出了一个密码。但是O永远必须实时截获并冒充转发，否则会被发现。</span></p><p>&nbsp;</p><h3 id='merkle-hellman-公钥算法基于背包问题'><span>Merkle-Hellman 公钥算法（基于背包问题）</span></h3><p><span>这是一个NP 完全问题，因为对于给定的子集易于验证其和是否为S 。然而，找到一个子集使其和为S要困难得多，有2</span><sup><span>n</span></sup><span>个可能的子集。因此可以把子集作为密钥，明文作为{0, 1, 0, 0, 1, ...}，S为密文。奥妙在于有两类背包，一类可以在线性时间内求解，另一类则不能。所以公开密钥使用难解的背包问题，私钥使用易解的背包问题。</span></p><h5 id='易解的背包问题'><span>易解的背包问题</span></h5><p><span>超递增背包：每个元素大于之后所有的元素的和。</span>
<span>Sol. 从最大的ai开始，如果S 大于这个数，则减去ai , 记xi为1，否则记xi为0。即可求解。</span></p><h5 id='转换背包'><span>转换背包</span></h5><p><span>选择一个整数 m &gt; 所有背包的和，选择一个和m互素的整数w，即可把所有 a</span><sub><span>i</span></sub><span> 转换为 a</span><sub><span>i</span></sub><span> * w mod m，得到难解的背包问题。</span></p><h5 id='算法-2'><span>算法</span></h5><ol start='' ><li><p><span>加密：使用难解背包公钥把明文的01串转换为S。</span></p></li><li><p><span>解密：计算S * w</span><sup><span>-1</span></sup><span> mod m，即可得到在简单背包下的和，然后求解简单背包即可。</span></p></li></ol><h5 id='意义'><span>意义</span></h5><p><span>是第一个推广的公钥加密算法。在实践过程中，大多数的背包方案都已被破解，或者证明存在缺陷，但它表示了如何将NP 完全问题用于公开密钥算法。</span></p><p>&nbsp;</p><h3 id='rsa-算法'><span>RSA 算法</span></h3><p><span>应用最广泛的公钥加密算法，使用欧拉定理。</span></p><h4 id='算法-3'><span>算法</span></h4><ul><li><p><span>考虑明文 m</span><sup><span>1+k(p-1)(q-1)</span></sup><span> = m mod n，n = pq。</span><em><span>[欧拉定理]</span></em></p></li><li><p><span>公钥为 {n, e}，e为一个与(p-1)(q-1)互素的数。</span></p><p><span>加密：c = m</span><sup><span>e</span></sup><span> mod n</span></p></li><li><p><span>私钥为 {p, q}，可以求得 e</span><sup><span>-1</span></sup><span> mod (p-1)(q-1)，则有 e</span><sup><span>-1</span></sup><span>e = 1 + k(p-1)(q-1)。</span></p><p><span>解密：m = c</span><sup><span>e&#39;</span></sup><span> = m</span><sup><span>e&#39;e</span></sup><span> = m</span><sup><span>1+k(p-1)(q-1)</span></sup><span> = m mod n</span></p></li><li><p><span>也可用于签名：</span></p><p><span>签名：s = m</span><sup><span>e&#39;</span></sup><span> mod n</span></p><p><span>验证：m = y</span><sup><span>e</span></sup><span> = m</span><sup><span>e&#39;e</span></sup><span> = m mod n</span></p></li></ul><p><span>一般，使用1e200数量级的p,q，n的二进制位数至少为2048位。为了提高加密速度，通常取e为特定的小整数，如3或2</span><sup><span>16</span></sup><span>+1。</span><em><span>此时加密速度一般比解密速度快十倍以上</span></em></p><blockquote><p><span>为了抵抗现有的整数分解算法，对p和q还有如下要求：</span>
<span>(1) |p-q| 很大，通常 p 和 q 的长度相同；</span>
<span>(2) p-1 和 q-1 分别含有大素因子 p</span><sub><span>1</span></sub><span> 和q</span><sub><span>1</span></sub>
<span>(3) P</span><sub><span>1</span></sub><span>-1 和 q</span><sub><span>1</span></sub><span>-1 也分别含有大素因子</span>
<span>(4) p+1 和 q+1 也分别含有大素因子</span></p></blockquote><p>&nbsp;</p><h4 id='实现中的问题'><span>实现中的问题</span></h4><h5 id='如何快速计算幂'><span>如何快速计算幂</span></h5><p><span>通过快速幂实现logn算法。</span></p><h5 id='如何找到两个大素数'><span>如何找到两个大素数</span></h5><p><span>因为试除法太慢了，所以采用统计素性检测（所有素数都满足的特性，但不充分）</span></p><ol start='' ><li><p><span>基于费马定理：p是素数，a是整数且不能被p整除，则 a</span><sup><span>p-1</span></sup><span> = 1 mod p。则可以随机选取多个基进行检测。</span></p></li><li><p><span>二次探测定理：x</span><sup><span>2</span></sup><span> = 1 mod p 的解一定是 1 mod p 和 -1 mod p</span><img src="./信息安全引论.assets/image-20251101162040102.png" alt="image-20251101162040102" style="zoom:40%;" /></p></li></ol><p><strong><span>Miller-Rabin素性检测</span></strong><span>：运用上面两条定理。</span></p><ol start='' ><li><p><span>现在我们要检测n，因为(n-1)是偶数，所以可表示为 2</span><sup><span>k</span></sup><span> * q（q 为奇数）</span></p></li><li><p><span>选一个整数a，0&lt;a&lt;n-1，计算幂序列模n的余数a</span><sup><span>q</span></sup><span>，a</span><sup><span>2q</span></sup><span>，a</span><sup><span>4q</span></sup><span>……，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.088ex" height="2.21ex" role="img" focusable="false" viewBox="0 -966.7 2249 976.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-32-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-32-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-32-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-32-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-32-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-32-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-32-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-32-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-32-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(521,0)"><use data-c="2212" xlink:href="#MJX-32-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1299,0)"><use data-c="31" xlink:href="#MJX-32-TEX-N-31"></use></g></g></g><g data-mml-node="mi" transform="translate(1855.1,0)"><use data-c="1D45E" xlink:href="#MJX-32-TEX-I-1D45E"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>q</mi></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k-1}q}</script></p></li><li><p><span>费马定理：如果满足 a</span><sup><span>q</span></sup><span> mod n = 1 (因为a</span><sup><span>n-1</span></sup><span> = </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.643ex" height="2.21ex" role="img" focusable="false" viewBox="0 -966.7 1610 976.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-33-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-33-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-33-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-33-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-33-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-33-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-33-TEX-I-1D458"></use></g></g></g><g data-mml-node="mi" transform="translate(951.4,0)"><use data-c="1D45E" xlink:href="#MJX-33-TEX-I-1D45E"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi></mrow></msup><mi>q</mi></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k}q}</script><span> = (a</span><sup><span>q</span></sup><span>)</span><sup><span>2k</span></sup><span> = 1 mod n)，则可能是素数。</span></p></li><li><p><span>如果不满足3，那么使用二次探测定理：首先根据费马定理，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="13.437ex" height="2.373ex" role="img" focusable="false" viewBox="0 -966.7 5939.3 1048.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.186ex;"><defs><path id="MJX-30-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-30-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-30-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-30-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-30-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-30-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-30-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-30-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-30-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-30-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-30-TEX-I-1D458"></use></g></g></g><g data-mml-node="mi" transform="translate(951.4,0)"><use data-c="1D45E" xlink:href="#MJX-30-TEX-I-1D45E"></use></g></g></g><g data-mml-node="mo" transform="translate(1887.8,0)"><use data-c="3D" xlink:href="#MJX-30-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(2943.6,0)"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-30-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-30-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(600,0)"><use data-c="2212" xlink:href="#MJX-30-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1378,0)"><use data-c="31" xlink:href="#MJX-30-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(5161.3,0)"><use data-c="3D" xlink:href="#MJX-30-TEX-N-3D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi></mrow></msup><mi>q</mi></mrow></msup><mo>=</mo><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k}q} = a^{n-1} =</script><span>1 mod p。所以根据二次探测定理，一定满足</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.088ex" height="2.21ex" role="img" focusable="false" viewBox="0 -966.7 2249 976.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-32-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-32-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-32-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-32-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-32-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-32-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-32-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-32-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-32-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(521,0)"><use data-c="2212" xlink:href="#MJX-32-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1299,0)"><use data-c="31" xlink:href="#MJX-32-TEX-N-31"></use></g></g></g><g data-mml-node="mi" transform="translate(1855.1,0)"><use data-c="1D45E" xlink:href="#MJX-32-TEX-I-1D45E"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>q</mi></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k-1}q}</script><span> = ±1 mod p (因为</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.088ex" height="2.21ex" role="img" focusable="false" viewBox="0 -966.7 2249 976.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-32-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-32-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-32-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-32-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-32-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-32-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-32-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-32-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-32-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(521,0)"><use data-c="2212" xlink:href="#MJX-32-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1299,0)"><use data-c="31" xlink:href="#MJX-32-TEX-N-31"></use></g></g></g><g data-mml-node="mi" transform="translate(1855.1,0)"><use data-c="1D45E" xlink:href="#MJX-32-TEX-I-1D45E"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>q</mi></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k-1}q}</script><span>是</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.643ex" height="2.21ex" role="img" focusable="false" viewBox="0 -966.7 1610 976.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.023ex;"><defs><path id="MJX-33-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-33-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-33-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-33-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D44E" xlink:href="#MJX-33-TEX-I-1D44E"></use></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-33-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-33-TEX-I-1D458"></use></g></g></g><g data-mml-node="mi" transform="translate(951.4,0)"><use data-c="1D45E" xlink:href="#MJX-33-TEX-I-1D45E"></use></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><msup><mn>2</mn><mrow data-mjx-texclass="ORD"><mi>k</mi></mrow></msup><mi>q</mi></mrow></msup></math></mjx-assistive-mml></mjx-container><script type="math/tex">a^{2^{k}q}</script><span>的平方根)。如果它余-1则满足要求，如果它余1则可以往前递推直到第一个。又因为第一个不余1，所以如果是素数，则序列中一定存在一个余-1的。</span></p></li><li><p><span>如果满足3或4，则可能是素数，继续换个数测测看。多测几次都成立的话，是素数的可能性就很大了。</span></p></li></ol><p><span>有性质：若n是一个奇合数，则在区间0&lt;b&lt;n 中，至多有25%个b, 使得用b测不出来n不是素数（此时称n为以b为基的强伪素数）。事实上，如果n≠9, 则至多有Φ(n)/4 个b, n是以b为基的强伪素数。Φ(n)是欧拉函数。</span></p><p><span>随机选取大约用ln(N)/2 的次数，如要找一个2</span><sup><span>200</span></sup><span> 数量级的数， ln(2</span><sup><span>200</span></sup><span> )/2=70</span></p><p>&nbsp;</p><h4 id='对rsa的选择密文攻击'><span>对RSA的选择密文攻击</span></h4><p><span>攻击思想：诱骗签名</span></p><p><span>回顾 RSA：加密 c = m</span><sup><span>e</span></sup><span> mod n，签名 s = m</span><sup><span>e&#39;</span></sup><span> mod n。公钥{n, e}, 私钥{p, q}, n=pq。</span></p><h5 id='eg1-套取信息'><span>eg1. 套取信息</span></h5><p>[<span>E</span>][eavesdropper]<span>监听A的通信，收集由A的公开密钥加密的密文c，想知道消息的明文m.</span></p><ol start='' ><li><p><span>E随机选一个数r, 将r</span><sup><span>e</span></sup><span>c发给A让A签名</span></p></li><li><p><span>则可以得到 s = (r</span><sup><span>e</span></sup><span>c)</span><sup><span>e&#39;</span></sup><span> = r * c</span><sup><span>e&#39;</span></sup><span> = r * m</span></p></li><li><p><span>则乘以一个r的逆元即可得到原明文~</span></p></li></ol><h5 id='eg2'><span>eg2.</span></h5><p><span>如果E想让A对m3文件签名，而E知道m3 = m1 * m2，则可以让A对m1,m2签名，乘起来即可得到对m3的签名。</span></p><p><em><span>所以不要用RSA对陌生人的随机文件签名！</span></em></p><p>&nbsp;</p><h4 id='对rsa的公共模攻击'><span>对RSA的公共模攻击</span></h4><p><span>一种可能的RSA实现方法是给每个人相同的n，但指数d和e不同。</span></p><p><span>问题：如果相同的消息曾用两个不同的指数加密，而这两个指数是互素的，则明文可以不用任何一个解密密钥来恢复。</span></p><ul><li><p><span>令m为明文消息，两个加密密钥为e1，e2，两个密文消息为c1，c2。c1=m</span><sup><span>e1</span></sup><span> mod n，c2=m</span><sup><span>e2</span></sup><span> mod n。</span></p></li><li><p><span>由于e1 和e2 互素，所以可以用扩展的Euclid 算法找到r,s 使 re1+se2=1</span></p></li><li><p><span>r和s会有一个是负数。负数无法直接幂运算，所以进行一个转换：假设r 是负数，用扩展Euclid算法计算c1的逆元，则 (c1</span><sup><span>-1</span></sup><span>)</span><sup><span>-r</span></sup><span> * c2</span><sup><span>s</span></sup><span> =m</span><sup><span>re1+se2</span></sup><span> = m mod n，即可得到明文。</span></p></li></ul><p><em><span>所以不要让一群用户共享一个模n！</span></em></p><p>&nbsp;</p><h4 id='对rsa的小加密指数攻击'><span>对RSA的小加密指数攻击</span></h4><p><span>因为对于同一个加密指数e和同一个明文m，如果得到多组密文模数对，则可通过中国剩余定理求解出 m</span><sup><span>e</span></sup></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n806" cid="n806" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-math-container"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="15.421ex" height="9.05ex" role="img" focusable="false" viewBox="0 -2250 6816.2 4000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -3.959ex;"><defs><path id="MJX-1-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-1-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-I-1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path><path id="MJX-1-TEX-N-A0" d=""></path><path id="MJX-1-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-1-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-1-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-1-TEX-N-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,1500)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-1-TEX-I-1D450"></use></g><g data-mml-node="mn" transform="translate(466,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(1147.3,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(2203.1,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="TeXAtom" transform="translate(911,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-1-TEX-I-1D452"></use></g></g></g><g data-mml-node="mtext" transform="translate(3493.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(3743.6,0)"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(4621.6,0)"><use data-c="1D45C" xlink:href="#MJX-1-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(5106.6,0)"><use data-c="1D451" xlink:href="#MJX-1-TEX-I-1D451"></use></g><g data-mml-node="mtext" transform="translate(5626.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="msub" transform="translate(5876.6,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-1-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"></use></g></g></g></g><g data-mml-node="mtr"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-1-TEX-I-1D450"></use></g><g data-mml-node="mn" transform="translate(466,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(1147.3,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(2203.1,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="TeXAtom" transform="translate(911,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-1-TEX-I-1D452"></use></g></g></g><g data-mml-node="mtext" transform="translate(3493.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(3743.6,0)"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(4621.6,0)"><use data-c="1D45C" xlink:href="#MJX-1-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(5106.6,0)"><use data-c="1D451" xlink:href="#MJX-1-TEX-I-1D451"></use></g><g data-mml-node="mtext" transform="translate(5626.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="msub" transform="translate(5876.6,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-1-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-1500)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-1-TEX-I-1D450"></use></g><g data-mml-node="mn" transform="translate(466,-150) scale(0.707)"><use data-c="33" xlink:href="#MJX-1-TEX-N-33"></use></g></g><g data-mml-node="mo" transform="translate(1147.3,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(2203.1,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="TeXAtom" transform="translate(911,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D452" xlink:href="#MJX-1-TEX-I-1D452"></use></g></g></g><g data-mml-node="mtext" transform="translate(3493.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="mi" transform="translate(3743.6,0)"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(4621.6,0)"><use data-c="1D45C" xlink:href="#MJX-1-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(5106.6,0)"><use data-c="1D451" xlink:href="#MJX-1-TEX-I-1D451"></use></g><g data-mml-node="mtext" transform="translate(5626.6,0)"><use data-c="A0" xlink:href="#MJX-1-TEX-N-A0"></use></g><g data-mml-node="msub" transform="translate(5876.6,0)"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-1-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(536,-150) scale(0.707)"><use data-c="33" xlink:href="#MJX-1-TEX-N-33"></use></g></g></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable rowspacing=".5em" columnspacing="1em" displaystyle="true"><mtr><mtd><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msup><mi>m</mi><mrow data-mjx-texclass="ORD"><mi>e</mi></mrow></msup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>&nbsp;</mtext><msub><mi>p</mi><mn>1</mn></msub></mtd></mtr><mtr><mtd><msub><mi>c</mi><mn>2</mn></msub><mo>=</mo><msup><mi>m</mi><mrow data-mjx-texclass="ORD"><mi>e</mi></mrow></msup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>&nbsp;</mtext><msub><mi>p</mi><mn>2</mn></msub></mtd></mtr><mtr><mtd><msub><mi>c</mi><mn>3</mn></msub><mo>=</mo><msup><mi>m</mi><mrow data-mjx-texclass="ORD"><mi>e</mi></mrow></msup><mtext>&nbsp;</mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>&nbsp;</mtext><msub><mi>p</mi><mn>3</mn></msub></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container></div></div><p><span>如果e过小，则可以从m</span><sup><span>e</span></sup><span>轻松解出m</span></p><p>&nbsp;</p><h4 id='对rsa的小解密指数攻击'><span>对RSA的小解密指数攻击</span></h4><p><span>如果e&#39;太小，直接穷举攻击即可。所以应选择一个大的e&#39;值。</span></p><p>&nbsp;</p><h4 id='对rsa的定时攻击'><span>对RSA的定时攻击</span></h4><p><span>基于加密程序运行时间的不一致性，可以根据加密时间长短逐个确定m的二进制位是否为1（是否执行了操作）</span></p><p><img src="./信息安全引论.assets/image-20251101185328408.png" alt="image-20251101185328408" style="zoom:33%;" /></p><h5 id='sol'><span>sol.</span></h5><ol start='' ><li><p><span>使用恒定的幂运算时间</span></p></li><li><p><span>增加随机延迟</span></p></li><li><p><span>盲化：收到密文后，给密文乘上一个随机数r</span><sup><span>e</span></sup><span>，再破解，再乘以r</span><sup><span>-1</span></sup><span>，得到原文。</span></p></li></ol><p>&nbsp;</p><h3 id='elgamal算法'><span>ElGamal算法</span></h3><p><span>基于有限域上离散对数的计算难度。</span></p><h4 id='算法-4'><span>算法</span></h4><ol start='' ><li><p><span>选取大质数p，以及p的原根g。原根：g</span><sup><span>Φ(p)</span></sup><span> = 1 mod p（只要互素即可）</span></p></li><li><p><span>随机选取指数i，计算 g</span><sup><span>i</span></sup></p></li><li><p><span>公钥为 {p, g, g</span><sup><span>i</span></sup><span>}，私钥为 {i}</span></p></li><li><p><span>加密：随机选择一个指数r，传递 c1 = g</span><sup><span>r</span></sup><span>, c2 = g</span><sup><span>ir</span></sup><span> * m</span></p></li><li><p><span>解密：计算 c1</span><sup><span>-i</span></sup><span> * c2 = g</span><sup><span>-ir</span></sup><span> * g</span><sup><span>ir</span></sup><span> * m = m</span></p></li></ol><p><em><span>信息有扩张：传递了两倍明文的长度</span></em></p><h4 id='安全性-2'><span>安全性</span></h4><p><span>需要使用不同的随机数r来加密。假设使用相同的r，得到 (c1, c2), (c1&#39;, c2&#39;)，则 c2/c2&#39; = m/m&#39;，则如果一个明文已知，就可以知道另一个明文。</span></p><p>&nbsp;</p><h3 id='椭圆曲线密码'><span>椭圆曲线密码</span></h3><p><span>基于有限域的椭圆曲线上的离散对数问题。</span></p><h4 id='算法-5'><span>算法</span></h4><ul><li><p><span>椭圆曲线：y</span><sup><span>2</span></sup><span>= x</span><sup><span>3</span></sup><span> + ax + b</span></p><p><img src="./信息安全引论.assets/image-20251102110959904.png" alt="image-20251102110959904" style="zoom:25%;" /><img src="./信息安全引论.assets/image-20251102111019269.png" alt="image-20251102111019269" style="zoom:25%;" /></p></li><li><p><span>一次运算：Q和R连线，相交，对称，得到-P1。Q和Q自己也可以做这个运算（切线）。记为&quot;+&quot;。</span></p></li><li><p><span>公钥：{基点，运算k次后得到的新点}。私钥：{k}。</span></p></li><li><p><span>思想：知道运算多少次后得到结果很容易，只知道结果想知道运算了多少次很困难。</span></p></li><li><p><span>加密思想（不要求）：</span></p><p><img src="./信息安全引论.assets/image-20251102112238142.png" alt="image-20251102112238142" style="zoom:25%;" /></p></li></ul><p><span>对椭圆曲线研究的时间短。椭圆曲线密钥长度短，速度快，可以用于加密、签名、密钥传递。</span></p><p>&nbsp;</p><h3 id='总结'><span>总结</span></h3><p><span>安全性比较：要达到相同破解计算量，各算法需要的密钥长度↓ </span><em><span>加密的各个环节的密钥强度需要一致，不然会攻击最弱的那个</span></em></p><p><img src="./信息安全引论.assets/image-20251030162927415.png" alt="image-20251030162927415" style="zoom:50%;" /></p><p><span>公钥算法加密解密速度慢，所以一般用来传递密钥，然后用对称加密算法加密信息。</span></p><hr /><p>&nbsp;</p><h1 id='lecture-5-消息鉴别'><span>Lecture 5. 消息鉴别</span></h1><h2 id='零intro'><span>零、Intro</span></h2><blockquote><p><span>数据完整性：（1）未被未授权篡改或者损坏。（2）数据是真实的和不可否认的，数据的发送方和接收方都不能否认其处理了该信息。</span></p><p><span>系统完整性：系统未被非授权操纵，按既定的功能运行。</span></p><p><span>真实性：确认实体是它所声明的。适用于用户、进程、系统、信息等。</span></p></blockquote><p><strong><span>消息鉴别：证实收到的消息 (1)来自可信的源点 (2)未被篡改</span></strong></p><p><span>一个简单模型：</span></p><p><img src="./信息安全引论.assets/image-20251030165153813.png" alt="image-20251030165153813" style="zoom:40%;" /></p><p><span>鉴别编码器和鉴别译码器可抽象为鉴别函数。</span></p><p><span>鉴别函数一般分为三种：</span></p><ol start='' ><li><p><span>消息加密函数(Message encryption): 用完整信息的密文作为对信息的鉴别。</span></p></li><li><p><span>散列函数(Hash Function): 一个散列函数以一个变长的报文作为输入，并产生一个固定长度的散列码，有时也称报文摘要，作为输出。是一个公开的函数。</span></p></li><li><p><span>消息鉴别码MAC (Message Authentication Code): 公开函数+密钥产生一个固定长度的值作为鉴别标识</span></p><p>&nbsp;</p></li></ol><h2 id='一消息加密函数'><span>一、消息加密函数</span></h2><h4 id='对称加密'><span>对称加密</span></h4><p><span>提供保密，提供鉴别，不提供签名（因为共享密钥无法实现身份区分）</span></p><h5 id='差错控制'><span>差错控制</span></h5><ol start='' ><li><p><span>内部差错控制：在加密之前计算校验和。</span></p></li><li><p><span>外部差错控制：在加密之后计算校验和。（这个比较擅长检验差错，因为内部差错控制动一点解密后就会动很多，就不好说了）</span></p></li></ol><p><img src="./信息安全引论.assets/image-20251110202401278.png" alt="image-20251110202401278" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='公钥加密'><span>公钥加密</span></h4><ul><li><p><span>用公钥加密：提供保密（公钥加密完后只有私钥能解）。</span></p></li><li><p><span>用私钥加密：提供鉴别，提供签名。</span></p></li></ul><p>&nbsp;</p><h2 id='二密码学散列函数'><span>二、密码学散列函数</span></h2><p><span>因为加密函数不是专门用来鉴别的，所以效率低，所以发明出密码学散列函数。</span></p><h4 id='散列函数的概念'><span>散列函数的概念</span></h4><p><span>对任意长度消息输出固定长度的散列值（称为消息摘要 Message Digest）。这个散列值是消息M的所有位的函数，并提供错误检测能力：消息中的任何一位或多位的变化都将导致该散列值的变化。</span></p><p><span>又称为：哈希函数、数字指纹（Digital finger print) 、压缩（Compression) 函数、紧缩（Contraction ）函数...</span></p><p><span>一般而言，对散列后的消息摘要进行加密传递，即可解密后进行验证。</span></p><h5 id='好处'><span>好处</span></h5><ul><li><p><span>提高数字签名的速度</span></p></li><li><p><span>无需泄露签名所对应的消息，可将签名泄露，如对消息x 的签名是y=Sig(z)，其中z=h(x), 可将 z,y 公开，而保密x。</span></p></li><li><p><span>可将签名变换和加密变换分开，可以在OSI 的不同层提供消息的完整性和机密性。</span></p></li></ul><h5 id='其他应用'><span>其他应用</span></h5><ol start='' ><li><p><span>生成单向口令文件（eg. 系统验证用户身份）</span></p></li><li><p><span>用于入侵与病毒检测（验证软件的消息摘要）</span></p></li><li><p><span>用于构建随机函数和伪随机函数</span></p><p>&nbsp;</p></li></ol><h4 id='基本用法'><span>基本用法</span></h4><p><span>一看就懂的一堆。eg. 加密消息摘要、消息和消息摘要一起加密、约定一个秘密值参与消息摘要计算、......</span></p><h5 id='约定一个秘密值参与消息摘要计算'><span>约定一个秘密值参与消息摘要计算</span></h5><p><img src="./信息安全引论.assets/image-20251112164918114.png" alt="image-20251112164918114" style="zoom:50%;" /></p><p><span>好处：不需要加密算法。（authentication：真实性，没有被他人篡改）</span></p><ul><li><p><span>加密软件很慢</span></p></li><li><p><span>加密硬件的开销很大</span></p></li><li><p><span>加密是对大长度数据进行优化的</span></p></li><li><p><span>加密算法可能受专利保护、可能受出口的限制...</span></p></li></ul><p>&nbsp;</p><h4 id='散列函数的要求'><span>散列函数的要求</span></h4><h5 id='安全要求'><span>安全要求</span></h5><ol start='' ><li><p><span>在计算量上无法找到两个散列结果一致的消息，不然可以视作对另一消息签了名。</span></p><p><span>所以定义</span><strong><span>弱无碰撞</span></strong><span>：对给定消息x，在计算上几乎找不到异于x的x&#39;，使h(x)=h(x’) 。满足要求的散列函数称为</span><em><span>抗第二原像攻击（抗弱碰撞攻击），Second preimage resistant (weak collision resistant)</span></em><span>。</span></p><p><strong><span>强无碰撞</span></strong><span>：对任意消息x，在计算上几乎找不到异于x的x&#39;，使h(x)=h(x’)。满足要求的散列函数称为</span><em><span>抗强碰撞攻击，Collision resistant (strong collision resistant)</span></em><span>。</span></p></li><li><p><span>不能让攻击者拿到消息摘要后反算出秘密值s，所以要求散列函数是</span><strong><span>单向</span></strong><span>的：计算h的逆函数在计算上不可行。满足要求的散列函数称为</span><em><span>抗原像攻击，Preimage resistant (one-way property)</span></em></p></li></ol><p><span>不同应用中有不同程度的安全要求：</span></p><p><img src="./信息安全引论.assets/image-20251112170914135.png" alt="image-20251112170914135" style="zoom:35%;" /></p><h5 id='其他要求'><span>其他要求</span></h5><ol start='' ><li><p><span>h 可以作用于一个任意长度的数据块</span></p></li><li><p><span>h 产生一个固定长度的输出；</span></p></li><li><p><span>对任意给定的x, h(x)计算相对容易，无论是软件还是硬件实现。</span></p></li><li><p><span>h的输出满足伪随机性测试标准</span></p></li></ol><h5 id='无碰撞'><span>无碰撞</span></h5><p><span>根据生日悖论的结论，可以知道当人数&gt;sqrt(天数)时，生日碰撞的概率&gt;50%</span></p><p><span>假如散列码为m位，即2</span><sup><span>m</span></sup><span>种输出</span></p><ul><li><p><span>弱无碰撞：只需要2</span><sup><span>m-1</span></sup><span>次攻击，使碰撞的概率&gt;50%。</span></p></li><li><p><span>强无碰撞：只需要2</span><sup><span>m/2</span></sup><span>次攻击，使碰撞的概率&gt;50%。</span></p></li></ul><p><span>eg. 假如散列码长度位64位，则A可以构造两份合同，各做&gt;32处微小变化↓，有很大可能可以找到一个版本使得两份合同哈希码一致，即可让B签名后进行替换。（</span><em><span>哈希值是A可以算的，B使用私钥对哈希值签名，A无法仿造签名</span></em><span>）</span></p><p><img src="./信息安全引论.assets/image-20251112173409601.png" alt="image-20251112173409601" style="zoom:33%;" /></p><p>&nbsp;</p><h4 id='散列函数的构造'><span>散列函数的构造</span></h4><ul><li><p><span>基于数学难题的构造方法：计算速度慢，不实用</span></p></li><li><p><span>利用对称密码体制来设计Hash：不实用</span></p></li><li><p><span>直接设计：好！</span></p></li></ul><h5 id='md结构'><span>MD结构</span></h5><p><span>由Merkle 于1989年提出，Ron Rivest于1990 年提出MD4，几乎被所有hash函数使用。</span></p><p><img src="./信息安全引论.assets/image-20251112180153089.png" alt="image-20251112180153089" style="zoom:40%;" /></p><ul><li><p><span>IV = initial value初始值</span></p></li><li><p><span>CV = chaining value</span></p></li><li><p><span>Yi = 第i个分组，依次送进压缩函数加工，压缩在一起。</span></p></li><li><p><span>f = compression algorithm (压缩算法）</span></p></li><li><p><span>b = length of input block(输入块的长度）</span></p></li></ul><h5 id='海绵结构sha3'><span>海绵结构（SHA3）</span></h5><p><img src="./信息安全引论.assets/image-20251112181709317.png" alt="image-20251112181709317" style="zoom:50%;" /></p><h4 id='散列函数重要算法'><span>散列函数重要算法</span></h4><p><strong><span>MD5</span></strong><span>（已破解，输入任意长度，</span><strong><span>512位块处理，输出128位</span></strong><span>），</span><strong><span>SHA1</span></strong><span>（已停用，输入小于2^64-1，</span><strong><span>512位块处理，输出160位</span></strong><span>），RIPEMD-160，SHA2，</span><strong><span>SHA3</span></strong><span>-512（输出512位，即64字节；</span><strong><span>海绵结构</span></strong><span>），SM3（中国）</span></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='三消息鉴别码mac'><span>三、消息鉴别码MAC</span></h2><h4 id='安全性-3'><span>安全性</span></h4><p><span>使用一个密钥生成一个固定大小的小数据块，并加入到消息中，称MAC， 或密码校验和（cryptographic</span>
<span>checksum）。MAC函数类似于加密函数，但不需要可逆性。因此在数学上比加密算法被攻击的弱点要少。接收者可以确信消息M 未被改变；来自所声称的发送者；如果消息中包含顺序码，则接收者可以保证消息的正常顺序。</span></p><div class="md-alert md-alert-tip tip"><p><span class='md-alert-text md-alert-text-tip'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</span><br></p><p><span>MAC和Hash的区别</span></p><ul><li><p><span>MAC：依赖密钥，确认消息完整地来自合法发送方，安全性依赖于对称密钥的保密性。只有持有相同密钥的通信方，才能正确生成或验证 MAC。如果密钥泄露，MAC 的安全性完全丧失。</span></p></li><li><p><span>Hash：是一种无密钥的单向函数，将任意长度的消息映射为固定长度的哈希值，用于确认消息未被篡改。安全性依赖于哈希算法本身的抗碰撞性。它不需要密钥，任何人都可以计算同一消息的哈希值。</span></p></li></ul></div><p>&nbsp;</p><h4 id='基于分组密码的cmac'><span>基于分组密码的CMAC</span></h4><h5 id='cbc-mac'><span>CBC-MAC</span></h5><p><img src="./信息安全引论.assets/image-20251112195339855.png" alt="image-20251112195339855" style="zoom:40%;" /></p><p><span>分组加密+异或前一组结果，取最后结果的前m位。</span></p><p><span>缺陷：要求信息长度固定为b的n倍；可以经过伪造伪造出比原信息更长但MAC一致的情况。（假设T=MAC(K,X)，则 X||(X xor T) 的MAC 依然是T。</span><em><span>前半部分X加密完得到T，T xor X xor T就是X，所以最终还是得到T</span></em><span>）</span></p><h5 id='cfb-mac'><span>CFB-MAC</span></h5><p><img src="./信息安全引论.assets/image-20251115191211072.png" alt="image-20251115191211072" style="zoom:60%;" /></p><p><span>CFB后取最后结果的前m位。</span></p><h5 id='cmac'><span>CMAC</span></h5><p><img src="./信息安全引论.assets/image-20251115191658992.png" alt="image-20251115191658992" style="zoom:40%;" /></p><p><span>支持任意长度消息。</span></p><ul><li><p><span>CBC-MAC：消息分组直接异或前一输出后加密，最终输出截取为 MAC，无额外密钥调整。</span></p></li><li><p><span>CMAC：</span></p><ul><li><p><span>当消息长度是分组倍数时，最后一个分组会异或一个预计算的密钥 </span><span>(</span><span>K1) 后加密。</span></p></li><li><p><span>当消息长度不是分组倍数时，最后一个分组会先填充（如补</span><code>10...0</code><span>），再异或另一个预计算的密钥 </span><span>(</span><span>K2)后加密。</span></p></li><li><p><span>K1K2由轮函数生成。</span></p></li></ul></li></ul><h5 id='基于分组密码的整体问题'><span>基于分组密码的整体问题</span></h5><p><span>用加密算法来检验真实性代价太大了。</span></p><p>&nbsp;</p><h4 id='基于hash函数的hmac'><span>基于Hash函数的HMAC</span></h4><blockquote><p><span>设计目标：</span></p><p><span>无需修改地使用现有的散列函数</span>
<span>当出现新的散列函数时 要能轻易地替换</span>
<span>保持散列函数的原有性能不会导致算法性能的降低</span>
<span>使用和处理密钥的方式简单</span>
<span>对鉴别机制的安全强度容易分析 与hash 函数有同等的安全性</span></p></blockquote><p><img src="./信息安全引论.assets/image-20251115192614108.png" alt="image-20251115192614108" style="zoom:45%;" /></p><p><span>流程可以理解为：用key异或ipad成为si，si粘在信息前面一起hash。再用key异或opad成为so，再粘到刚刚的结果后面再hash一次得到HMAC。</span></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='四伪随机数生成器'><span>四、伪随机数生成器</span></h2><p><span>PRNG：Pseudo Random Number Generator</span></p><p><span>取 Hash(seed) 得到的结果的前n位，seed+=1或seed=Hash(seed)，准备生成下一个。</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-6-数字签名'><span>Lecture 6. 数字签名</span></h1><h2 id='一对签名的攻击'><span>一、对签名的攻击</span></h2><h5 id='对签名方案的攻击模型'><span>对签名方案的攻击模型</span></h5><ol start='' ><li><p><span>唯密钥攻击（key only attack attack）：攻击者Oscar拥有Alice 的公钥</span></p></li><li><p><span>已知消息攻击（know message attack attack）：Oscar拥有一系列以前由Alice签名的消息和签名。</span></p></li><li><p><span>选择消息攻击：Oscar请求Alice对一个消息列表签名。</span></p></li></ol><h5 id='攻击目的'><span>攻击目的</span></h5><ol start='' ><li><p><span>完全破译（total break）：攻击者Oscar可以确定Alice的私钥</span></p></li><li><p><span>选择性伪造（selective forgery)：攻击者能以某一不可忽略的概率对一则选择的消息产生一个有效的签名。该消息不是以前Alice曾经签名的消息</span></p></li><li><p><span>存在性伪造（existential）：攻击者至少能够为一则消息产生一个有效的签名，该消息不应该是以前Alice 曾经签名的消息。</span></p></li></ol><blockquote><p><span>示例回顾</span></p><ul><li><p><span>唯密钥攻击的存在性伪造：Oscar 能通过对某一y 计算x=y</span><sup><span>e</span></sup><span> 伪造一个Alice对随机消息x的签名，因为y= y</span><sup><span>ed</span></sup><span>。即正向算出来了然后声称是Alice签的名。</span></p></li><li><p><span>已知消息攻击的存在性伪造：如果Osacr 拥有Alice 对消息x1, x2的签名分别是y1和y2，则Oscar 可伪造Alice 关于消息x1x2的签名y1y2。</span></p></li><li><p><span>选择消息攻击的选择性伪造：假定Oscar 要伪造消息x的签名，Oscar 请求A对x1, x2签名，签名结果分别是y 1 ,y 2 。 y 1 y 2 mod n 是消息x 1 x 2 mod n 的签名。</span></p></li></ul></blockquote><p>&nbsp;</p><h2 id='二数字签名分类'><span>二、数字签名分类</span></h2><ul><li><p><span>以验证方式分</span></p><ul><li><p><span>直接数字签名direct digital signature：只有通信双方参与。</span></p></li><li><p><span>仲裁数字签名arbitrated digital signature：有第三方可以参与验证。</span><em><span>通常的做法是所有从发送方X到接收方Y的签名消息首先送到仲裁者A，A将消息及其签名进行一系列测试，以检查其来源和内容，然后将消息加上日期并与已被仲裁者验证通过的指示一起发给Y。所有的参与者必须极大地相信这一仲裁机制工作正常</span></em><span>。</span></p></li></ul></li><li><p><span>计算能力分</span></p><ul><li><p><span>无条件安全的数字签名</span></p></li><li><p><span>计算上安全的数字签名</span></p></li></ul></li><li><p><span>以可签名次数分</span></p><ul><li><p><span>一次性的数字签名（理论上可以做到无条件安全）</span></p></li><li><p><span>多次性的数字签名</span></p></li></ul></li><li><p><span>具有特殊性质的数字签名</span></p></li></ul><p>&nbsp;</p><h2 id='三数字签名方案'><span>三、数字签名方案</span></h2><h5 id='签名与加密同时需要时'><span>签名与加密同时需要时</span></h5><p><span>推荐先签名后加密。如果先加密后签名，则需要公开对称密钥来验证签名，以及会有其他安全问题。</span></p><p>&nbsp;</p><h4 id='回顾'><span>回顾</span></h4><p><span>可以使用RSA、ElGamal、椭圆曲线进行数字签名</span></p><p>&nbsp;</p><h4 id='schnorr-数学签名方案'><span>Schnorr 数学签名方案</span></h4><p><span>基于离散对数。</span></p><p><img src="./信息安全引论.assets/image-20251115200639918.png" alt="image-20251115200639918" style="zoom: 33%;" /></p><p>&nbsp;</p><h4 id='dssdsa'><span>DSS/DSA</span></h4><p><span>数字签名标准，基于离散对数。</span></p><p><span>DSS（Digital signature Standard Standard），DSA (Digital signature algorithm)</span></p><p><img src="./信息安全引论.assets/image-20260108084542138.png" alt="image-20260108084542138" style="zoom:50%;" /></p><p><img src="./信息安全引论.assets/image-20260108084601975.png" alt="image-20260108084601975" style="zoom:50%;" /></p><h5 id='特点'><span>特点</span></h5><ul><li><p><span>DSS的签名比验证快得多</span></p></li><li><p><span>DSS不能用于加密或者密钥分配</span></p></li><li><p><span>若p为512位，q为160位，则r和s为两个160位，即签名长为320位</span></p></li><li><p><span>验证依赖于r，但r不依赖于消息，接收方可以利用收到的消息、签名及全局参数来恢复r</span></p></li><li><p><span>可提前计算r，r=( g</span><sup><span>k</span></sup><span> mod p)mod q</span></p></li></ul><h5 id='问题'><span>问题</span></h5><ol start='' ><li><p><span>若对0签名，会泄露密钥。</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="32.442ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 14339.2 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-34-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-34-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-34-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-34-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-34-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-34-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-34-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-34-TEX-I-1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-34-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-34-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-34-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-34-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-34-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-34-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-34-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path id="MJX-34-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-34-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-34-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-34-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-34-TEX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(746.8,0)"><use data-c="3D" xlink:href="#MJX-34-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1802.6,0)"><use data-c="30" xlink:href="#MJX-34-TEX-N-30"></use></g><g data-mml-node="mo" transform="translate(2580.3,0)"><use data-c="3D" xlink:href="#MJX-34-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(3636.1,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-34-TEX-I-1D458"></use></g><g data-mml-node="TeXAtom" transform="translate(554,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-34-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-34-TEX-N-31"></use></g></g></g><g data-mml-node="mrow" transform="translate(5310.5,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-34-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-34-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-34-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1555,0)"><use data-c="1D45A" xlink:href="#MJX-34-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(2433,0)"><use data-c="29" xlink:href="#MJX-34-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3044.2,0)"><use data-c="2B" xlink:href="#MJX-34-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(4044.4,0)"><use data-c="1D465" xlink:href="#MJX-34-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(4616.4,0)"><use data-c="1D45F" xlink:href="#MJX-34-TEX-I-1D45F"></use></g><g data-mml-node="mo" transform="translate(5067.4,0)"><use data-c="5D" xlink:href="#MJX-34-TEX-N-5D"></use></g></g><g data-mml-node="mspace" transform="translate(10655.9,0)"></g><g data-mml-node="mi" transform="translate(11489.6,0)"><use data-c="6D" xlink:href="#MJX-34-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-34-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-34-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(13378.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(13545.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(13879.2,0)"><use data-c="1D45E" xlink:href="#MJX-34-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><mn>0</mn><mo>=</mo><msup><mi>k</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo data-mjx-texclass="CLOSE">]</mo></mrow><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex"> s = 0 = k^{-1}\left[H(m) + xr\right] \mod q </script><span> 那么 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="23.413ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 10348.6 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-35-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-35-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-35-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-35-TEX-I-1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-35-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-35-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-35-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-35-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-35-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-35-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-35-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-35-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-35-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-35-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(849.8,0)"><use data-c="3D" xlink:href="#MJX-35-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(1905.6,0)"><use data-c="2212" xlink:href="#MJX-35-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(2683.6,0)"><use data-c="1D43B" xlink:href="#MJX-35-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(3571.6,0)"><use data-c="28" xlink:href="#MJX-35-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(3960.6,0)"><use data-c="1D45A" xlink:href="#MJX-35-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(4838.6,0)"><use data-c="29" xlink:href="#MJX-35-TEX-N-29"></use></g><g data-mml-node="msup" transform="translate(5227.6,0)"><g data-mml-node="mi"><use data-c="1D45F" xlink:href="#MJX-35-TEX-I-1D45F"></use></g><g data-mml-node="TeXAtom" transform="translate(484,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-35-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-35-TEX-N-31"></use></g></g></g><g data-mml-node="mspace" transform="translate(6665.2,0)"></g><g data-mml-node="mi" transform="translate(7498.9,0)"><use data-c="6D" xlink:href="#MJX-35-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-35-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-35-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(9387.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(9554.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(9888.6,0)"><use data-c="1D45E" xlink:href="#MJX-35-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><msup><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">x = -H(m)r^{-1} \mod q </script></p></li><li><p><span>不能泄露随机数k，否则可以由</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="28.293ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 12505.7 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-36-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-36-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-36-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-36-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-36-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-36-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-36-TEX-I-1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-36-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-36-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-36-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-36-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-36-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-36-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-36-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path id="MJX-36-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-36-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-36-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-36-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-36-TEX-I-1D460"></use></g><g data-mml-node="mo" transform="translate(746.8,0)"><use data-c="3D" xlink:href="#MJX-36-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(1802.6,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-36-TEX-I-1D458"></use></g><g data-mml-node="TeXAtom" transform="translate(554,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-36-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-36-TEX-N-31"></use></g></g></g><g data-mml-node="mrow" transform="translate(3476.9,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-36-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-36-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-36-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1555,0)"><use data-c="1D45A" xlink:href="#MJX-36-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(2433,0)"><use data-c="29" xlink:href="#MJX-36-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3044.2,0)"><use data-c="2B" xlink:href="#MJX-36-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(4044.4,0)"><use data-c="1D465" xlink:href="#MJX-36-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(4616.4,0)"><use data-c="1D45F" xlink:href="#MJX-36-TEX-I-1D45F"></use></g><g data-mml-node="mo" transform="translate(5067.4,0)"><use data-c="5D" xlink:href="#MJX-36-TEX-N-5D"></use></g></g><g data-mml-node="mspace" transform="translate(8822.3,0)"></g><g data-mml-node="mi" transform="translate(9656,0)"><use data-c="6D" xlink:href="#MJX-36-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-36-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-36-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(11545,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(11712,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12045.7,0)"><use data-c="1D45E" xlink:href="#MJX-36-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo data-mjx-texclass="CLOSE">]</mo></mrow><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex"> s = k^{-1}\left[H(m)+ xr\right] \mod q</script><span>求出</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="26.658ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 11783 1083.9" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-37-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-37-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-37-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-37-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-37-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-37-TEX-I-1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-37-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-37-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-37-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-37-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-37-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-37-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-37-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-37-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-37-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-37-TEX-I-1D465"></use></g><g data-mml-node="mo" transform="translate(849.8,0)"><use data-c="3D" xlink:href="#MJX-37-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(1905.6,0)"><use data-c="1D460" xlink:href="#MJX-37-TEX-I-1D460"></use></g><g data-mml-node="mi" transform="translate(2374.6,0)"><use data-c="1D458" xlink:href="#MJX-37-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(3117.8,0)"><use data-c="2212" xlink:href="#MJX-37-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(4118,0)"><use data-c="1D43B" xlink:href="#MJX-37-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(5006,0)"><use data-c="28" xlink:href="#MJX-37-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(5395,0)"><use data-c="1D45A" xlink:href="#MJX-37-TEX-I-1D45A"></use></g><g data-mml-node="mo" transform="translate(6273,0)"><use data-c="29" xlink:href="#MJX-37-TEX-N-29"></use></g><g data-mml-node="msup" transform="translate(6662,0)"><g data-mml-node="mi"><use data-c="1D45F" xlink:href="#MJX-37-TEX-I-1D45F"></use></g><g data-mml-node="TeXAtom" transform="translate(484,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-37-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-37-TEX-N-31"></use></g></g></g><g data-mml-node="mspace" transform="translate(8099.7,0)"></g><g data-mml-node="mi" transform="translate(8933.3,0)"><use data-c="6D" xlink:href="#MJX-37-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-37-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-37-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(10822.3,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(10989.3,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(11323,0)"><use data-c="1D45E" xlink:href="#MJX-37-TEX-I-1D45E"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mi>s</mi><mi>k</mi><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><msup><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mspace width="0.667em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">x = sk-H(m)r^{-1} \mod q </script></p></li><li><p><span>不要用同一个k签两个不同的消息。</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n1144" cid="n1144" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-math-container"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="51.562ex" height="36.433ex" role="img" focusable="false" viewBox="0 -8301.8 22790.2 16103.6" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -17.651ex;"><defs><path id="MJX-2-TEX-N-A0" d=""></path><path id="MJX-2-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-2-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-2-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-2-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-2-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-2-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-2-TEX-I-1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-2-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-2-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-2-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-2-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-2-TEX-I-1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path><path id="MJX-2-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-2-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-2-TEX-N-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path id="MJX-2-TEX-I-1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-2-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,7551.8)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">设</text><text data-variant="normal" transform="translate(888.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">用</text><text data-variant="normal" transform="translate(1777.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">同</text><text data-variant="normal" transform="translate(2665.9,0) scale(1,-1)" font-size="887.7px" font-family="serif">一</text><text data-variant="normal" transform="translate(3554.5,0) scale(1,-1)" font-size="887.7px" font-family="serif">随</text><text data-variant="normal" transform="translate(4443.1,0) scale(1,-1)" font-size="887.7px" font-family="serif">机</text><text data-variant="normal" transform="translate(5331.7,0) scale(1,-1)" font-size="887.7px" font-family="serif">数</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(6220.4,0)"></use></g><g data-mml-node="mi" transform="translate(6470.4,0)"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="mtext" transform="translate(6991.4,0)"><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0"></use><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="887.7px" font-family="serif">对</text><text data-variant="normal" transform="translate(1138.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">消</text><text data-variant="normal" transform="translate(2027.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">息</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(2915.9,0)"></use></g><g data-mml-node="msub" transform="translate(10157.2,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mtext" transform="translate(11471.8,0)"><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0"></use><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="887.7px" font-family="serif">和</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(1138.6,0)"></use></g><g data-mml-node="msub" transform="translate(12860.4,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="mtext" transform="translate(14175,0)"><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0"></use><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="887.7px" font-family="serif">签</text><text data-variant="normal" transform="translate(1138.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">名</text><text data-variant="normal" transform="translate(2027.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">，</text><text data-variant="normal" transform="translate(2915.9,0) scale(1,-1)" font-size="887.7px" font-family="serif">得</text><text data-variant="normal" transform="translate(3804.5,0) scale(1,-1)" font-size="887.7px" font-family="serif">到</text><text data-variant="normal" transform="translate(4693.1,0) scale(1,-1)" font-size="887.7px" font-family="serif">：</text></g></g></g><g data-mml-node="mtr" transform="translate(0,6117.9)"><g data-mml-node="mtd" transform="translate(2128,0)"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(1333.6,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="TeXAtom" transform="translate(554,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mrow" transform="translate(3007.9,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-2-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1555,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(2869.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3480.8,0)"><use data-c="2B" xlink:href="#MJX-2-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(4481,0)"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(5053,0)"><use data-c="1D45F" xlink:href="#MJX-2-TEX-I-1D45F"></use></g><g data-mml-node="mo" transform="translate(5504,0)"><use data-c="5D" xlink:href="#MJX-2-TEX-N-5D"></use></g></g><g data-mml-node="mspace" transform="translate(8789.9,0)"></g><g data-mml-node="mi" transform="translate(9956.6,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-2-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-2-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(11845.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(12012.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12346.2,0)"><use data-c="1D45E" xlink:href="#MJX-2-TEX-I-1D45E"></use></g></g></g><g data-mml-node="mtr" transform="translate(0,4683.9)"><g data-mml-node="mtd" transform="translate(2128,0)"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(1333.6,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="TeXAtom" transform="translate(554,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mrow" transform="translate(3007.9,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-2-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1555,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(2869.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3480.8,0)"><use data-c="2B" xlink:href="#MJX-2-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(4481,0)"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(5053,0)"><use data-c="1D45F" xlink:href="#MJX-2-TEX-I-1D45F"></use></g><g data-mml-node="mo" transform="translate(5504,0)"><use data-c="5D" xlink:href="#MJX-2-TEX-N-5D"></use></g></g><g data-mml-node="mspace" transform="translate(8789.9,0)"></g><g data-mml-node="mi" transform="translate(9956.6,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-2-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-2-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(11845.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(12012.6,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12346.2,0)"><use data-c="1D45E" xlink:href="#MJX-2-TEX-I-1D45E"></use></g></g></g><g data-mml-node="mtr" transform="translate(0,3383.9)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g></g><g data-mml-node="mtr" transform="translate(0,2083.9)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">两</text><text data-variant="normal" transform="translate(888.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">式</text><text data-variant="normal" transform="translate(1777.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">相</text><text data-variant="normal" transform="translate(2665.9,0) scale(1,-1)" font-size="887.7px" font-family="serif">减</text><text data-variant="normal" transform="translate(3554.5,0) scale(1,-1)" font-size="887.7px" font-family="serif">消</text><text data-variant="normal" transform="translate(4443.1,0) scale(1,-1)" font-size="887.7px" font-family="serif">去</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(5331.7,0)"></use></g><g data-mml-node="mi" transform="translate(5581.7,0)"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"></use></g><g data-mml-node="mi" transform="translate(6153.7,0)"><use data-c="1D45F" xlink:href="#MJX-2-TEX-I-1D45F"></use></g><g data-mml-node="mtext" transform="translate(6604.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">：</text></g></g></g><g data-mml-node="mtr" transform="translate(0,650)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(1127.8,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(2128,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(1333.6,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="TeXAtom" transform="translate(554,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mrow" transform="translate(3007.9,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-2-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1555,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(2869.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3480.8,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(4481,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(5369,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(5758,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(7072.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(7461.6,0)"><use data-c="5D" xlink:href="#MJX-2-TEX-N-5D"></use></g></g><g data-mml-node="mspace" transform="translate(10747.5,0)"></g><g data-mml-node="mi" transform="translate(11914.1,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-2-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-2-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(13803.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(13970.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(14303.8,0)"><use data-c="1D45E" xlink:href="#MJX-2-TEX-I-1D45E"></use></g></g></g><g data-mml-node="mtr" transform="translate(0,-650)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g></g><g data-mml-node="mtr" transform="translate(0,-2083.9)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">两</text><text data-variant="normal" transform="translate(888.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">边</text><text data-variant="normal" transform="translate(1777.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">乘</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(2665.9,0)"></use></g><g data-mml-node="mi" transform="translate(2915.9,0)"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="mtext" transform="translate(3436.9,0)"><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0"></use><text data-variant="normal" transform="translate(250,0) scale(1,-1)" font-size="887.7px" font-family="serif">再</text><text data-variant="normal" transform="translate(1138.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">乘</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(2027.2,0)"></use></g><g data-mml-node="mo" transform="translate(5714.1,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(6103.1,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(7230.9,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(8231.1,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="msup" transform="translate(9136.7,0)"><g data-mml-node="mo"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="TeXAtom" transform="translate(422,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mtext" transform="translate(10512.3,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">，</text><text data-variant="normal" transform="translate(888.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">可</text><text data-variant="normal" transform="translate(1777.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">得</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(2665.9,0)"></use></g><g data-mml-node="mi" transform="translate(13428.2,0)"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="mtext" transform="translate(13949.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">：</text></g></g></g><g data-mml-node="mtr" transform="translate(0,-3517.9)"><g data-mml-node="mtd" transform="translate(2512.6,0)"><g data-mml-node="mi"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="mrow" transform="translate(1333.6,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-2-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(278,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(1166,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(1555,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(2869.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(3480.8,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(4481,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(5369,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(5758,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(7072.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(7461.6,0)"><use data-c="5D" xlink:href="#MJX-2-TEX-N-5D"></use></g></g><g data-mml-node="mo" transform="translate(9295.3,0)"><use data-c="22C5" xlink:href="#MJX-2-TEX-N-22C5"></use></g><g data-mml-node="mo" transform="translate(9795.6,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(10184.6,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(11312.3,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="msub" transform="translate(12312.5,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g></g><g data-mml-node="msup" transform="translate(13218.1,0)"><g data-mml-node="mo"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="TeXAtom" transform="translate(422,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mspace" transform="translate(14593.8,0)"></g><g data-mml-node="mi" transform="translate(15760.5,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-2-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-2-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(17649.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(17816.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(18150.1,0)"><use data-c="1D45E" xlink:href="#MJX-2-TEX-I-1D45E"></use></g></g></g><g data-mml-node="mtr" transform="translate(0,-4817.9)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g></g><g data-mml-node="mtr" transform="translate(0,-6117.9)"><g data-mml-node="mtd" transform="translate(3033.6,0)"></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mtext"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">代</text><text data-variant="normal" transform="translate(888.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">入</text><text data-variant="normal" transform="translate(1777.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">任</text><text data-variant="normal" transform="translate(2665.9,0) scale(1,-1)" font-size="887.7px" font-family="serif">意</text><text data-variant="normal" transform="translate(3554.5,0) scale(1,-1)" font-size="887.7px" font-family="serif">一</text><text data-variant="normal" transform="translate(4443.1,0) scale(1,-1)" font-size="887.7px" font-family="serif">个</text><text data-variant="normal" transform="translate(5331.7,0) scale(1,-1)" font-size="887.7px" font-family="serif">签</text><text data-variant="normal" transform="translate(6220.4,0) scale(1,-1)" font-size="887.7px" font-family="serif">名</text><text data-variant="normal" transform="translate(7109,0) scale(1,-1)" font-size="887.7px" font-family="serif">式</text><text data-variant="normal" transform="translate(7997.6,0) scale(1,-1)" font-size="887.7px" font-family="serif">，</text><text data-variant="normal" transform="translate(8886.2,0) scale(1,-1)" font-size="887.7px" font-family="serif">即</text><text data-variant="normal" transform="translate(9774.8,0) scale(1,-1)" font-size="887.7px" font-family="serif">可</text><text data-variant="normal" transform="translate(10663.5,0) scale(1,-1)" font-size="887.7px" font-family="serif">求</text><text data-variant="normal" transform="translate(11552.1,0) scale(1,-1)" font-size="887.7px" font-family="serif">出</text><text data-variant="normal" transform="translate(12440.7,0) scale(1,-1)" font-size="887.7px" font-family="serif">私</text><text data-variant="normal" transform="translate(13329.3,0) scale(1,-1)" font-size="887.7px" font-family="serif">钥</text><use data-c="A0" xlink:href="#MJX-2-TEX-N-A0" transform="translate(14218,0)"></use></g><g data-mml-node="mi" transform="translate(14468,0)"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"></use></g><g data-mml-node="mtext" transform="translate(15040,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="887.7px" font-family="serif">：</text></g></g></g><g data-mml-node="mtr" transform="translate(0,-7551.8)"><g data-mml-node="mtd" transform="translate(2461.6,0)"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"></use></g></g><g data-mml-node="mtd" transform="translate(3033.6,0)"><g data-mml-node="mi"></g><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use></g><g data-mml-node="mrow" transform="translate(1333.6,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mi" transform="translate(1294.6,0)"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(2037.8,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(3038,0)"><use data-c="1D43B" xlink:href="#MJX-2-TEX-I-1D43B"></use></g><g data-mml-node="mo" transform="translate(3926,0)"><use data-c="28" xlink:href="#MJX-2-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(4315,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mn" transform="translate(911,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(5629.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(6018.6,0)"><use data-c="29" xlink:href="#MJX-2-TEX-N-29"></use></g></g><g data-mml-node="mo" transform="translate(7963.3,0)"><use data-c="22C5" xlink:href="#MJX-2-TEX-N-22C5"></use></g><g data-mml-node="msup" transform="translate(8463.6,0)"><g data-mml-node="mi"><use data-c="1D45F" xlink:href="#MJX-2-TEX-I-1D45F"></use></g><g data-mml-node="TeXAtom" transform="translate(484,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(778,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"></use></g></g></g><g data-mml-node="mspace" transform="translate(9901.2,0)"></g><g data-mml-node="mi" transform="translate(11067.9,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="6F" xlink:href="#MJX-2-TEX-N-6F" transform="translate(833,0)"></use><use data-c="64" xlink:href="#MJX-2-TEX-N-64" transform="translate(1333,0)"></use></g><g data-mml-node="mstyle" transform="translate(12956.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(13123.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(13457.6,0)"><use data-c="1D45E" xlink:href="#MJX-2-TEX-I-1D45E"></use></g></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true" columnalign="right left" columnspacing="0em" rowspacing="3pt"><mtr><mtd></mtd><mtd><mtext>设用同一随机数&nbsp;</mtext><mi>k</mi><mtext>&nbsp;对消息&nbsp;</mtext><msub><mi>m</mi><mn>1</mn></msub><mtext>&nbsp;和&nbsp;</mtext><msub><mi>m</mi><mn>2</mn></msub><mtext>&nbsp;签名，得到：</mtext></mtd></mtr><mtr><mtd><msub><mi>s</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msup><mi>k</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo data-mjx-texclass="CLOSE">]</mo></mrow><mspace width="1em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></mtd></mtr><mtr><mtd><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msup><mi>k</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo data-mjx-texclass="CLOSE">]</mo></mrow><mspace width="1em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext>两式相减消去&nbsp;</mtext><mi>x</mi><mi>r</mi><mtext>：</mtext></mtd></mtr><mtr><mtd><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msup><mi>k</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo data-mjx-texclass="CLOSE">]</mo></mrow><mspace width="1em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext>两边乘&nbsp;</mtext><mi>k</mi><mtext>&nbsp;再乘&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mtext>，可得&nbsp;</mtext><mi>k</mi><mtext>：</mtext></mtd></mtr><mtr><mtd><mi>k</mi></mtd><mtd><mi></mi><mo>=</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">[</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo data-mjx-texclass="CLOSE">]</mo></mrow><mo>⋅</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>1</mn></msub><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mspace width="1em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></mtd></mtr><mtr><mtd></mtd></mtr><mtr><mtd></mtd><mtd><mtext>代入任意一个签名式，即可求出私钥&nbsp;</mtext><mi>x</mi><mtext>：</mtext></mtd></mtr><mtr><mtd><mi>x</mi></mtd><mtd><mi></mi><mo>=</mo><mrow data-mjx-texclass="INNER"><mo data-mjx-texclass="OPEN">(</mo><msub><mi>s</mi><mn>1</mn></msub><mi>k</mi><mo>−</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo data-mjx-texclass="CLOSE">)</mo></mrow><mo>⋅</mo><msup><mi>r</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>1</mn></mrow></msup><mspace width="1em"></mspace><mi>mod</mi><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mstyle scriptlevel="0"><mspace width="0.167em"></mspace></mstyle><mi>q</mi></mtd></mtr></mtable></math></mjx-assistive-mml></mjx-container></div></div></li></ol><p>&nbsp;</p><h4 id='rsa-pss'><span>RSA-PSS</span></h4><p><span>probabilistic signature scheme</span></p><p><span>引入随机数，使得同一则消息签名两次也不一样。</span></p><p>&nbsp;</p><h4 id='一次性数字签名'><span>一次性数字签名</span></h4><p><span>一次性签名方案是指仅能对一条消息安全签名的数字签名技术—— 它在对单条消息签名时具备安全性，但如果用同一套密钥对多条消息签名，就会被攻击者破解并伪造签名。</span></p><p><span>应用场景：高安全、轻量化的场景比较适用。</span></p><blockquote><p><span>Lamport签名方案：得到一个巨长的签名。</span></p></blockquote><p>&nbsp;</p><h4 id='不可否认签名'><span>不可否认签名</span></h4><p><span>由三部分组成：签名算法、验证协议、否认协议。</span></p><p><span>由Chaum 和van Antwerpen 在1989年提出，其中最主要的特征是没有签名者的合作，签名就不能得到验证。从而防止了由她签署的电子文档资料没有经过她的同意而被复制和分发的可能性。</span></p><p><span>如果要阻止她否认，一个不可否认签名与一个否认协议结合，通过这种方式A 能证明一个签名是伪造签名。</span></p><p>&nbsp;</p><h4 id='群签名方案'><span>群签名方案</span></h4><p><span>群中各个成员以群的名义匿名地签发消息，由三个算法组成：签名算法、验证算法和识别算法。</span></p><ol start='' ><li><p><span>只有群内成员能为消息签名</span></p></li><li><p><span>接收者能验证签名是来自于该群的合法签名</span></p></li><li><p><span>接收者不能确认签名者是群内的哪一个人</span></p></li><li><p><span>需要时可借助于群成员或者可信机构找到签名者</span></p></li></ol><p><span>应用场景：公司打印机管理</span></p><p>&nbsp;</p><h4 id='盲签名'><span>盲签名</span></h4><p><span>应用场景：用户的支付信息（如金额、账户）盲化后交给银行签名，银行看不到具体支付详情，却能确认交易合法；用户还原签名后完成支付，第三方可验证签名来自银行，确保交易有效，但无法追溯用户隐私信息。</span></p><p><span>盲签名过程：消息→盲变换→签名→接收者→逆盲变换</span></p><blockquote><p><span>怎么知道该不该对盲消息签名？---&gt; 如果发送者篡改了原始消息 m，则盲消息会不符合数学规则，签名者可以拒绝签名；只有合法的盲化过程，才能让最终还原的签名有效。</span></p></blockquote><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-7-密码实际应用问题'><span>Lecture 7. 密码实际应用问题</span></h1><h2 id='一intro'><span>一、Intro</span></h2><h4 id='应用位置'><span>应用位置</span></h4><p><span>从密码技术应用的逻辑位置看，数据链路层以下的加密称为链路加密，网络层以上的高层协议加密为端对端的加密。（加密载荷，不加密头）（在网关中要解密再重新加密）</span></p><p><img src="./信息安全引论.assets/image-20251113162334359.png" alt="image-20251113162334359" style="zoom:50%;" /></p><h4 id='通信安全模型'><span>通信安全模型</span></h4><p><img src="./信息安全引论.assets/image-20251113162722131.png" alt="image-20251113162722131" style="zoom:40%;" /></p><h4 id='密钥管理'><span>密钥管理</span></h4><p><span>密钥都有生存周期（Cryptoperiods）：授权使用该密钥的周期。</span></p><blockquote><p><span>因为 ①拥有大量的密文有助于密码分析；②在单一密钥受到威胁时，限制信息的暴露；③限制一技术使用到它估计的有效期；④限制计算密集型密码分析攻击的有效时间</span></p></blockquote><p><span>密钥的生命流程：产生（可能需要登记）--&gt; 分配 --&gt; 使用 --&gt; 更新/替换 --&gt; 撤销 --&gt; 销毁</span></p><p><span>建议密钥生存期：OUP（发起方使用期限：数据被加密的时间段），RUP（接收方使用期限：数据继续保持为密文直到解密的时间段）</span></p><p><img src="./信息安全引论.assets/image-20251113171445129.png" alt="image-20251113171445129" style="zoom:50%;" /></p><p><span>密钥管理：在一种安全策略指导下密钥的产生、存储、分配、删除、归档及应用。维持系统中各实体之间的密钥关系，以抗击各种可能的威胁（eg. 密钥的泄露，秘密密钥或公开密钥的身份的真实性丧失，未经授权使用）</span></p><p>&nbsp;</p><h4 id='密钥类型'><span>密钥类型</span></h4><ol start='' ><li><p><span>会话密钥（Session Key）：即两个通信终端用户在</span><strong><span>一次通话</span></strong><span>或交换数据时使用的密钥。当它用于加密文件时，称为文件密钥(File key)，当它用于加密数据时，称为数据加密密钥(Data Encrypting Key)。</span></p></li><li><p><span>密钥加密密钥（Key Encrypting Key）：用于对会话密钥或文件密钥进行加密时采用的密钥。又称辅助（二级）密钥(Secondary Key)或密钥传送密钥(key Transport key)。</span></p></li><li><p><span>主机主密钥（Host Master Key）：一般出厂的时候就存于主机处理器中。</span><em><span>一般用主机主密钥传递密钥加密密钥，用密钥加密密钥传递会话密钥</span></em></p></li><li><p><span>基本密钥（Base Key）：又称初始密钥（Primary Key)，用户密钥(User key)，是由用户选定或由系统分配给用户的，可在较长时间（相对于会话密钥）内由一对用户所专用的密钥。</span></p></li><li><p><span>在公钥体制下，还有公开密钥、秘密密钥、签名密钥之分。</span></p></li></ol><p>&nbsp;</p><h2 id='二密钥管理'><span>二、密钥管理</span></h2><h4 id='密钥产生'><span>密钥产生</span></h4><ul><li><p><span>两种方式：手工/自动化</span></p></li><li><p><span>选择密钥方式不当会影响安全性：使密钥空间减小（eg. 只使用小写字母）；差的选择方式易受</span>[<span>字典式攻击</span>][利用预先构建的 “字典库”（包含大量可能的密钥字符串），逐一尝试匹配目标密钥]</p></li><li><p><span>好的密钥：真正的随机、等概</span></p><ul><li><p><span>避免使用特定算法的弱密钥</span></p></li><li><p><span>公钥体制的密钥必须满足一定的数学关系</span></p></li><li><p><span>选用易记难猜的密钥，如：一句话的首字母</span></p></li></ul></li><li><p><span>不同等级的密钥的重要性不同，产生方式不同</span></p><ul><li><p><span>主机主密钥安全性至关重要，故要保证其完全随机性、不可重复性和不可预测性。可用投硬币、骰子，噪声发生器等方法产生。</span></p></li><li><p><span>密钥加密密钥数量大(N(N-1)/2)，可采用一些安全算法或者伪随机数发生器由机器自动产生。</span></p></li><li><p><span>会话密钥可利用密钥加密密钥及某种算法（加密算法、单向函数等）产生。</span></p></li><li><p><span>初始密钥：类似于主密钥或密钥加密密钥的方法产生。</span></p></li></ul></li></ul><h5 id='集中式密钥与分散式密钥'><span>集中式密钥与分散式密钥</span></h5><ul><li><p><span>集中式：在中心统一进行生产（eg. 传统的密钥分发中心KDC 和证书分发中心 CDC 等方案），生产有边界，边界以所能配置的密钥总量定义，其用户数量受限。密钥的认证协议简洁，交易中的安全责任由中心承担。</span></p></li><li><p><span>分散式：由个人生产，密钥生产无边界，其用户数量不受限制。密钥变量中的公钥必须公开，需经第三方认证，交易中安全责任由个人承担。</span></p><p>&nbsp;</p></li></ul><h4 id='密钥的登记'><span>密钥的登记</span></h4><p><span>将产生的密钥与特定的使用捆绑在一起，例如，用于数字签名的密钥，必须与签名者的身份捆绑在一起。这个捆绑必须通过某一授权机构来完成。</span></p><p>&nbsp;</p><h4 id='密钥的装入'><span>密钥的装入</span></h4><ul><li><p><span>主机主密钥: 直接或间接装入,装入时须有电磁屏蔽,装入后不能再读出(但可间接验证)</span></p></li><li><p><span>终端主密钥: 直接或间接装入,装入时须有电磁屏蔽,装入后不能再读出,可联机或者间接验证</span></p></li><li><p><span>会话密钥: 不存在装入问题</span></p></li></ul><p>&nbsp;</p><h4 id='密钥的存储和保护'><span>密钥的存储和保护</span></h4><p><span>密钥的完整性和机密性都需要保护。</span></p><blockquote><p><span>最安全的方法是将其放在物理上安全的地方。当一个密钥无法用物理的办法进行安全保护时，密钥必须用其它的方法来保护：秘密共享；通过机密性（例如，用另一个密钥加密）和/或完整性服务来保护。</span></p></blockquote><h5 id='公钥的存储'><span>公钥的存储</span></h5><p><span>公钥也需要完整性真实性保护。</span></p><ol start='' ><li><p><span>将所有公钥存储在专用媒体（软盘、芯片等）一次性发放给各用户。</span></p></li><li><p><span>用对方的公钥建立密钥环各自分散保存（如安全电子邮件系统PGP）。</span></p></li><li><p><span>将各用户的公钥存放在公用媒体中。</span></p></li></ol><p>&nbsp;</p><h4 id='密钥分配'><span>密钥分配</span></h4><ul><li><p><span>密钥分配协议：系统内的一个成员选择密钥，然后将它们安全传给其他成员。</span></p></li><li><p><span>密钥协定协议：系统两个或者多个成员在公开的信道上联合建立秘密密钥，两个成员的密钥协定也称为密钥交换。</span></p></li></ul><p><span>详见</span><a href='#三密钥分配'><span>三-密钥分配</span></a></p><p>&nbsp;</p><h4 id='密钥使用控制'><span>密钥使用控制</span></h4><p><span>确保打算用于一种目的的密钥不能和用于另一种目的的密钥交替使用。这就要求将密钥值和密钥的合法使用范围绑定在一起。也称为密钥隔离。</span></p><p><span>思想：把“用途”的消息摘要和密钥异或，只有任务一致才能解密。</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2 id='三密钥分配'><span>三、密钥分配</span></h2><h3 id='密钥分配协议'><span>密钥分配协议</span></h3><h4 id='基于对称密码体制的密钥分配'><span>基于对称密码体制的密钥分配</span></h4><p><span>金融机构密钥管理 ANSI X9.17（1985年）三层密钥层次结构：1. 主密钥（KKMs）通过手工分配；2. 密钥加密密钥（KKs），通过在线分配；3. 数据密钥（KDs）。</span></p><ul><li><p><span>静态分配：是一种由中心以脱线方式预分配的技术。优点：安全性好，是长期沿用的传统密钥管理技术。缺点：必须解决密钥的存储技术。</span></p></li><li><p><span>动态分配：是“请求-分发”的在线分发技术。优点：分发及时，成本相对较低。缺点：需要有专门的协议的支持。</span></p></li></ul><h5 id='主密钥的分配方式'><span>主密钥的分配方式</span></h5><p><span>利用安全信道实现：1. 直接面议或通过可靠信使递送 2.将密钥分拆成几部分分别传送</span></p><h5 id='密钥的静态配置'><span>密钥的静态配置</span></h5><ul><li><p><span>网状配置：两两用户之间都有密钥。</span></p></li><li><p><span>星状配置：</span><img src="./信息安全引论.assets/image-20251115194832010.png" alt="image-20251115194832010" style="zoom:33%;" /></p><p><span>非对称密钥的话就由上级往下分发私钥、上级保管公钥。</span></p></li></ul><h5 id='第三方'><span>第三方</span></h5><p><img src="./信息安全引论.assets/image-20251113170006911.png" alt="image-20251113170006911" style="zoom:33%;" /></p><p><em><span>optional应该指的是并非所有交互都必须经过TTP</span></em></p><blockquote><p><span>eg. on-line：提供对称密钥；off-line：提供验证过的公钥。</span></p></blockquote><h5 id='动态分配-kdc与ktc'><span>动态分配-KDC与KTC</span></h5><p><span>为会话生成临时会话密钥。</span></p><p><span>KDC: 密钥分配中心（密钥由中心产生）</span><em><span>典型流程：A说我和B要用密钥，KDC生成密钥，用A和KDC的公共密钥加密后给A，用B和KDC的公共密钥加密后给B</span></em></p><p><span>KTC: 密钥转递中心（密钥由用户产生）</span><em><span>典型流程：A说我有个密钥，KTC把密钥翻译成B能用的密钥然后发给B</span></em></p><ul><li><p><span>问题：B直接收到密钥就相信了，那其他人很容易伪造一个发给B啊。A随便发一个KDC就响应了，那其他人重发一个一样的KDC就继续加密了</span><em><span>（【重放攻击】eg. 拦截用户的 “转账 100 元” 加密请求后，多次重发该请求，可能导致用户重复转账）</span></em></p></li><li><p><span>Sol. 带鉴别与抗重放机制的密钥分配方案</span></p><p><img src="./信息安全引论.assets/image-20251120152500645.png" alt="image-20251120152500645" style="zoom:70%;" /></p><p><span>N1，N2为随机数</span></p><blockquote><p><span>步骤 (1)：A 向 KDC 发起请求</span></p><ul><li><p><span>A 向 KDC 发送包含 随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span> 的请求（Request || </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>）。</span></p></li><li><p><span>随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>的作用：抗重放攻击（KDC 会验证该随机数的新鲜性，确保不是攻击者重放的旧请求）。</span></p></li></ul><p><span>步骤 (2)：KDC 生成并分发会话密钥</span></p><ul><li><p><span>KDC 生成会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>，然后构造密文：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="39.322ex" height="2.289ex" role="img" focusable="false" viewBox="0 -750 17380.5 1011.6" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.592ex;"><defs><path id="MJX-42-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-42-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-42-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-42-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-42-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-42-TEX-N-2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path><path id="MJX-42-TEX-N-52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"></path><path id="MJX-42-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-42-TEX-N-71" d="M33 218Q33 308 95 374T236 441H246Q330 441 381 372L387 364Q388 364 404 403L420 442H457V156Q457 -132 458 -134Q462 -142 470 -145Q491 -148 519 -148H535V-194H527L504 -193Q480 -192 453 -192T415 -191Q312 -191 303 -194H295V-148H311Q339 -148 360 -145Q369 -141 371 -135T373 -106V-41V49Q313 -11 236 -11Q154 -11 94 53T33 218ZM376 300Q346 389 278 401Q275 401 269 401T261 402Q211 400 171 350T131 214Q131 137 165 82T253 27Q296 27 328 54T376 118V300Z"></path><path id="MJX-42-TEX-N-75" d="M383 58Q327 -10 256 -10H249Q124 -10 105 89Q104 96 103 226Q102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441T184 442H187V261Q188 77 190 64Q193 49 204 40Q224 26 264 26Q290 26 311 35T343 58T363 90T375 120T379 144Q379 145 379 161T380 201T380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81Q468 61 479 55T524 46H542V0Q540 0 467 -5T390 -11H383V58Z"></path><path id="MJX-42-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path id="MJX-42-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJX-42-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-42-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-42-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-42-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-42-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-42-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-42-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-42-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-42-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-42-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-42-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-42-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-42-TEX-I-1D44E"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1744.5,0)"><use data-c="5B" xlink:href="#MJX-42-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2022.5,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-42-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-42-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(3563.9,0)"><use data-c="2225" xlink:href="#MJX-42-TEX-N-2225"></use></g><g data-mml-node="mtext" transform="translate(4341.7,0)"><use data-c="52" xlink:href="#MJX-42-TEX-N-52"></use><use data-c="65" xlink:href="#MJX-42-TEX-N-65" transform="translate(736,0)"></use><use data-c="71" xlink:href="#MJX-42-TEX-N-71" transform="translate(1180,0)"></use><use data-c="75" xlink:href="#MJX-42-TEX-N-75" transform="translate(1708,0)"></use><use data-c="65" xlink:href="#MJX-42-TEX-N-65" transform="translate(2264,0)"></use><use data-c="73" xlink:href="#MJX-42-TEX-N-73" transform="translate(2708,0)"></use><use data-c="74" xlink:href="#MJX-42-TEX-N-74" transform="translate(3102,0)"></use></g><g data-mml-node="mo" transform="translate(8110.5,0)"><use data-c="2225" xlink:href="#MJX-42-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(8888.3,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-42-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-42-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(10405.6,0)"><use data-c="2225" xlink:href="#MJX-42-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(11183.4,0)"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-42-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-42-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44F" xlink:href="#MJX-42-TEX-I-1D44F"></use></g></g></g></g><g data-mml-node="mo" transform="translate(12877.9,0)"><use data-c="28" xlink:href="#MJX-42-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(13266.9,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-42-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-42-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(14530.5,0)"><use data-c="2C" xlink:href="#MJX-42-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(14975.2,0)"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-42-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-42-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-42-TEX-I-1D434"></use></g></g><g data-mml-node="mo" transform="translate(16713.5,0)"><use data-c="29" xlink:href="#MJX-42-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(17102.5,0)"><use data-c="5D" xlink:href="#MJX-42-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>a</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi>K</mi><mi>s</mi></msub><mo>∥</mo><mtext>Request</mtext><mo>∥</mo><msub><mi>N</mi><mn>1</mn></msub><mo>∥</mo><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>b</mi></msub></mrow></msub><mo stretchy="false">(</mo><msub><mi>K</mi><mi>s</mi></msub><mo>,</mo><msub><mtext>ID</mtext><mi>A</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_a}[K_s \parallel \text{Request} \parallel N_1 \parallel E_{K_b}(K_s, \text{ID}_A)]</script><span>并发送给 A。</span></p></li><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.856ex" height="2.287ex" role="img" focusable="false" viewBox="0 -750 3472.5 1011.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.591ex;"><defs><path id="MJX-43-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-43-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-43-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-43-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-43-TEX-N-2026" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60ZM525 60Q525 84 542 102T585 120Q609 120 627 104T646 61Q646 36 629 18T586 0T543 17T525 60ZM972 60Q972 84 989 102T1032 120Q1056 120 1074 104T1093 61Q1093 36 1076 18T1033 0T990 17T972 60Z"></path><path id="MJX-43-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-43-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-43-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-43-TEX-I-1D44E"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1744.5,0)"><use data-c="5B" xlink:href="#MJX-43-TEX-N-5B"></use></g><g data-mml-node="mo" transform="translate(2022.5,0)"><use data-c="2026" xlink:href="#MJX-43-TEX-N-2026"></use></g><g data-mml-node="mo" transform="translate(3194.5,0)"><use data-c="5D" xlink:href="#MJX-43-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>a</mi></msub></mrow></msub><mo stretchy="false">[</mo><mo>…</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_a}[\dots]</script><span>：用 A 与 KDC 之间的 长期共享密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.955ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1306.1 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-44-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-44-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-44-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-44-TEX-I-1D44E"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>a</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_a</script><span> 加密，确保只有 A 能解密。</span></p></li><li><p><span>密文内容包含：会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>、A 的请求原文、随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>（用于 A 验证 KDC 的响应新鲜性），以及用 B 与 KDC 的长期共享密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.795ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1235.3 840.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.357ex;"><defs><path id="MJX-50-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-50-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-50-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44F" xlink:href="#MJX-50-TEX-I-1D44F"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>b</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_b</script><span> 加密的</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.558ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4224.6 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-48-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-48-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-48-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-48-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-48-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-48-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-48-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-48-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-48-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-48-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-48-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(1652.6,0)"><use data-c="2C" xlink:href="#MJX-48-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(2097.3,0)"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-48-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-48-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-48-TEX-I-1D434"></use></g></g><g data-mml-node="mo" transform="translate(3835.6,0)"><use data-c="29" xlink:href="#MJX-48-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>K</mi><mi>s</mi></msub><mo>,</mo><msub><mtext>ID</mtext><mi>A</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">(K_s, \text{ID}_A)</script><span>（用于后续发给 B）。</span></p></li></ul><p><span>步骤 (3)：A 将 B 的密钥信息转发给 B</span></p><ul><li><p><span>A 从步骤 (2) 的密文中提取出</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="13.392ex" height="2.289ex" role="img" focusable="false" viewBox="0 -750 5919.2 1011.6" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.592ex;"><defs><path id="MJX-49-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-49-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-49-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path><path id="MJX-49-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-49-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-49-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-49-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-49-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-49-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-49-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-49-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-49-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44F" xlink:href="#MJX-49-TEX-I-1D44F"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1694.5,0)"><use data-c="28" xlink:href="#MJX-49-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(2083.5,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-49-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-49-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(3347.2,0)"><use data-c="2C" xlink:href="#MJX-49-TEX-N-2C"></use></g><g data-mml-node="msub" transform="translate(3791.8,0)"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-49-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-49-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-49-TEX-I-1D434"></use></g></g><g data-mml-node="mo" transform="translate(5530.2,0)"><use data-c="29" xlink:href="#MJX-49-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>b</mi></msub></mrow></msub><mo stretchy="false">(</mo><msub><mi>K</mi><mi>s</mi></msub><mo>,</mo><msub><mtext>ID</mtext><mi>A</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_b}(K_s, \text{ID}_A)</script><span>，并转发给 B。</span></p></li><li><p><span>B 收到后，用自己与 KDC 的长期共享密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.795ex" height="1.902ex" role="img" focusable="false" viewBox="0 -683 1235.3 840.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.357ex;"><defs><path id="MJX-50-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-50-TEX-I-1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-50-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D44F" xlink:href="#MJX-50-TEX-I-1D44F"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>b</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_b</script><span>解密，即可获得会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>和 A 的身份标识</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.933ex" height="1.891ex" role="img" focusable="false" viewBox="0 -683 1738.3 835.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.345ex;"><defs><path id="MJX-80-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-80-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-80-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-80-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-80-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-80-TEX-I-1D434"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>ID</mtext><mi>A</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{ID}_A</script><span>，从而确认 &quot;这是 KDC 为 A 和自己分配的会话密钥&quot;。</span></p></li></ul><p><span>步骤 (4)：B 向 A 发起身份认证</span></p><ul><li><p><span>B 生成随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>，用会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>加密后发给 A（</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="7.941ex" height="2.287ex" role="img" focusable="false" viewBox="0 -750 3510.1 1011.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.591ex;"><defs><path id="MJX-55-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-55-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-55-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-55-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-55-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-55-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-55-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-55-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-55-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-55-TEX-I-1D460"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1714.5,0)"><use data-c="5B" xlink:href="#MJX-55-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(1992.5,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-55-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-55-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(3232.1,0)"><use data-c="5D" xlink:href="#MJX-55-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>s</mi></msub></mrow></msub><mo stretchy="false">[</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_s}[N_2]</script><span>）。</span></p></li><li><p><span>随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>的作用：既用于 B 验证 A 的身份，也用于抗重放攻击（确保是新鲜的通信）。</span></p></li></ul><p><span>步骤 (5)：A 向 B 完成身份认证</span></p><ul><li><p><span>A 对</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>进行某种变换（如哈希函数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.633ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1606 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-58-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-58-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-58-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path><path id="MJX-58-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-58-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(550,0)"><use data-c="28" xlink:href="#MJX-58-TEX-N-28"></use></g><g data-mml-node="mo" transform="translate(939,0)"><use data-c="22C5" xlink:href="#MJX-58-TEX-N-22C5"></use></g><g data-mml-node="mo" transform="translate(1217,0)"><use data-c="29" xlink:href="#MJX-58-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">f(\cdot)</script><span>），再用会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>加密后发给 B（</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="10.946ex" height="2.287ex" role="img" focusable="false" viewBox="0 -750 4838.1 1011.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.591ex;"><defs><path id="MJX-60-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-60-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-60-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-60-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-60-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-60-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-60-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-60-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-60-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-60-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-60-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-60-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-60-TEX-I-1D460"></use></g></g></g></g><g data-mml-node="mo" transform="translate(1714.5,0)"><use data-c="5B" xlink:href="#MJX-60-TEX-N-5B"></use></g><g data-mml-node="mi" transform="translate(1992.5,0)"><use data-c="1D453" xlink:href="#MJX-60-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(2542.5,0)"><use data-c="28" xlink:href="#MJX-60-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(2931.5,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-60-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-60-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(4171.1,0)"><use data-c="29" xlink:href="#MJX-60-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(4560.1,0)"><use data-c="5D" xlink:href="#MJX-60-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><msub><mi>K</mi><mi>s</mi></msub></mrow></msub><mo stretchy="false">[</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{K_s}[f(N_2)]</script><span>）。</span></p></li><li><p><span>B 收到后，对自己生成的</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>执行相同变换，若结果一致，则确认 A 的身份合法（因为只有掌握</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>的 A 能正确变换</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>）。</span></p></li></ul></blockquote><p><span>核心设计亮点：</span></p><ul><li><p><span>身份鉴别：通过 &quot;随机数挑战 - 响应&quot; 机制（</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>和</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.809ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2567.6 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-77-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-77-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-77-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-77-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-77-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-77-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(550,0)"><use data-c="28" xlink:href="#MJX-77-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(939,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-77-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-77-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(2178.6,0)"><use data-c="29" xlink:href="#MJX-77-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">f(N_2)</script><span>），确保通信双方身份真实。</span></p></li><li><p><span>抗重放攻击：利用随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>（防止 A 重放对 KDC 的请求）和</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>（防止 B 或攻击者重放认证信息），保证每个通信流程都是 &quot;新鲜&quot; 的。</span></p></li></ul><p><span>缺点：KDC知道所有密钥，可以知道所有通信内容。</span></p></li></ul><h5 id='动态分配-去中心化分配'><span>动态分配-去中心化分配</span></h5><p><img src="./信息安全引论.assets/image-20251122144745116.png" alt="image-20251122144745116" style="zoom:50%;" /></p><blockquote><p><span>步骤 (1)：发起方 A 向响应方 B 发送请求，包含随机数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>（用于抗重放攻击，确保请求的新鲜性）。</span></p><p><span>步骤 (2)：B 生成会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>，并构造密文：</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="40.03ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 17693.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-70-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-70-TEX-N-4D" d="M132 622Q125 629 121 631T105 634T62 637H29V683H135Q221 683 232 682T249 675Q250 674 354 398L458 124L562 398Q666 674 668 675Q671 681 683 682T781 683H887V637H854Q814 636 803 634T785 622V61Q791 51 802 49T854 46H887V0H876Q855 3 736 3Q605 3 596 0H585V46H618Q660 47 669 49T688 61V347Q688 424 688 461T688 546T688 613L687 632Q454 14 450 7Q446 1 430 1T410 7Q409 9 292 316L176 624V606Q175 588 175 543T175 463T175 356L176 86Q187 50 261 46H278V0H269Q254 3 154 3Q52 3 37 0H29V46H46Q78 48 98 56T122 69T132 86V622Z"></path><path id="MJX-70-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-70-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-70-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-70-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-70-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-70-TEX-N-2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path><path id="MJX-70-TEX-N-52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"></path><path id="MJX-70-TEX-N-65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z"></path><path id="MJX-70-TEX-N-71" d="M33 218Q33 308 95 374T236 441H246Q330 441 381 372L387 364Q388 364 404 403L420 442H457V156Q457 -132 458 -134Q462 -142 470 -145Q491 -148 519 -148H535V-194H527L504 -193Q480 -192 453 -192T415 -191Q312 -191 303 -194H295V-148H311Q339 -148 360 -145Q369 -141 371 -135T373 -106V-41V49Q313 -11 236 -11Q154 -11 94 53T33 218ZM376 300Q346 389 278 401Q275 401 269 401T261 402Q211 400 171 350T131 214Q131 137 165 82T253 27Q296 27 328 54T376 118V300Z"></path><path id="MJX-70-TEX-N-75" d="M383 58Q327 -10 256 -10H249Q124 -10 105 89Q104 96 103 226Q102 335 102 348T96 369Q86 385 36 385H25V408Q25 431 27 431L38 432Q48 433 67 434T105 436Q122 437 142 438T172 441T184 442H187V261Q188 77 190 64Q193 49 204 40Q224 26 264 26Q290 26 311 35T343 58T363 90T375 120T379 144Q379 145 379 161T380 201T380 248V315Q380 361 370 372T320 385H302V431Q304 431 378 436T457 442H464V264Q464 84 465 81Q468 61 479 55T524 46H542V0Q540 0 467 -5T390 -11H383V58Z"></path><path id="MJX-70-TEX-N-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path id="MJX-70-TEX-N-74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z"></path><path id="MJX-70-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-70-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-70-TEX-I-1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path id="MJX-70-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-70-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-70-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-70-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-70-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-70-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-70-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-70-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4D" xlink:href="#MJX-70-TEX-N-4D"></use><use data-c="4B" xlink:href="#MJX-70-TEX-N-4B" transform="translate(917,0)"></use><use data-c="6D" xlink:href="#MJX-70-TEX-N-6D" transform="translate(1695,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(2608.6,0)"><use data-c="5B" xlink:href="#MJX-70-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2886.6,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-70-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-70-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(4428,0)"><use data-c="2225" xlink:href="#MJX-70-TEX-N-2225"></use></g><g data-mml-node="mtext" transform="translate(5205.8,0)"><use data-c="52" xlink:href="#MJX-70-TEX-N-52"></use><use data-c="65" xlink:href="#MJX-70-TEX-N-65" transform="translate(736,0)"></use><use data-c="71" xlink:href="#MJX-70-TEX-N-71" transform="translate(1180,0)"></use><use data-c="75" xlink:href="#MJX-70-TEX-N-75" transform="translate(1708,0)"></use><use data-c="65" xlink:href="#MJX-70-TEX-N-65" transform="translate(2264,0)"></use><use data-c="73" xlink:href="#MJX-70-TEX-N-73" transform="translate(2708,0)"></use><use data-c="74" xlink:href="#MJX-70-TEX-N-74" transform="translate(3102,0)"></use></g><g data-mml-node="mo" transform="translate(8974.5,0)"><use data-c="2225" xlink:href="#MJX-70-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(9752.3,0)"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-70-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-70-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-150) scale(0.707)"><use data-c="1D435" xlink:href="#MJX-70-TEX-I-1D435"></use></g></g><g data-mml-node="mo" transform="translate(11774.8,0)"><use data-c="2225" xlink:href="#MJX-70-TEX-N-2225"></use></g><g data-mml-node="mi" transform="translate(12552.6,0)"><use data-c="1D453" xlink:href="#MJX-70-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(13102.6,0)"><use data-c="28" xlink:href="#MJX-70-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(13491.6,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-70-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-70-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(14731.1,0)"><use data-c="29" xlink:href="#MJX-70-TEX-N-29"></use></g><g data-mml-node="mo" transform="translate(15397.9,0)"><use data-c="2225" xlink:href="#MJX-70-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(16175.7,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-70-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-70-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(17415.2,0)"><use data-c="5D" xlink:href="#MJX-70-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>MKm</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>K</mi><mi>s</mi></msub><mo>∥</mo><mtext>Request</mtext><mo>∥</mo><msub><mtext>ID</mtext><mi>B</mi></msub><mo>∥</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>∥</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{\text{MKm}}[K_s \parallel \text{Request} \parallel \text{ID}_B \parallel f(N_1) \parallel N_2]</script></p><ul><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.719ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 2528 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: 0px;"><defs><path id="MJX-71-TEX-N-4D" d="M132 622Q125 629 121 631T105 634T62 637H29V683H135Q221 683 232 682T249 675Q250 674 354 398L458 124L562 398Q666 674 668 675Q671 681 683 682T781 683H887V637H854Q814 636 803 634T785 622V61Q791 51 802 49T854 46H887V0H876Q855 3 736 3Q605 3 596 0H585V46H618Q660 47 669 49T688 61V347Q688 424 688 461T688 546T688 613L687 632Q454 14 450 7Q446 1 430 1T410 7Q409 9 292 316L176 624V606Q175 588 175 543T175 463T175 356L176 86Q187 50 261 46H278V0H269Q254 3 154 3Q52 3 37 0H29V46H46Q78 48 98 56T122 69T132 86V622Z"></path><path id="MJX-71-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-71-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4D" xlink:href="#MJX-71-TEX-N-4D"></use><use data-c="4B" xlink:href="#MJX-71-TEX-N-4B" transform="translate(917,0)"></use><use data-c="6D" xlink:href="#MJX-71-TEX-N-6D" transform="translate(1695,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>MKm</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{MKm}</script><span>是 A 和 B 之间的长期共享主密钥（用于加密会话密钥等关键信息）</span></p></li><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.809ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2567.6 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-72-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-72-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-72-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-72-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-72-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-72-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(550,0)"><use data-c="28" xlink:href="#MJX-72-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(939,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-72-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-72-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(2178.6,0)"><use data-c="29" xlink:href="#MJX-72-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>1</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">f(N_1)</script><span>是对</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>的变换（验证 A 的身份）</span></p></li><li><p><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>是 B 生成的新随机数（用于后续认证）</span></p></li></ul><p><span>步骤 (3)：A 用会话密钥</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>对</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>进行变换（如哈希函数</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="5.809ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2567.6 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-77-TEX-I-1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path><path id="MJX-77-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-77-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-77-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-77-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D453" xlink:href="#MJX-77-TEX-I-1D453"></use></g><g data-mml-node="mo" transform="translate(550,0)"><use data-c="28" xlink:href="#MJX-77-TEX-N-28"></use></g><g data-mml-node="msub" transform="translate(939,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-77-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-77-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(2178.6,0)"><use data-c="29" xlink:href="#MJX-77-TEX-N-29"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">f(N_2)</script><span>），加密后发给 B，完成身份认证。</span></p></blockquote><p><span>核心设计亮点：</span></p><ul><li><p><span>无中心化 KDC：通信双方通过长期共享主密钥直接协商会话密钥，避免了对第三方的依赖。</span></p></li><li><p><span>适用于小型网络（节点少、信任关系明确）</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><h4 id='基于公钥体制的密钥分配'><span>基于公钥体制的密钥分配</span></h4><h5 id='simple-secret-key-distribution'><span>Simple secret key distribution</span></h5><p><span>啥也没干的基础公钥运作体系，中间人随意干预。</span></p><p><img src="./信息安全引论.assets/image-20251120153847373.png" alt="image-20251120153847373" style="zoom:50%;" /></p><p><img src="./信息安全引论.assets/image-20251120154008357.png" alt="image-20251120154008357" style="zoom:40%;" /></p><h5 id='simple-secret-key-distribution-with-confidentiality-and-authentication'><span>Simple secret key distribution with confidentiality and authentication</span></h5><p><img src="./信息安全引论.assets/image-20251122164309138.png" alt="image-20251122164309138" style="zoom:50%;" /></p><blockquote><p><span>(1) A→B 发送 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="15.575ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6884 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-78-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-78-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-78-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-78-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path><path id="MJX-78-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-78-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-78-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-78-TEX-N-2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path><path id="MJX-78-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-78-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-78-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-78-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-78-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-78-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-78-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-78-TEX-N-62" transform="translate(1528,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(2294.6,0)"><use data-c="5B" xlink:href="#MJX-78-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2572.6,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-78-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-78-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(4089.9,0)"><use data-c="2225" xlink:href="#MJX-78-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(4867.7,0)"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-78-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-78-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-78-TEX-I-1D434"></use></g></g><g data-mml-node="mo" transform="translate(6606,0)"><use data-c="5D" xlink:href="#MJX-78-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>KUb</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>N</mi><mn>1</mn></msub><mo>∥</mo><msub><mtext>ID</mtext><mi>A</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{\text{KUb}}[N_1 \parallel \text{ID}_A]</script><span> 用 B 的公钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.715ex" height="1.62ex" role="img" focusable="false" viewBox="0 -694 2084 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-90-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-90-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-90-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-90-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-90-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-90-TEX-N-62" transform="translate(1528,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KUb</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KUb}</script><span> 加密，包含 A 的身份 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="3.933ex" height="1.891ex" role="img" focusable="false" viewBox="0 -683 1738.3 835.7" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.345ex;"><defs><path id="MJX-80-TEX-N-49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z"></path><path id="MJX-80-TEX-N-44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z"></path><path id="MJX-80-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mtext"><use data-c="49" xlink:href="#MJX-80-TEX-N-49"></use><use data-c="44" xlink:href="#MJX-80-TEX-N-44" transform="translate(361,0)"></use></g><g data-mml-node="mi" transform="translate(1158,-152.7) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-80-TEX-I-1D434"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mtext>ID</mtext><mi>A</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{ID}_A</script><span> 和随机数 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>，实现 A 的身份认证与抗重放攻击</span></p><p><span>(2) B→A 发送 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="14.357ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6345.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-82-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-82-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-82-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-82-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-82-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-82-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-82-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-82-TEX-N-2225" d="M133 736Q138 750 153 750Q164 750 170 739Q172 735 172 250T170 -239Q164 -250 152 -250Q144 -250 138 -244L137 -243Q133 -241 133 -179T132 250Q132 731 133 736ZM329 739Q334 750 346 750Q353 750 361 744L362 743Q366 741 366 679T367 250T367 -178T362 -243L361 -244Q355 -250 347 -250Q335 -250 329 -239Q327 -235 327 250T329 739Z"></path><path id="MJX-82-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-82-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-82-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-82-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-82-TEX-N-55" transform="translate(778,0)"></use><use data-c="61" xlink:href="#MJX-82-TEX-N-61" transform="translate(1528,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(2255,0)"><use data-c="5B" xlink:href="#MJX-82-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2533,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-82-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-82-TEX-N-31"></use></g></g><g data-mml-node="mo" transform="translate(4050.3,0)"><use data-c="2225" xlink:href="#MJX-82-TEX-N-2225"></use></g><g data-mml-node="msub" transform="translate(4828.1,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-82-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-82-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(6067.7,0)"><use data-c="5D" xlink:href="#MJX-82-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>KUa</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>N</mi><mn>1</mn></msub><mo>∥</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{\text{KUa}}[N_1 \parallel N_2]</script><span> 用 A 的公钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.588ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 2028 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-96-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-96-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-96-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-96-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-96-TEX-N-55" transform="translate(778,0)"></use><use data-c="61" xlink:href="#MJX-96-TEX-N-61" transform="translate(1528,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KUa</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KUa}</script><span> 加密，包含 A 的随机数 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span>（确认 B 已收到 A 的请求）和 B 的随机数 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>（用于后续认证）</span></p><p><span>(3) A→B 发送 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.254ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4090.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-86-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-86-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-86-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-86-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path><path id="MJX-86-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-86-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-86-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-86-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-86-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-86-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-86-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-86-TEX-N-62" transform="translate(1528,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(2294.6,0)"><use data-c="5B" xlink:href="#MJX-86-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2572.6,0)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-86-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-86-TEX-N-32"></use></g></g><g data-mml-node="mo" transform="translate(3812.2,0)"><use data-c="5D" xlink:href="#MJX-86-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>KUb</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>N</mi><mn>2</mn></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{\text{KUb}}[N_2]</script><span> 用 B 的公钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.715ex" height="1.62ex" role="img" focusable="false" viewBox="0 -694 2084 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-90-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-90-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-90-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-90-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-90-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-90-TEX-N-62" transform="translate(1528,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KUb</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KUb}</script><span> 加密 B 的随机数 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span>，完成 B 对 A 的身份认证</span></p><p><span>(4) A→B 发送 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="15.646ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6915.4 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-89-TEX-I-1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path><path id="MJX-89-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-89-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-89-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path><path id="MJX-89-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-89-TEX-N-52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"></path><path id="MJX-89-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-89-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-89-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-89-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-89-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-89-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-89-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-89-TEX-N-62" transform="translate(1528,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(2294.6,0)"><use data-c="5B" xlink:href="#MJX-89-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(2572.6,0)"><g data-mml-node="mi"><use data-c="1D438" xlink:href="#MJX-89-TEX-I-1D438"></use></g><g data-mml-node="TeXAtom" transform="translate(771,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-89-TEX-N-4B"></use><use data-c="52" xlink:href="#MJX-89-TEX-N-52" transform="translate(778,0)"></use><use data-c="61" xlink:href="#MJX-89-TEX-N-61" transform="translate(1514,0)"></use></g></g></g><g data-mml-node="mo" transform="translate(4817.7,0)"><use data-c="5B" xlink:href="#MJX-89-TEX-N-5B"></use></g><g data-mml-node="msub" transform="translate(5095.7,0)"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-89-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-89-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(6359.4,0)"><use data-c="5D" xlink:href="#MJX-89-TEX-N-5D"></use></g><g data-mml-node="mo" transform="translate(6637.4,0)"><use data-c="5D" xlink:href="#MJX-89-TEX-N-5D"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>KUb</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>E</mi><mrow data-mjx-texclass="ORD"><mtext>KRa</mtext></mrow></msub><mo stretchy="false">[</mo><msub><mi>K</mi><mi>s</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">E_{\text{KUb}}[E_{\text{KRa}}[K_s]]</script><span> 用 B 的公钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.715ex" height="1.62ex" role="img" focusable="false" viewBox="0 -694 2084 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-90-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-90-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-90-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-90-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-90-TEX-N-55" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-90-TEX-N-62" transform="translate(1528,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KUb</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KUb}</script><span> 加密 &quot;由 A 的私钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.557ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 2014 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-91-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-91-TEX-N-52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"></path><path id="MJX-91-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-91-TEX-N-4B"></use><use data-c="52" xlink:href="#MJX-91-TEX-N-52" transform="translate(778,0)"></use><use data-c="61" xlink:href="#MJX-91-TEX-N-61" transform="translate(1514,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KRa</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KRa}</script><span> 加密的会话密钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span>&quot;，确保 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span> 的保密性与完整性</span></p><p><span>(5) B 解密获取 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span> B 先用自己的私钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.683ex" height="1.62ex" role="img" focusable="false" viewBox="0 -694 2070 716" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-95-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-95-TEX-N-52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z"></path><path id="MJX-95-TEX-N-62" d="M307 -11Q234 -11 168 55L158 37Q156 34 153 28T147 17T143 10L138 1L118 0H98V298Q98 599 97 603Q94 622 83 628T38 637H20V660Q20 683 22 683L32 684Q42 685 61 686T98 688Q115 689 135 690T165 693T176 694H179V543Q179 391 180 391L183 394Q186 397 192 401T207 411T228 421T254 431T286 439T323 442Q401 442 461 379T522 216Q522 115 458 52T307 -11ZM182 98Q182 97 187 90T196 79T206 67T218 55T233 44T250 35T271 29T295 26Q330 26 363 46T412 113Q424 148 424 212Q424 287 412 323Q385 405 300 405Q270 405 239 390T188 347L182 339V98Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-95-TEX-N-4B"></use><use data-c="52" xlink:href="#MJX-95-TEX-N-52" transform="translate(778,0)"></use><use data-c="62" xlink:href="#MJX-95-TEX-N-62" transform="translate(1514,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KRb</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KRb}</script><span> 解密外层，再用 A 的公钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="4.588ex" height="1.595ex" role="img" focusable="false" viewBox="0 -683 2028 705" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.05ex;"><defs><path id="MJX-96-TEX-N-4B" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H313Q235 637 233 620Q232 618 232 462L233 307L379 449Q425 494 479 546Q518 584 524 591T531 607V608Q531 630 503 636Q501 636 498 636T493 637H489V683H499Q517 680 630 680Q704 680 716 683H722V637H708Q633 633 589 597Q584 592 495 506T406 419T515 254T631 80Q644 60 662 54T715 46H736V0H728Q719 3 615 3Q493 3 472 0H461V46H469Q515 46 515 72Q515 78 512 84L336 351Q332 348 278 296L232 251V156Q232 62 235 58Q243 47 302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path id="MJX-96-TEX-N-55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z"></path><path id="MJX-96-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><use data-c="4B" xlink:href="#MJX-96-TEX-N-4B"></use><use data-c="55" xlink:href="#MJX-96-TEX-N-55" transform="translate(778,0)"></use><use data-c="61" xlink:href="#MJX-96-TEX-N-61" transform="translate(1528,0)"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>KUa</mtext></math></mjx-assistive-mml></mjx-container><script type="math/tex">\text{KUa}</script><span> 解密内层，最终获得会话密钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script></p></blockquote><p><span>设计亮点：</span></p><ul><li><p><span>保密性：会话密钥 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.859ex" height="1.901ex" role="img" focusable="false" viewBox="0 -683 1263.6 840.1" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.355ex;"><defs><path id="MJX-98-TEX-I-1D43E" d="M285 628Q285 635 228 637Q205 637 198 638T191 647Q191 649 193 661Q199 681 203 682Q205 683 214 683H219Q260 681 355 681Q389 681 418 681T463 682T483 682Q500 682 500 674Q500 669 497 660Q496 658 496 654T495 648T493 644T490 641T486 639T479 638T470 637T456 637Q416 636 405 634T387 623L306 305Q307 305 490 449T678 597Q692 611 692 620Q692 635 667 637Q651 637 651 648Q651 650 654 662T659 677Q662 682 676 682Q680 682 711 681T791 680Q814 680 839 681T869 682Q889 682 889 672Q889 650 881 642Q878 637 862 637Q787 632 726 586Q710 576 656 534T556 455L509 418L518 396Q527 374 546 329T581 244Q656 67 661 61Q663 59 666 57Q680 47 717 46H738Q744 38 744 37T741 19Q737 6 731 0H720Q680 3 625 3Q503 3 488 0H478Q472 6 472 9T474 27Q478 40 480 43T491 46H494Q544 46 544 71Q544 75 517 141T485 216L427 354L359 301L291 248L268 155Q245 63 245 58Q245 51 253 49T303 46H334Q340 37 340 35Q340 19 333 5Q328 0 317 0Q314 0 280 1T180 2Q118 2 85 2T49 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Z"></path><path id="MJX-98-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D43E" xlink:href="#MJX-98-TEX-I-1D43E"></use></g><g data-mml-node="mi" transform="translate(882,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-98-TEX-I-1D460"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>s</mi></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">K_s</script><span> 通过公钥加密双层保护，只有 B 能解密获取。</span></p></li><li><p><span>双向认证：通过随机数 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-99-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-99-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-99-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="31" xlink:href="#MJX-99-TEX-N-31"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>1</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_1</script><span> 和 </span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.804ex" height="1.885ex" role="img" focusable="false" viewBox="0 -683 1239.6 833" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.339ex;"><defs><path id="MJX-100-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-100-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-100-TEX-I-1D441"></use></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><use data-c="32" xlink:href="#MJX-100-TEX-N-32"></use></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container><script type="math/tex">N_2</script><span> 的 &quot;挑战 - 响应&quot;，确保 A 和 B 身份真实，同时防止重放攻击。</span></p></li><li><p><span>无中心化依赖：通信双方仅通过彼此的公钥即可完成密钥分发与认证，适用于分布式网络环境。</span></p></li></ul><p>&nbsp;</p><h4 id='hybrid-scheme'><span>Hybrid Scheme</span></h4><p><span>公钥私钥都用。</span></p><ul><li><p><span>KDC与每个用户都拥有{公钥,私钥}对</span></p></li><li><p><span>KDC与每个用户共享主密钥(对称密钥密码)</span></p></li><li><p><span>会话密钥的分发由主密钥完成</span></p></li><li><p><span>主密钥由公钥传递</span></p></li></ul><p>&nbsp;</p><h3 id='密钥交换方案密钥协定'><span>密钥交换方案（密钥协定）</span></h3><p><span>Diffie-Hellman 容易被中间人攻击 </span><img src="./信息安全引论.assets/image-20251120154605929.png" alt="image-20251120154605929" style="zoom:30%;" /></p><p><span>↓ 两个改进：STS，MTI</span></p><h5 id='端-端协议sts协议'><span>端-端协议（STS协议）</span></h5><p><span>station to station protocol</span></p><p><span>思想：用签名来验证是对的人。</span></p><p><span>证书：自己的ID信息 || 自己签名的验证算法 || 可信中心的签名(自己的ID信息 || 自己签名的验证算法)</span></p><ul><li><p><span>U正常发送 a</span><sup><span>Xu</span></sup><span> mod p</span></p></li><li><p><span>V回发：证书 || a</span><sup><span>Xv</span></sup><span> mod p || 自己的签名(a</span><sup><span>Xu</span></sup><span> || a</span><sup><span>Xv</span></sup><span>)</span></p></li><li><p><span>U可以验证确实是V，再回发：证书 || 自己的签名(a</span><sup><span>Xu</span></sup><span> || a</span><sup><span>Xv</span></sup><span>)</span></p></li><li><p><span>V可以验证确实是U</span></p></li></ul><h5 id='mti协议'><span>MTI协议</span></h5><p><span>MTI是三个人名）</span></p><ul><li><p><span>p、a：公开的 公共参数</span></p></li><li><p><span>每个用户有私钥X和公钥Y（Y= a^X mod p）</span></p></li><li><p><span>数字证书 C (U)：可信中心给 U 发的 “身份 + 公钥” 证明（包含 U 的 ID、Yu，还有可信中心的签名）。</span></p></li></ul><p><span>步骤：</span></p><ol start='' ><li><p><span>U 随机选个数字 Ru，算出来一个碎片 Su= a^Ru mod p，然后把 “自己的数字证书 C (U) + 碎片 Su” 发给 V；</span></p></li><li><p><span>V 也随机选个数字 Rv，算出来碎片 Sv= a^Rv mod p，然后把 “自己的数字证书 C (V) + 碎片 Sv” 发给 U；</span></p></li><li><p><span>双方即可得到共享密钥K = Sv^Xu  ×  Yv^Ru  mod p。</span></p></li></ol><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>MTI 只用 “数字证书” 确认 “公钥是真的”，但不验证 “交换的碎片有没有被改”—— 如果中间人截获了 U 的碎片，改成假碎片发给 V，V 没法察觉（因为 V 只知道公钥是真的，但不知道碎片是真的）。</span></p><p><span>而 STS 的签名，既解决了 “身份冒充”，又解决了 “信息篡改”，安全性比 MTI 更高。</span></p></div><p>&nbsp;</p><h2 id='四其他'><span>四、其他</span></h2><h4 id='密码长度'><span>密码长度</span></h4><p><img src="./信息安全引论.assets/image-20251122170306146.png" alt="image-20251122170306146" style="zoom:50%;" /></p><p><img src="./信息安全引论.assets/image-20251122170424954.png" alt="image-20251122170424954" style="zoom:40%;" /></p><p><img src="./信息安全引论.assets/image-20251122170519921.png" alt="image-20251122170519921" style="zoom:50%;" /></p><p><em><span>“MIPS 年” 是密码学中用于衡量大整数分解等密码学运算所需计算量的单位，具体含义是：以每秒执行 100 万条指令（MIPS，Million Instructions Per Second）的计算机为基准，完成某一运算所需的 “年数”。</span></em></p><p><img src="./信息安全引论.assets/image-20251122170700402.png" alt="image-20251122170700402" style="zoom:40%;" /></p><p>&nbsp;</p><h4 id='软硬件加密'><span>软硬件加密</span></h4><p><span>软件加密：</span></p><ul><li><p><span>缺点：速度慢、造价高、安全性差</span></p></li><li><p><span>优点：使用灵活、修改方便、可移植性好</span></p></li></ul><p><span>硬件加解密是商业或军事上的主流。</span></p><h5 id='侧信道攻击'><span>侧信道攻击</span></h5><p><span>一种由于密码系统的</span><strong><span>物理特性</span></strong><span>造成的信息泄漏引发的攻击。攻击者利用物理环境恢复一些可用于破坏密码算法的泄漏，在侧信道攻击中可以利用的特性包括运行时间、功耗、电磁和声发射。</span></p><p><span>对策的示例：包括向计算添加随机延迟、插入没有任何影响的指令周期，使得每次密码计算都需要相同的时间，以及添加导致随机功耗的硬件逻辑。</span></p><p>&nbsp;</p><h4 id='轻量级密码学'><span>轻量级密码学</span></h4><p><span>轻量级密码学是密码学的一个子领域，涉及资源受限设备的密码算法的开发</span></p><p>&nbsp;</p><h4 id='压缩编码和加密'><span>压缩、编码和加密</span></h4><ul><li><p><span>将压缩算法和加密算法结合使用效果更好。</span>
<span>（1）密码分析依赖于明文中的数据冗余，而压缩明文会减少这种冗余。</span>
<span>（2）减少加密时间</span></p></li><li><p><span>顺序：</span><img src="./信息安全引论.assets/image-20251122170826602.png" alt="image-20251122170826602" style="zoom:50%;" /></p></li></ul><p>&nbsp;</p><h4 id='文件删除'><span>文件删除</span></h4><p><span>大多数计算机删除文件时，只是删除文件的索引，此外，虚拟存储器意味着计算机可以在任何时候往硬盘上读、写数据。建议多次往硬盘上重写，才能保证删除干净。</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-8-公开密钥管理'><span>Lecture 8. 公开密钥管理</span></h1><h2 id='一intro-2'><span>一、Intro</span></h2><p><strong><span>PKI：public key infrastructure</span></strong><span> 是一组建立在公开密钥算法基础上的硬件、软件、人员和应用程序的集合，它应具备产生、管理、存储、分发和废止证书的能力。</span></p><h5 id='组成'><span>组成</span></h5><ul><li><p><span>CA(Certificate Authority)：是证书的签发机构，它是PKI 的核心。</span></p></li><li><p><span>注册中心RA：分担CA 的功能，作为CA 和最终用户之间的接口，增强CA 系统的安全性。</span></p></li><li><p><span>证书库：是一种网上公共信息库，用于存储CA已签发证书及公钥、撤销证书及公钥，可供开放式查询。</span></p><ul><li><p><span>CRL（证书吊销列表，Certificate Revocation List）是由证书颁发机构（CA）发布的一个列表，它列出了所有被吊销的数字证书。这些证书已经不再有效，不能再用于身份验证或者加密通信。</span></p></li></ul></li><li><p><span>密钥和证书管理：涉及密钥备份与恢复、自动密钥更新和建立密钥历史档案。</span></p></li><li><p><span>一个完整的PKI 还必须提供良好的应用接口系统。</span></p></li><li><p><span>信任模型：涉及不同PKI管理的用户之间交叉认证。</span></p></li></ul><h5 id='证书'><span>证书</span></h5><p><span>一个证书中，最重要的信息是个体名字、个体的公钥、机构的签名、算法和用途。</span></p><p><span>X.509证书结构： </span><img src="./信息安全引论.assets/image-20251122173350750.png" alt="image-20251122173350750" style="zoom:40%;" /></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='二pki-信任模型'><span>二、PKI 信任模型</span></h2><h4 id='概念'><span>概念</span></h4><ul><li><p><span>如果一个个体假设CA 能够建立并维持一个准确的“个体公钥属性”之间的绑定，则他可以信任该CA，该CA 为可信CA</span></p></li><li><p><span>信任域：信任的范围。</span></p></li><li><p><span>信任锚：就是PKI 体系中的信任起点。</span></p></li><li><p><span>在公钥基础设施中，当两个认证机构中的一方给对方的公开密钥或双方给互相的公开密钥颁发证书时，两者之间就建立了信任关系。</span></p></li><li><p><span>在一个实体需要确认另一个实体身份时，它先需要确定信任锚，再由信任锚找出一条到达待确认实体的各个证书组成的路径，该路径称为信任路径。</span></p><p>&nbsp;</p></li></ul><h4 id='一些结构'><span>一些结构</span></h4><ol start='' ><li><p><span>严格层次结构模型</span></p><p><img src="./信息安全引论.assets/image-20251122173550217.png" alt="image-20251122173550217" style="zoom:30%;" /></p><ul><li><p><span>根CA 具有一个自签名的证书。</span></p></li><li><p><span>用户A看是否信任用户B时，可以看到B的证书中含有签发该证书的CA 的信息，沿着层次树往上找，就可以构成一条证书链，直到根证书。只要信任根CA就可以。因为可以用根CA的公钥验证其子CA证书...依次往下都可验证。</span></p></li></ul></li><li><p><span>网状信任模型</span></p><p><img src="./信息安全引论.assets/image-20251122210401239.png" alt="image-20251122210401239" style="zoom:35%;" /></p></li><li><p><span>桥CA信任模型</span></p><p><img src="./信息安全引论.assets/image-20251122210452225.png" alt="image-20251122210452225" style="zoom:40%;" /></p></li><li><p><span>Web模型：网站内置数个可信任的根CA</span></p><p><img src="./信息安全引论.assets/image-20251122210702643.png" alt="image-20251122210702643" style="zoom:33%;" /></p></li></ol><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-9-加密文件系统'><span>Lecture 9. 加密文件系统</span></h1><p><span>Windows 自带了</span><strong><span>加密文件系统 EFS（Encrypting File System）</span></strong><span>加密文件系统。</span></p><ul><li><p><span>该技术允许用户加密</span>[<span>NTFS卷</span>][NTFS卷是指采用NTFS（New Technology File System，新技术文件系统）作为文件管理格式的逻辑存储分区。一个物理磁盘可以划分多个 NTFS 卷（如 C 盘、D 盘）]<span>上特定文件夹中的数据</span></p></li><li><p><span>加密一个文件只需设置文件的加密属性或把文件放入设置了加密属性的文件夹之中。</span></p></li><li><p><span>系统文件不能被加密</span></p></li><li><p><span>加密不能防止被删除</span></p></li></ul><h4 id='原理-2'><span>原理</span></h4><p><span>基于非对称公钥算法和对称加密算法的混合机制：扩展的数据加密标准（DESX)</span></p><p><span>本质是用 [对称加密密钥] 加密文件。为了保护 [对称加密密钥] 的安全，所以用 [公钥] 加密 [对称加密密钥]。解密时用 [私钥] 解密 [对称加密密钥]，再用 [对称加密密钥] 解密即可。</span></p><p><em><span>使用公私钥是因为如果直接保存对称加密密钥在电脑上的话会很容易被攻击者获得，因此保存加密的版本，私钥存储在一个安全储存区。</span></em></p><p><em><span>备份文件加密证书和密钥有助于避免在丢失或损坏原始证书和密钥之后永久丢失对加密文件的访问权限</span></em></p><p>&nbsp;</p><h4 id='一个实际操作例子'><span>一个实际操作例子</span></h4><p><span>见PPT。加密文件夹、导出公私钥（备份）、导入...</span></p><h5 id='配置数据恢复代理'><span>配置数据恢复代理</span></h5><p><span>由于EFS 的加密和解密与用户的账户信息和个人配置文件密切相连，如果用户忘记了自己的登录口令或是登录口令被系统管理员更改、个人配置文件损坏或丢失，都会造成文件永远处于加密状态不允许任何人进行访问，由于EFS 的加密强度极高，因此恢复的可能性很小。为了预防这些情况的发生，用户在启用EFS 后，要配置数据恢复代理为自己留一条后路。</span></p><p><strong><span>数据恢复代理</span></strong><span>：一个其他用户。</span></p><p><span>由于受到系统加密策略的控制，配置了数据恢复代理后再对文件进行加密，在文件中会自动产生一个与数据恢复代理用户相关联的数据恢复字段，这个字段保存了由数据恢复代理的公钥进行加密的文件加密密钥，当数据恢复代理访问这些加密文件时，用自己的私钥解密从而得到加密密钥。</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-10-网络安全'><span>Lecture 10. 网络安全</span></h1><h2 id='一intro-3'><span>一、Intro</span></h2><ul><li><p><span>应用层安全：必须在终端主机上实施，每两个用户都要有密钥</span></p><ul><li><p><span>优点：以用户为背景执行；数据只有到用户的主机上才恢复成明文；应用可以自由扩展；应用程序对数据有着充分的理解</span></p></li><li><p><span>缺点：针对每个应用须设计一套安全机制</span></p></li></ul></li><li><p><span>传输层安全：</span></p><ul><li><p><span>优点：不会强制要求每个应用都在安全方面作出相应改进</span></p></li><li><p><span>缺点：由于要取得用户背景，通常假定只有一名用户使用系统，与应用级安全类似，只能在端系统实现；应用程序仍需要修改</span></p></li></ul></li><li><p><span>网络层安全：节点之间共享密钥即可</span></p><ul><li><p><span>优点：密钥协商的开销被大大削减了；需要改动的应用程序要少得多；能很容易构建VPN</span></p></li><li><p><span>缺点：很难解决“抗抵赖”之类的问题（因为和用户无关了）</span></p></li></ul></li><li><p><span>数据链路层：</span></p><ul><li><p><span>优点：速度快，在ATM 上得到广泛应用</span></p></li><li><p><span>缺点：不易扩展</span></p></li></ul></li></ul><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>网络层 IPsec</span>
<span>传输层 SSL / TLS</span>
<span>应用层 S/MIME, PGP, PEM, SET, Kerberos, SHTTP, SSH</span></p></div><p>&nbsp;</p><h2 id='二传输层安全'><span>二、传输层安全</span></h2><h3 id='ssltls协议'><span>SSL/TLS协议</span></h3><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>浏览器地址栏旁边显示一个小锁即为被SSL/TLS协议保护着！</span></p></div><p><span>SSL/TLS 被设计用来使用 TCP 提供一个可靠的端到端安全服务。为两个通讯个体之间提供保密性和完整性（身份鉴别）。</span></p><p><span>SSL (Secure Socket Layer) 发展三代后重命名为 TLS (Transport Layer Security)</span></p><p><img src="./信息安全引论.assets/image-20251127161453300.png" alt="image-20251127161453300" style="zoom:50%;" /></p><ul><li><p><span>TLS 记录协议：发送数据时使用的协议，对数据进行封装（加密、校验等）。</span></p><ul><li><p><em><span>生成TLS连接（一次交互就叫一次连接）</span></em></p></li></ul></li><li><p><span>TLS 握手协议：客户和服务器之间相互鉴别，协商加密算法、哈希算法、密钥以及其他参数。</span><code>主密钥：双方长期共享的密钥</code></p><ul><li><p><em><span>生成TLS会话（从握手到挥手称为一次会话，会存储密码安全参数）</span></em></p></li></ul></li></ul><p>&nbsp;</p><h4 id='tls-记录协议'><span>TLS 记录协议</span></h4><p><img src="./信息安全引论.assets/image-20260106132214665.png" alt="image-20260106132214665" style="zoom:40%;" /></p><ul><li><p><span>上层消息的数据被分片成2</span><sup><span>14</span></sup><span>字节大小的块，或者更小，适合加密。</span></p></li><li><p><span>TLS记录头：</span></p><ul><li><p><span>内容类型：上层协议类型</span></p></li><li><p><span>协议主从版本号：</span></p></li><li><p><span>明文长度</span></p></li></ul></li></ul><p>&nbsp;</p><h4 id='tls-握手协议'><span>TLS 握手协议</span></h4><p><img src="./信息安全引论.assets/image-20260106133353688.png" alt="image-20260106133353688" style="zoom:50%;" /></p><blockquote><p><span>密钥的产生：</span></p><p><span>为了产生记录协议所需要的密钥，使用下面的计算公式：</span></p><p><span>key_block = </span>[<span>PRF</span>][一个伪随机函数]<span>(SecurityParameters.master_secret，“key expansion expansion”, SecurityParameters.server_random+SecurityParameters.client_random)；</span></p><p><span>直到产生足够长的输出。然后从key_block 中按以下顺序依次取得相应长度的密钥：客户端写MAC 密钥、服务器端写MAC 密钥、客户端加密密钥、 服务器端端加密密钥、客户端写IV 、服务器端写IV 。</span></p></blockquote><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>一款开源软件：OpenSSL，支持生成私钥、生成证书签名请求、使用私钥签名证书请求、生成对称密钥、加密文件、解密文件</span></p></div><p>&nbsp;</p><p>&nbsp;</p><h2 id='三网络层安全'><span>三、网络层安全</span></h2><blockquote><p><span>IPv4的缺陷：</span></p><ul><li><p><span>缺乏对通信双方身份真实性的鉴别能力</span></p></li><li><p><span>缺乏对传输数据的完整性和机密性保护的机制</span></p></li><li><p><span>IP的分组和重组机制不完善</span></p></li><li><p><span>IP地址的表示不需要真实并确认真假</span></p></li></ul></blockquote><h3 id='ipsec'><span>IPsec</span></h3><p><span>IPsec定义了两个协议 AH (Authentication Header) 和 ESP (Encapsulating Security Payload)，分别用于鉴别与加密。都以扩展报头的形式存在。</span></p><p><span>应用方式：</span></p><ul><li><p><span>端到端（end-end）：主机到主机的安全通信</span></p></li><li><p><span>端到路由（end-router）：主机到路由设备之间的安全通信</span></p></li><li><p><span>路由到路由（router-router）：路由设备之间的安全通信，常用于在两个网络之间建立VPN。</span></p></li></ul><p>&nbsp;</p><h4 id='安全关联-security-association'><span>安全关联 Security Association</span></h4><p><span>安全关联定义：就是发送与接收者之间的一个</span><strong><span>单向</span></strong><span>逻辑连接，是与给定的一个网络连接或一组网络连接相关联的安全信息参数集合。</span><em><span>如果需要一个对等关系，即双向安全交换，则需要两个SA。</span></em></p><p><span>每个SA通过三个参数来标识：</span></p><ol start='' ><li><p><span>安全参数索引 SPI (Security Parameters Index) </span><em><span>因为一个设备会建立多个连接，所以可以通过此索引快速找到这个链接使用的那组安全参数</span></em></p></li><li><p><span>对方IP地址</span></p></li><li><p><span>安全协议标识: AH or ESP</span></p></li></ol><ul><li><p><span>安全关联数据库 SAD：存储了当前活跃的连接的安全参数们</span></p></li><li><p><span>安全策略数据库 SPD：在每个条目中定义了要保护什么样的通信、怎样保护它以及和谁共享这种保护</span></p></li></ul><blockquote><p><span>eg. 可在一个安全网关上制定IPSec策略: 对在本地保护的子网与远程网关的子网间通信的所有数据，全部采用DES加密，并用 HMAC-MD5进行鉴别；对于需要加密的、发给另一个服务器的所有 Web通信均用 3DES加密，同时用 HMAC-SHA鉴别。</span></p></blockquote><p>&nbsp;</p><h4 id='ah-与-esp'><span>AH 与 ESP</span></h4><p><span>AH利用MAC码实现鉴别，双方必须共享一个密钥</span></p><p><span>两种鉴别模式：</span></p><ol start='' ><li><p><span>传输模式：不改变 IP地址，插入一个 AH</span></p></li><li><p><span>隧道模式：生成一个新的 IP头，把 AH和原来的整个 IP包放到新 IP包的净荷数据中</span></p><p><img src="./信息安全引论.assets/image-20260106143522949.png" alt="image-20260106143522949" style="zoom:33%;" /></p><p><span>ESP类似，只是提供加密和可选的鉴别服务。</span><em><span>注意ESP的鉴别不包括头部，AH的鉴别包括头部</span></em></p><p><img src="./信息安全引论.assets/image-20260106144210079.png" alt="image-20260106144210079" style="zoom:33%;" /></p><p><img src="./信息安全引论.assets/image-20260106144228599.png" alt="image-20260106144228599" style="zoom:33%;" /></p></li></ol><h5 id='sa的组合'><span>SA的组合</span></h5><p><span>特定的通信量需要同时调用 AH和 ESP服务。</span></p><ul><li><p><span>传输邻接：同一分组应用多种协议，不形成隧道</span></p><p><span>即：AH + 一个不提供鉴别服务的ESP，这样可以比单使用ESP多保护一个头部。</span></p><p><img src="./信息安全引论.assets/image-20260106145255302.png" alt="image-20260106145255302" style="zoom:40%;" /></p></li><li><p><span>循环嵌套：通过隧道实现多级安全协议的应用（多重隧道）</span></p><p><span>即：内部的AH + 外部的 ESP 隧道</span></p><p><img src="./信息安全引论.assets/image-20260106145451961.png" alt="image-20260106145451961" style="zoom:40%;" /></p><p><span>先鉴别再加密，更不易被篡改，且解密后仍然可以保留完整性保护。</span></p></li></ul><p>&nbsp;</p><h4 id='ipsec密钥管理'><span>IPsec密钥管理</span></h4><p><strong><span>IKE协议</span></strong><span>：代表 IPsec对 SA进行协商，并对 SAD数据库进行填充，基于 Diffie-Hellman 算法。</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-11-鉴别协议'><span>Lecture 11. 鉴别协议</span></h1><h2 id='一一些协议'><span>一、一些协议</span></h2><h4 id='仲裁协议裁决协议'><span>仲裁协议/裁决协议</span></h4><p><span>包括两个低级的子协议</span></p><ul><li><p><span>非仲裁子协议，执行协议的各方每次想要完成的（谈合同、签合同）</span></p></li><li><p><span>裁决子协议，仅在例外的情况下，即有争议的时候才执行（见法官，出示证据），这种特殊的仲裁者叫裁决人。</span></p></li></ul><h4 id='密码协议安全协议'><span>密码协议/安全协议</span></h4><p><span>使用密码的具有安全性功能的协议称为安全协议或密码协议</span></p><ol start='' ><li><p><span>密钥建立协议(key establishment protocol): 建立共享秘密</span></p></li><li><p><span>鉴别协议(authentication protocol): 向一个实体提供对他想要进行通信的另一个实体的身份的某种程度的确认</span></p></li><li><p><span>鉴别的密钥建立协议(authenticated key establishment protocol): 与另一个身份已被或可被证实的实体之间建立共享秘密</span></p></li></ol><p>&nbsp;</p><h2 id='二鉴别协议'><span>二、鉴别协议</span></h2><h3 id='实体鉴别概述'><span>实体鉴别概述</span></h3><p><span>需求：验证一个实体是否是他声称的身份。</span></p><ul><li><p><span>实体鉴别只证实实体的身份，消息鉴别除了验证消息来自真正的发送方，还要保证消息的合法和完整</span></p></li><li><p><span>实体鉴别一般是实时的鉴别，数字签名是长期有效的。</span></p></li></ul><h4 id='实体鉴别分类'><span>实体鉴别分类</span></h4><ul><li><p><span>本地多用户鉴别：实体在本地环境的初始化鉴别（就是说，作为实体个人，和设备物理接触，不和网络中的其他设备通信）。需要用户进行明确的操作</span></p></li><li><p><span>远程用户鉴别：连接远程设备、实体和环境的实体鉴别。通常将本地鉴别结果传送到远程。</span></p></li><li><p><span>单向鉴别是指通信双方中只有一方向另一方进行鉴别。</span></p></li><li><p><span>双向鉴别是指通信双方相互进行鉴别。</span></p></li></ul><p>&nbsp;</p><h3 id='实体鉴别机制'><span>实体鉴别机制</span></h3><p><span>大致分类：</span></p><ol start='' ><li><p><span>所知(Knowledge):密码、口令</span></p></li><li><p><span>所有(Possesses): 身份证、护照、信用卡、钥匙、IP地址、设备</span></p></li><li><p><span>个人特征:指纹、笔迹、声纹、手型、血型、视网膜、虹膜、DNA以及个人动作方面的一些特征</span></p><p>&nbsp;</p></li></ol><h4 id='口令机制'><span>口令机制</span></h4><p><span>即日常生活中所说的“密码”。通常为长度为5~8 的字符串。选择原则：易记、难猜、抗分析能力强。</span></p><p><span>是</span><strong><span>弱鉴别</span></strong><span>：口令不随时间变化。</span></p><p><span>口令系统有许多脆弱点：外部泄露、口令猜测、线路窃听（可以传输/存储口令的消息摘要）、攻击验证者、重放</span></p><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>防止攻击验证者：</span></p><ul><li><p><span>验证者的存储准备：验证者本地不会存储用户的明文口令，而是存储：</span></p><ul><li><p><span>用户身份标识（</span><code>id</code><span>）；</span></p></li><li><p><span>一个随机的 “盐值（salt）”（每个用户的盐值不同）；</span></p></li><li><p><span>用 单向函数</span><code>f</code><span> 计算出的 “口令 + 盐值” 的哈希结果：</span><code>q = f(p, salt)</code><span>（</span><code>p</code><span>是用户真实口令）。</span></p></li></ul></li><li><p><span>身份验证流程：</span></p><ol start='' ><li><p><span>用户（声称者）向验证者发送自己的</span><code>id</code><span>和输入的口令</span><code>p&#39;</code><span>；</span></p></li><li><p><span>验证者根据</span><code>id</code><span>，取出对应的</span><code>salt</code><span>和预先存储的</span><code>q</code><span>；</span></p></li><li><p><span>验证者用单向函数</span><code>f</code><span>，计算用户输入的</span><code>p&#39;</code><span>+</span><code>salt</code><span>的结果：</span><code>q&#39; = f(p&#39;, salt)</code><span>；</span></p></li><li><p><span>验证者对比</span><code>q&#39;</code><span>和预先存储的</span><code>q</code><span>：一致则验证通过，不一致则失败。</span></p></li></ol></li></ul></div><blockquote><p><span>防止线路窃听：</span></p><ol start='' ><li><p><span>验证者发起挑战</span></p><ul><li><p><span>验证者先给声称者发送 “身份标识（id）” + “随机挑战值（q）”；</span></p></li></ul></li><li><p><span>声称者生成响应</span></p><ul><li><p><span>声称者拿到</span><code>q</code><span>后，用自己的口令（</span><code>p&#39;</code><span>）和单向函数（</span><code>f</code><span>），计算出响应值：</span><code>q&#39; = f(p&#39;, q)</code><span>；</span></p></li><li><p><span>单向函数</span><code>f</code><span>的特点是 “易算难逆”—— 知道</span><code>p&#39;</code><span>和</span><code>q</code><span>能算出</span><code>q&#39;</code><span>，但知道</span><code>q&#39;</code><span>和</span><code>q</code><span>无法反推出</span><code>p&#39;</code><span>；</span></p></li><li><p><span>声称者将</span><code>id</code><span>和</span><code>q&#39;</code><span>发送给验证者。</span></p></li></ul></li><li><p><span>验证者比对结果</span></p><ul><li><p><span>验证者本地存储了该用户的真实口令（</span><code>p</code><span>），用同样的单向函数计算：</span><code>q = f(p, q&#39;)</code><span>对应的正确值；</span></p></li><li><p><span>验证者将自己计算的结果，与之前发送的q对比：</span></p></li><li><p><span>若一致，说明声称者确实知道正确口令，验证通过；</span></p></li><li><p><span>若不一致，验证失败。</span></p></li></ul></li></ol></blockquote><p>&nbsp;</p><h5 id='一次性口令机制'><span>一次性口令机制</span></h5><p><span>是</span><strong><span>近似的强鉴别</span></strong><span>（towards strong authentication)：一次性口令机制确保在每次鉴别中所使用的口令不同，以对付重放攻击。</span></p><p><span>确定口令的方法：</span></p><ol start='' ><li><p><span>两端秘密共享一串随机口令，在该串的某一位置保持同步，此方案有两端需要维护秘密随机串表的缺点；</span></p></li><li><p><span>顺序更新一次性口令，使用旧的口令把新的口令加密传输过去。</span></p></li></ol><p>&nbsp;</p><h4 id='基于密码算法的鉴别'><span>基于密码算法的鉴别</span></h4><p><span>是</span><strong><span>强鉴别</span></strong><span>：通过密码学的询问应答(challenge response) 协议实现的身份鉴别 </span><em><span>不知道密码的人就算不出这个应答</span></em></p><p>&nbsp;</p><h4 id='零知识证明协议'><span>零知识证明协议</span></h4><blockquote><p><span>Alice: 我知道联邦储备系统计算的口令</span>
<span>Bob: 不，你不知道</span>
<span>Alice：我知道</span>
<span>Bob：你不知道</span>
<span>Alice：我确实知道</span>
<span>Bob：请你的证实这一点</span>
<span>Alice：好吧，我告诉你。（她悄悄说出了口令）</span>
<span>Bob：太有趣了！现在我也知道了。我要告诉《华盛顿邮报》</span>
<span>Alice：啊呀！:(</span></p></blockquote><p>&nbsp;</p><h3 id='鉴别与密钥交换协议'><span>鉴别与密钥交换协议</span></h3><p><span>先鉴别身份没问题，再交换密钥。</span></p><h5 id='询问应答方式'><span>询问/应答方式</span></h5><ol start='' ><li><p><span>A期望从B获得一个消息，首先发给B一个</span><strong><span>随机值</span></strong><span>(challenge)</span></p></li><li><p><span>B收到这个值之后，对它作某种变换，并送回去</span></p></li><li><p><span>A收到B的response，希望包含这个随机值。</span></p></li></ol><p><span>在有的协议中，这个challenge也称为</span><strong><span>nonce</span></strong><span>，可能明文传输，也可能密文传输</span></p><p><span>询问/应答方法不适应非连接性的应用，因为它要求在传输开始之前先有握手的额外开销，这就抵消了无连接通信的主要特点。</span></p><h5 id='相互鉴别协议'><span>相互鉴别协议</span></h5><p><span>在理论上，相互鉴别可通过组合两个单向鉴别交换协议来实现。然而，这种组合需要被仔细地考察，因为有可能这样的组合易受窃听重放攻击。</span></p><p><span>另外，设计协议消息数比相应的单向交换协议的消息数的两倍少得多的相互鉴别交换协议是可能的。</span></p><p><span>因此，由于安全性和性能的原因，相互鉴别交换协议必须为此目的而特别地进行设计。</span></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='三鉴别与密钥交换协议实例'><span>三、鉴别与密钥交换协议实例</span></h2><h3 id='chap'><span>CHAP</span></h3><p><img src="./信息安全引论.assets/image-20260107100334661.png" alt="image-20260107100334661" style="zoom:40%;" /></p><ul><li><p><span>优点：简单易实现</span></p></li><li><p><span>缺点：基于共享密钥，给密钥管理带来巨大不便，不适合于大规模用户鉴别；要求提供明文的密钥形式。</span></p><p>&nbsp;</p></li></ul><h3 id='skey'><span>S/Key</span></h3><p><span>主要用于抗重放攻击。主要功能：产生一次性口令。</span></p><p><span>机制：</span></p><ol start='' ><li><p><span>一个单向函数f（哈希摘要）</span></p></li><li><p><span>产生一个随机数x，生成f(x), f(f(x)), ... 共一百个</span></p></li><li><p><span>对面先存第101个，自己从第100个开始发，则对面可以轻松验证，并存下第100个，准备验证第99个。</span></p></li></ol><p><span>实际过程中，由用户输入私钥，客户端程序计算出第k个口令。</span></p><p><span>整个过程中，私钥不会暴露在网上。</span></p><p>&nbsp;</p><h3 id='双向鉴别'><span>双向鉴别</span></h3><h4 id='needhamschroeder-protocol-1978'><span>Needham/Schroeder Protocol [1978]</span></h4><p><img src="./信息安全引论.assets/image-20260107102213363.png" alt="image-20260107102213363" style="zoom:50%;" /></p><ul><li><p><span>漏洞：第三步可能遭遇抗重放攻击。eg. 攻击者得知了某次老的会话密钥，重放当时A发给B的(3)，就可以与B通话了。</span></p></li></ul><h4 id='denning-protocol'><span>Denning Protocol</span></h4><p><span>为了解决这个漏洞，所以在第三步加一个时间标记。</span></p><ul><li><p><span>新的问题：即必须依靠各时钟均可通过网络同步。如果发送者的时钟比接收者的时钟要快，攻击者就可以从发送者窃听消息，并在以后当时间戳对接收者来说成为当前时重放给接收者。这种重放将会得到意想不到的后果。（称为抑制重放攻击）。</span></p></li><li><p><span>一种克服抑制重放攻击的方法是强制各方定期检查自己的时钟是否与KDC 的时钟同步。</span></p></li></ul><h4 id='kehn92'><span>KEHN92</span></h4><p><span>再带上双方的随机数。</span></p><p><img src="./信息安全引论.assets/image-20260107103117948.png" alt="image-20260107103117948" style="zoom:40%;" /></p><p>&nbsp;</p><h3 id='单向鉴别'><span>单向鉴别</span></h3><p><img src="./信息安全引论.assets/image-20260107103727460.png" alt="image-20260107103727460" style="zoom:33%;" /></p><p>&nbsp;</p><h3 id='kerberos'><span>Kerberos</span></h3><p><span>希腊神话故事中一种三个头的狗，还有一个蛇形尾巴。是地狱之门的守卫。</span></p><p><span>意指有三个组成部分的网络之门的保卫者。“三头”包括：</span></p><ul><li><p><span>鉴别(authentication)</span></p></li><li><p><span>簿记(accounting)</span></p></li><li><p><span>审计(audit)</span></p></li></ul><p><span>应用场景：禁止非授权用户访问服务器，或者用户访问非授权服务器</span></p><p><span>引入一个信任的第三方鉴别服务，基于Needham &amp; Schroeder 协议。</span></p><p>&nbsp;</p><h4 id='一些协议中的概念'><span>一些协议中的概念</span></h4><ul><li><p><span>Principal (安全个体)：被鉴别的个体，有一个名字和口令</span></p></li><li><p><span>KDC(Key distribution center)：可信第三方提供 ticket 和临时的会话密钥</span></p></li><li><p><span>Ticket：可信第三方给用户发的入场券，加密（使用可信第三方和服务器的共有密钥）</span></p></li><li><p><span>Authenticator：证明我是我自己。</span></p></li></ul><p>&nbsp;</p><h4 id='改进'><span>改进</span></h4><p><span>希望可以少输入几次口令，同一个入场券多次使用。TGS：ticket granting servor</span></p><ol start='' ><li><p><span>Customer和AS沟通，AS给一份TGS访问许可，在有效期内可以重复使用。</span><em><span>用AS和TGS的共享密钥加密。</span></em></p></li><li><p><span>C去找TGS要server的入场券。</span><em><span>用TGS和server的共享密钥加密。</span></em></p></li><li><p><span>C给server看入场券。</span></p></li></ol><p><span>缺点：server没有向用户证明自己。</span></p><p>&nbsp;</p><h4 id='kerberos-v4'><span>Kerberos v4</span></h4><p><span>增加会话密钥，使得用户知道server是真的server。</span><em><span>即在第三步时，需要server回复一个以K</span><sub><span>cs</span></sub><span>[timestamp+1]</span></em></p><p><span>每个TGS有一定的管辖范围，可以访问隔壁的TGS以连接realm B的服务器。</span></p><p><img src="./信息安全引论.assets/image-20251211154855290.png" alt="image-20251211154855290" style="zoom:30%;" /></p><p>&nbsp;</p><h4 id='kerberos-v5'><span>Kerberos v5</span></h4><ol start='' ><li><p><span>时间戳改为nonce</span></p></li><li><p><span>加密算法换成了更严谨的</span></p></li><li><p><span>ticket本身就是一个密文，所以不用再用户二次加密了，省下一些计算量。</span></p></li><li><p><span>有了子会话密钥</span></p></li></ol><p>&nbsp;</p><h3 id='x509'><span>X.509 </span></h3><p><span>基于公钥。不需要服务器时刻在线。</span></p><p><span>三向交换可以用随机数代替时间戳。</span></p><p><img src="./信息安全引论.assets/image-20260107112502155.png" alt="image-20260107112502155" style="zoom:40%;" /></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-12-访问控制'><span>Lecture 12. 访问控制</span></h1><h2 id='零概念'><span>零、概念</span></h2><p><span>目标：防止对任何资源（如计算资源、通信资源或信息资源）进行未授权的访问。</span></p><p><span>访问控制</span>[<span>策略</span>][策略：高层思想指导, eg. 入校要不要验证。机制：低层具体实现，eg. 采用人脸认证/校园卡认证。]<span>：自主访问控制、强制访问控制、基于角色的访问控制、其他访问控制策略</span></p><p>&nbsp;</p><h2 id='一自主访问控制-dac'><span>一、自主访问控制 DAC</span></h2><p><span>DAC：Discretionary Access Control</span></p><p><span>文件的拥有者可以按照自己的意愿精确指定系统中的其他用户对其文件的访问权（具有某种访问能力的主体能够自主地将访问权的某个子集授予其它主体）</span></p><p><span>也称为 </span><strong><span>基于身份的访问控制</span></strong><span> Identity Based Access Control</span></p><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>密码非常适合用户鉴别，是否使用密码就可以实现自主访问控制？</span></p><p><span>不是非常合适，无法单独吊销一个用户的访问权；用户得自己记密码；系统无法获知访问文件的用户是谁。</span></p></div><p>&nbsp;</p><h3 id='实现机制'><span>实现机制</span></h3><h4 id='访问控制矩阵'><span>访问控制矩阵</span></h4><p><img src="./信息安全引论.assets/image-20251211163854838.png" alt="image-20251211163854838" style="zoom:50%;" /></p><p><span>可以按行看或按列看。</span></p><h5 id='基于行'><span>基于行</span></h5><ul><li><p><span>访问能力表 Capability List CL：效率不高</span></p><p><img src="./信息安全引论.assets/image-20251211164011772.png" alt="image-20251211164011772" style="zoom:33%;" /></p></li><li><p><span>前缀表：效率不高</span></p><p><img src="./信息安全引论.assets/image-20251217184456460.png" alt="image-20251217184456460" style="zoom:50%;" /></p></li><li><p><span>口令：即密码，前面有说。</span></p></li></ul><h5 id='基于列'><span>基于列</span></h5><p><strong><span>访问控制表ACL</span></strong><span>：每个客体附加一个它可以访问的主体的明细表，只要使用组（如CRYPTO）和通配符（如* ），表也可以不是太大。</span><em><span>多数集中式操作系统使用ACL，由于分布式系统中很难确定给定客体的潜在主体集，在现代OS 中CL 也得到广泛应用。</span></em></p><p><img src="./信息安全引论.assets/image-20251217184717334.png" alt="image-20251217184717334" style="zoom:60%;" /></p><p><span>如图，则CRYPTO小组中Jones可以rwx，其余人可以r_x，非CRYPTO小组中Green无权限，其他人可以read。</span></p><p>&nbsp;</p><h4 id='linux中的访问控制'><span>Linux中的访问控制</span></h4><p><code>权限分为：读、写、执行</code></p><p><span>采用DAC。</span></p><p><span>访问权限(access rights): 10 个标志</span></p><ul><li><p><span>第1 个标志：d (目录), b (块系统设备), c (字符设备), . (普通文件)</span></p></li><li><p><span>第2-4 个标志：</span><strong><span>所有者</span></strong><span>的读、写、执行权限</span></p></li><li><p><span>第5-7 个标志：</span><strong><span>所有者所在组</span></strong><span>的读、写、执行权限</span></p></li><li><p><span>第8-10 个标志：</span><strong><span>其他用户</span></strong><span>的读、写、执行权限</span></p></li></ul><p><strong><span>根用户</span></strong><span>拥有任何权限。</span></p><p><span>用chmod 修改权限。</span></p><p>&nbsp;</p><h4 id='windows中的访问控制'><span>Windows中的访问控制</span></h4><p><span>采用DAC。采用ACL。</span></p><ul><li><p><span>账户 user accounts 中包含安全id </span><strong><span>SID</span></strong><span>: 一个时间和空间唯一，全局惟一的48位数字。</span></p><p><span>eg. S-1-5-21-1507001333-120455076-1011284298-500</span></p></li><li><p><span>所有对对象的访问都要通过安全子系统的检查</span></p></li><li><p><span>系统中的所有对象都被保护起来</span></p><ul><li><p><span>文件、目录、注册表键、内核对象、同步对象、私有对象 如打印机等、管道、内存、通讯，等</span></p></li></ul></li><li><p><span>对象的安全描述符 security descriptor </span><strong><span>SD</span></strong><span>: 包含了与一个安全对象有关的安全信息</span></p><ul><li><p><span>Security identifiers (SIDs) for the owner and primary group of an object</span></p></li><li><p><span>DACL(discretionary access control list)</span></p></li><li><p><span>SACL(system access control list)</span></p></li><li><p><span>以及一组控制标记</span></p></li></ul></li><li><p><span>Security Access Token 是站在主体这方对权限的描述，是一个基本的安全单元，每个进程一个。</span></p><ul><li><p><span>用户帐户的SID</span></p></li><li><p><span>所有包含该用户的安全组的SIDs</span></p></li><li><p><span>特权：该用户和用户组所拥有的权利</span></p></li><li><p><span>Owner</span></p></li><li><p><span>Default Discretionary Access Control List</span></p></li></ul></li></ul><p><span>Win10中权限类型包括：完全控制、拒绝访问、修改、读取和执行、列出文件夹内容、读取、写入、特殊权限</span></p><p>&nbsp;</p><h3 id='授权管理方式'><span>授权管理方式</span></h3><ul><li><p><span>集中式管理：只有单个的管理者或组对用户进行访问控制授权和授权撤消。</span></p></li><li><p><span>分级式管理：一个中心管理者把管理责任分配给其它管理员，这些管理员再对用户进行访问授权和授权撤消。分级式管理可以根据组织结构而实行。</span></p></li><li><p><span>所属权管理：对每个客体设置一个拥有者 通常是客体的生成者 。拥有者是唯一有权修改客体访问控制表的主体，拥有者对其客体具有全部控制权</span></p></li><li><p><span>协作式管理：对于特定系统资源的访问不能有单个用户授权决定，而必须要其它用户的协作授权决定。</span></p></li><li><p><span>分散式管理：在分散管理中，客体所有者可以把管理权限授权给其他用户</span></p></li></ul><p>&nbsp;</p><p>&nbsp;</p><h2 id='二强制访问控制-mac'><span>二、强制访问控制 MAC</span></h2><p><span>MAC：mandatory access policy</span></p><blockquote><p><span>木马：一段进行非法操作的程序，其行为方式不会引起用户的怀疑。必须设计出某种策略诱使受骗者接受这段程序，必须使受骗者运行该程序，且入侵者必须有某种手段回收由木马发作为他带来的利益。</span></p></blockquote><p><span>在DAC 控制下，以某个用户身份运行的程序可以任意地修改该用户所拥有文件的访问控制信息，而操作系统无法区分修改信息的是一个合法用户还是一个木马。</span></p><ul><li><p><span>尽管系统可以对拥有特权的特定程序修改访问控制信息的能力进行限制，但同时会失去灵活性。</span></p></li><li><p><span>实际上，在DAC 控制下并没有办法防止木马通过共享客体（比如文件、消息和共享内存等），把消息从一个进程传给另一个进程。</span></p></li></ul><h3 id='强制访问控制的概念'><span>强制访问控制的概念</span></h3><ul><li><p><span>为每个主体(subjects)和客体(objects)赋予</span><strong><span>安全属性</span></strong><span>(security attributes)，这些属性</span><strong><span>不可以随意改变</span></strong><span>。</span></p></li><li><p><span>系统通过比较主体和客体的安全属性来决定该主体能否以期望的方式访问该客体。</span></p></li><li><p><span>反之，如果系统判定拥有某一安全属性的主体不能访问某个客体，那么任何人(包括客体的拥有者)也不能使它访问该客体。</span><em><span>所以称为“强制”</span></em></p></li><li><p><span>可以阻止进程创建共享文件，避免利用这些共享文件将敏感信息传递给另一个进程。</span></p></li></ul><p><strong><span>多级安全</span></strong><span>：将文件按不同的密级 classification 进行分类，将用户按许可级 clearance 分类。要想合法地获得信息，用户所具有的许可级别必须大于或等于信息的密级。</span></p><ul><li><p><span>多级安全系统的主要目标是实施强制机密性安全策略</span></p></li></ul><blockquote><p><span>安全集之间的支配关系</span></p><p><span>A 支配 B：即A 的密级不小于B 的密级，A 的范畴集包含B 的范畴集。</span></p><p><span>A 等于 B：即A 的密级等于B 的密级，A 的范畴集等于B 的范畴集。</span></p><p><span>A 、B 无关：即A 的范畴集不包含B 的范畴集，B 的范畴集也不包含A 的范畴集</span></p></blockquote><p>&nbsp;</p><h3 id='bell-lapadula-模型'><span>Bell-LaPadula 模型</span></h3><p><span>简单安全模型：</span><strong><span>无上读</span></strong><span>（文件安全级别大于主体的话，主体就不能阅读）</span></p><p><strong><span>无下写</span></strong><span>：级别高的程序不能往低密级文件写，因为存在信息泄露的风险。</span></p><p><span>密级：绝密 Top Secret &gt; 机密 Confidential &gt; 秘密 Secret &gt; 无密级 Unclassified</span></p><p>&nbsp;</p><h3 id='biba-模型'><span>Biba 模型</span></h3><p><span>完整性保护：</span><strong><span>无上写</span></strong><span>（低级别主体不能篡改高级别信息），可上读（读上级指令），</span><strong><span>无下读</span></strong></p><p>&nbsp;</p><h3 id='mac规则实施'><span>MAC规则实施</span></h3><p><span>主体的安全级 = 以用户身份运行的进程的安全级</span></p><ul><li><p><span>若进程以“r”( 或“x”) 方式访问客体，进程的安全级须支配客体的安全级；</span></p></li><li><p><span>若进程以“w” 方式访问客体，进程的安全级须等于客体的安全级。</span></p></li></ul><p>&nbsp;</p><p><span>如何防止木马</span></p><ul><li><p><span>Example1: 在多级安全系统中，正在机密安全级上运行的进程中的特洛伊木马不能把机密信息写入一个公开的文件里。</span><strong><span>无下写</span></strong></p></li><li><p><span>Example2: 一个公司对系统中自己拥有的信息指定一个强制存取范畴ｃ，只有该公司的雇员才可能进入这个范畴ｃ。如果它的一个雇员使用了特洛伊木马，他不可能将该公司的信息传递到ｃ范畴以外的地方去，但在范畴ｃ内部，信息可以在各个用户之间自由传递。</span></p></li></ul><p><span>在强制访问控制中，允许的访问控制完全是根据主体和客体的安全级别决定。其中主体（用户、进程）的安全级别是由系统安全管理员赋予的，而客体的安全级别则由系统根据创建它们的用户的安全级别决定。因此，强制访问控制的管理策略是比较简单的，只有安全管理员能够改变主体和客体的安全级别。</span></p><p>&nbsp;</p><h3 id='tcsec-评估等级'><span>TCSEC 评估等级</span></h3><p><img src="./信息安全引论.assets/image-20260107114810702.png" alt="image-20260107114810702" style="zoom:50%;" /></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='三基于角色的访问控制'><span>三、基于角色的访问控制</span></h2><p><span>定义角色权限，给用户分配角色。</span></p><p><span>RBAC：role-based access policy</span></p><h3 id='rbac的安全原则'><span>RBAC的安全原则</span></h3><ul><li><p><span>最小权限：只把必须的权限分配给角色</span></p></li><li><p><span>责任分离(separation of duties): 多个互斥的角色合作完成重要工作</span></p></li><li><p><span>数据抽象：可以定义抽象的权限，而不仅仅是OS 中的读、写、执行等</span></p></li></ul><h4 id='基本rbac'><span>基本RBAC</span></h4><p><span>五个基本数据元素：用户users(USERS) 、角色roles（ROLES）、目标objects（OBS）、操作operations(OPS) 、许可权permissions(PRMS)</span></p><p><span>用户通过一个会话激活一个角色，角色拥有相应的操作权限。</span></p><p>&nbsp;</p><h4 id='等级rabc'><span>等级RABC</span></h4><p><em><span>上级可以继承下级的权限。</span></em><span>通过角色的结构化分层来定义权限的继承关系。</span></p><p>&nbsp;</p><h4 id='有约束的rabc'><span>有约束的RABC</span></h4><ul><li><p><span>静态责任分离：一个人只能是一个角色 </span><em><span>不能同时当银行职员和存钱的人</span></em></p></li><li><p><span>动态责任分离：在不同的时间（不同的会话）可以拥有不同的角色</span></p></li></ul><p>&nbsp;</p><h4 id='优势'><span>优势</span></h4><blockquote><ul><li><p><span>便于授权管理，如系统管理员需要修改系统设置等内容时，必须有几个不同角色的用户到场方能操作，从而保证了安全性。</span></p></li><li><p><span>便于根据工作需要分级，如企业财务部门与非财力部门的员工对企业财务的访问权就可由财务人员这个角色来区分。</span></p></li><li><p><span>便于赋于最小特权，如即使用户被赋于高级身份时也未必一定要使用，以便减少损失。只有必要时方能拥有特权.</span></p></li><li><p><span>便于任务分担，不同的角色完成不同的任务。</span></p></li><li><p><span>便于文件分级管理，文件本身也可分为不同的角色，如信件、账单等，由不同角色的用户拥有。</span></p></li></ul></blockquote><p>&nbsp;</p><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>DAC、MAC、RBAC 可以叠加使用。</span></p></div><p>&nbsp;</p><p>&nbsp;</p><h2 id='四其他-2'><span>四、其他</span></h2><h3 id='基于任务的访问控制-tbac'><span>基于任务的访问控制 TBAC</span></h3><p><span>根据任务分配权限。任务终止权限就收回。</span></p><h3 id='基于属性的访问控制-abac'><span>基于属性的访问控制 ABAC</span></h3><p><span>可以根据各种各样的属性来赋予权限，比如</span></p><ul><li><p><span>主体属性：身份、角色、职位、年龄</span></p></li><li><p><span>资源属性：资源的身份、位置、大小</span></p></li><li><p><span>环境属性：如时间、系统状态</span></p></li></ul><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>依赖于值的控制：目标数据项无论数据值存储在哪儿，都有确定的访问控制许可。目标的敏感性会根据当前存储的数据值而改变。</span><em><span>工资高于xx的人不显示</span></em>
<span>基于上下文的控制：允许访问控制策略在确定访问一个目标时依靠外部因素（时间、位置、通信路径、鉴别强度）。</span></p></div><h3 id='基于规则的访问控制-rule-bac'><span>基于规则的访问控制 rule-BAC</span></h3><p><span>针对请求本身进行访问控制。</span></p><p><span>一个典型的例子就是防火墙。防火墙通过将请求的源 IP 和端口、目标 IP 和端口、协议等特征获取到后，根据定义好的规则，来判定是否允许主体访问。</span></p><hr /><p>&nbsp;</p><p>&nbsp;</p><h1 id='lecture-13-网络攻防技术'><span>Lecture 13. 网络攻防技术</span></h1><blockquote><p><span>黑客种类：</span></p><ul><li><p><span>飞客“phreak”：早期攻击电话网的青少年，研究各种盗打电话而不用付费的技术。</span></p></li><li><p><span>黑客“Hacker”：一个给予喜欢发现和解决技术挑战、攻击计算机网络系统的精通计算机技能的人的称号，与闯入计算机网络系统目的在于破坏和偷窃信息的骇客不同。</span></p></li><li><p><span>骇客“Cracker”：一个闯入计算机系统和网络试图破坏和偷窃个人信息的个体，与没有兴趣做破坏只是对技术上的挑战感兴趣的黑客相对应。</span></p></li><li><p><span>快客“Whacker”：从事黑客活动但没有黑客技能的人，whacker是穿透系统的人中，在技术和能力上最不复杂的一类。</span></p></li><li><p><span>武士“Samurai”：被他人雇佣的帮助他人提高网络安全的黑客，武士通常被公司付给薪金来攻击网络。</span></p></li><li><p><span>幼虫“Larva”：一个崇拜真正黑客的初级黑客</span></p></li><li><p><span>欲望蜜蜂“Wannabee”：处于幼虫的初始阶段的黑客的称呼，他们急于掌握入侵技术，但由于他们没有经验，因此即使没有恶意也可能造成很大危险</span></p></li><li><p><span>黑边黑客（Dark-Side）：是指由于种种原因放弃黑客的道德信念而恶意攻击的黑客</span></p></li><li><p><span>半仙“Demigod”：一个具有多年经验在黑客团体具有世界级声誉的黑客。</span></p></li></ul><p><span>黑客道德准则：</span>
<span>（1）通往电脑的路不止一条</span>
<span>（2）所有的信息都应当是免费和共享的</span>
<span>（3）一定要打破电脑集权</span>
<span>（4）在电脑上创造的是艺术和美</span>
<span>（5）计算机将使生活更加美好</span></p><p><span>热衷挑战、崇尚自由、主张信息共享、反叛精神、破坏心理</span></p></blockquote><p><span>网络攻击的步骤：</span></p><ol start='' ><li><p><span>信息收集，获取目标系统的信息，操作系统的类型和版本，主要提供的服务和服务进程的类型和版本，网络拓扑结构</span></p></li><li><p><span>获得对系统的访问权力</span></p></li><li><p><span>获得系统超级用户的权力。利用（2）的权力和系统的漏洞，可以修改文件，运行任何程序，留下下次入侵的缺口，或破坏整个系统</span></p></li><li><p><span>消除入侵痕迹</span></p></li></ol><p>&nbsp;</p><h2 id='一信息收集'><span>一、信息收集</span></h2><h4 id='初始信息收集'><span>初始信息收集</span></h4><p><span>可以合法地获取公开信息，比如目标机构的网页、新闻、论坛等。</span></p><ul><li><p><span>Whois数据库：查询某个IP或域名是否已注册，以及注册时的详细信息</span></p></li><li><p><span>命令行利用DNS数据库：Nslookup，linux中的host等</span></p></li><li><p><span>ping, traceroute</span></p><blockquote><p><span>“Ping of death”: 发送特大ping数据包(&gt;65535字节)导致机器崩溃, 许多老的操作系统都受影响</span></p></blockquote><p><span>可以利用防火墙来防范。</span></p></li></ul><h4 id='扫描'><span>扫描</span></h4><ul><li><p><span>主机扫描:发现系统存活情况</span></p></li><li><p><span>对端口扫描，发现哪些服务在运行</span></p></li><li><p><span>扫描器能够暴露网络上潜在的脆弱性，避免遭受不必要的攻击</span></p></li><li><p><span>操作系统指纹扫描:有进一步的功能，包括操作系统辨识、应用系统识别</span></p></li></ul><p><span>端口扫描的技术已经非常成熟，目前有大量的商业、非商业的扫描器</span></p><h5 id='端口扫描'><span>端口扫描</span></h5><ul><li><p><span>开放扫描(Open Scanning)：也称为全连接扫描，和开放的端口进行连接。会被目标主机的日志完整地记录下来。</span></p></li><li><p><span>半开扫描(Half-Open Scanning)：也称为SYN扫描，第三次握手回复一个复位的信号“RST”，不建立连接。</span></p></li><li><p><span>隐蔽扫描(Stealth Scanning)：SYNACK扫描或FIN扫描，若目标端口关闭：会回复 </span><code>RST</code><span> 包；若目标端口开放：会忽略该异常包，不做任何回复。隐蔽性最好，但不一定准确。</span></p></li></ul><p>&nbsp;</p><h2 id='二网络攻击'><span>二、网络攻击</span></h2><p><span>漏洞种类：</span></p><ul><li><p><span>内存破坏漏洞：栈缓冲区溢出、堆缓冲区溢出、格式串问题、内存释放后重用、二次释放。</span></p></li><li><p><span>逻辑错误漏洞：安全检查的实现逻辑存在问题，导致安全机制被绕过。</span></p></li><li><p><span>输入验证漏洞：对用户的输入没有充分进行检查验证就用于后续操作，主要出现在Web应用程序中，导致的后果包括：SQL注入、跨站脚本执行等。</span></p></li><li><p><span>设计错误漏洞：系统在初始设计时，对安全机制考虑不充分，导致在设计阶段就已经引入漏洞。例如早期微软公司Windows账号的散列算法LM Hash存在设计缺陷。</span></p></li><li><p><span>配置错误漏洞：系统运维过程中存在不安全的配置状态</span></p></li></ul><h3 id='拒绝服务攻击'><span>拒绝服务攻击</span></h3><h4 id='ping-of-death'><span>Ping of Death</span></h4><p><span>发送特大ping数据包(&gt;65535字节)导致机器崩溃, （有些系统在收到大量比最大包还要长的数据包，会挂起或者死机），许多老的操作系统都受影响</span></p><h4 id='ip碎片'><span>IP碎片</span></h4><p><span>发送一系列高度碎片化的过大的ICMP数据包，某些TCP/IP（包括service pack 4以前的NT）在收到含有重叠偏移的伪造分段时无法处理，会崩溃。</span></p><h5 id='teardrop'><span>Teardrop</span></h5><p><img src="./信息安全引论.assets/image-20260107144709726.png" alt="image-20260107144709726" style="zoom:40%;" /></p><h4 id='land'><span>Land</span></h4><p><span>程序发送一个TCP SYN包，源地址与目的地址相同，源端口与目的端口相同。对Land攻击反应不同，许多UNIX实现将崩溃，NT变得极其缓慢（大约持续五分钟）。</span></p><h4 id='syn-flood'><span>SYN Flood</span></h4><p><span>大量的半开连接。</span></p><h4 id='smurf'><span>Smurf</span></h4><p><span>攻击者向一个广播地址发送ICMP Echo请求，并且用受害者的IP地址作为源地址，于是，广播地址网络上的每台机器响应这些Echo请求，同时向受害者主机发送ICMP Echo-Reply应答。</span></p><p><img src="./信息安全引论.assets/image-20260107145033444.png" alt="image-20260107145033444" style="zoom:40%;" /></p><h4 id='分布式拒绝服务攻击'><span>分布式拒绝服务攻击</span></h4><p><span>多台主机合作攻击一个目标。</span></p><p><img src="./信息安全引论.assets/image-20260107140938175.png" alt="image-20260107140938175" style="zoom:50%;" /></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='三防火墙技术'><span>三、防火墙技术</span></h2><blockquote><p><span>防火墙局限性：</span></p><ul><li><p><span>限制或关闭了一些有用但存在安全缺陷的网络服务，给用户带来使用的不便。</span></p></li><li><p><span>目前防火墙对于来自网络内部的攻击还无能为力。</span></p></li><li><p><span>防火墙不能防范不经过防火墙的攻击。</span></p></li><li><p><span>可能带来传输延迟、瓶颈及单点失效。</span></p></li><li><p><span>防火墙不能有效地防范</span>[<span>数据驱动式攻击</span>][通过向某个程序发送数据，以产生非预期结果的攻击。eg. 数组越界]<span>。</span></p></li><li><p><span>作为一种被动的防护手段，防火墙不能防范因特网上不断出现的新的威胁和攻击。</span></p></li></ul></blockquote><h3 id='防火墙体系结构'><span>防火墙体系结构</span></h3><ul><li><p><span>堡垒主机 Bastion Host：堡垒主机是一种配置了安全防范措施的网络上的计算机，堡垒主机为网络之间的通信提供了一个阻塞点，也就是说如果没有堡垒主机，网络之间将不能相互访问。</span></p></li><li><p><span>双宿主机 Dual-homed Host：有两个网络接口的计算机系统，一个接口接内部网，一个接口接外部网.</span></p></li><li><p><span>DMZ(Demilitarized Zone，非军事区或者停火区)：在内部网络和外部网络之间增加的一个子网</span></p></li></ul><ol start='' ><li><p><span>包过滤型防火墙</span></p></li><li><p><span>双宿/多宿主机模式：防火墙拥有两个或多个连接到不同网络上的网络接口。</span></p></li><li><p><span>屏蔽主机防火墙：由包过滤路由器和堡垒主机组成。堡垒主机可以实现应用层的一些控制。</span><em><span>实现的关键在于过滤路由器是否配置正确。需要保证堡垒主机不被越过。</span></em></p><p><img src="./信息安全引论.assets/image-20260107142051980.png" alt="image-20260107142051980" style="zoom:40%;" /></p></li><li><p><span>屏蔽子网模式：内部网络和外部网络均可访问屏蔽子网，但禁止它们穿过屏蔽子网通信。在这一配置中，即使堡垒主机被入侵者控制，内部网仍受到内部包过滤路由器的保护。</span></p><p><img src="./信息安全引论.assets/image-20260107142410556.png" alt="image-20260107142410556" style="zoom:40%;" /></p></li><li><p><span>等等等等。</span></p></li></ol><h3 id='防火墙具体技术'><span>防火墙具体技术</span></h3><h4 id='静态包过滤'><span>静态包过滤</span></h4><p><span>根据流经该设备的数据包头信息，决定是否允许该数据包通过</span></p><p><span>重要的约定：</span></p><ul><li><p><span>访问规则要使用IP地址，而不使用主机名或域名</span></p></li><li><p><span>不回应外部网络来的ICMP包</span></p></li><li><p><span>要丢弃所有通过外部网络适配器流入，且其源地址是来自受保护网络的包（一般是伪造了假IP地址）</span></p></li></ul><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>其他常用设置：</span></p><ul><li><p><span>SYN 洪泛攻击：通过监视日志文件，让不断发送SYN置位包的主机不能通过防火墙。</span></p></li><li><p><span>只允许ACK=1的外部包进入，这样使得外部包只能响应，无法主动发起连接。</span></p></li></ul></div><h5 id='针对包过滤防火墙的攻击'><span>针对包过滤防火墙的攻击</span></h5><ol start='' ><li><p><span>IP地址欺骗：假冒内部IP地址</span></p><ul><li><p><span>Sol. 在外部接口上阻止内部IP地址进入</span></p></li></ul></li><li><p><span>源路由攻击，即由源指定路由试图绕过防火墙</span></p><ul><li><p><span>Sol. 禁止这样的选项</span></p></li></ul></li><li><p><span>小碎片攻击，利用IP分片功能把TCP头部切分到不同的分片中</span></p><ul><li><p><span>对策：丢弃分片太小的分片</span></p></li></ul></li><li><p><span>利用复杂协议和管理员的配置失误进入防火墙，比如利用一些可以通过的协议对内部进行探查</span></p></li></ol><h5 id='静态包过滤的特点'><span>静态包过滤的特点</span></h5><ul><li><p><span>优点：逻辑简单，价格便宜，对网络性能的影响较小，有较强的透明性。并且它的工作与应用层无关，无须改动任何客户机和主机上的应用程序，易于安装和使用。</span></p></li><li><p><span>弱点：需要非常了解各个协议，从而配置出恰当的过滤条件。只考虑了传输层和网络层的条件。</span></p><p>&nbsp;</p></li></ul><h4 id='动态包过滤'><span>动态包过滤</span></h4><p><span>防火墙跟踪客户端口，可动态生成/删除规则，而不是打开全部高编号端口给外部访问，因而更安全。</span></p><ul><li><p><span>优点：这类防火墙减少了端口的开放时间，提供了对几乎所有服务的支持。</span></p></li><li><p><span>缺点：不提供用户的鉴别机制。</span></p><p>&nbsp;</p></li></ul><h4 id='应用程序网关代理服务器'><span>应用程序网关（代理服务器）</span></h4><blockquote><p><span>只有应用层有用户身份信息</span></p></blockquote><p><img src="./信息安全引论.assets/image-20260104171932619.png" alt="image-20260104171932619" style="zoom:50%;" /></p><p><span>网关理解应用协议，可以实施更细粒度的访问控制。对每一类应用，都需要一个专门的代理</span></p><ul><li><p><span>优点：可以与鉴别、授权等安全手段方便的集成。非常安全。</span></p></li><li><p><span>缺点：灵活性不够。速度慢。</span></p><p>&nbsp;</p></li></ul><h4 id='电路级网关'><span>电路级网关</span></h4><p><span>在TCP层实现“应用程序网关”。</span></p><ul><li><p><span>优点：效率高。通用性强，为一般的应用提供了一个框架。</span></p></li><li><p><span>缺点：应用程序还需要再修改。</span></p></li></ul><p>&nbsp;</p><h4 id='深度包检查技术'><span>深度包检查技术</span></h4><p><span>深度包检查（deep packet inspection，DPI）也称为完全包检查（complete packet inspection）和信息提取（Information extraction）。</span></p><p>&nbsp;</p><h4 id='分布式防火墙'><span>分布式防火墙</span></h4><blockquote><p><span>传统防火墙：依赖于防火墙一端可信，另一端是潜在的敌人。过于依赖物理拓扑结构。如果内网内部有机器被攻破，就内网全被破了。</span></p><p><span>现代防火墙：有个人电脑防火的需求。</span></p></blockquote><p><span>以安全策略来划分内外网。</span></p><p>&nbsp;</p><h4 id='防火墙设置技术'><span>防火墙设置技术</span></h4><p><span>可以硬件实现（ASIC）、软件实现。</span></p><h5 id='双机热备'><span>双机热备</span></h5><p><img src="./信息安全引论.assets/image-20260105115404431.png" alt="image-20260105115404431" style="zoom:50%;" /></p><h5 id='负载均衡'><span>负载均衡</span></h5><p><img src="./信息安全引论.assets/image-20260105115825104.png" alt="image-20260105115825104" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='其他技术'><span>其他技术</span></h4><ul><li><p><span>VPN</span></p></li><li><p><span>NAT（则可以向外界隐藏内部网结构）</span></p></li><li><p><span>IP与MAC绑定（防止假冒IP）</span></p></li><li><p><span>...</span></p></li></ul><hr /><p>&nbsp;</p><h1 id='lecture-14-安全电子邮件'><span>Lecture 14. 安全电子邮件</span></h1><h2 id='一电子邮件安全问题'><span>一、电子邮件安全问题</span></h2><p><span>安全的电子邮件主要是解决身份鉴别和保密性的安全问题。涉及到的问题：</span></p><ol start='' ><li><p><span>安全算法的选择</span></p></li><li><p><span>系统邮件的信息格式：ASCII 文本可以直接发送，非ASCII文本通过编码转换为ASCII文本后发送</span></p></li><li><p><span>如何实现鉴别和信任管理：公钥、如何相信公钥</span></p><blockquote><p><span>PGP密钥：公钥环、私钥环，简单的信任模型，相当于把一个朋友介绍给另一个朋友</span>
<span>X.509只能被签名者签名一次</span>
<span>PEM简单的而又严格的全球认证分级</span></p></blockquote></li><li><p><span>邮件服务器的可靠性</span></p><blockquote><p><span>防止来自外部的攻击：拒绝来自特定地址的连接请求、限制单个IP的连接数量</span>
<span>防止来自内部的攻击：实现用户身份的鉴别</span></p></blockquote></li></ol><p>&nbsp;</p><h2 id='二pgp'><span>二、PGP</span></h2><blockquote><p><span>PGP - Pretty Good Privacy</span></p><p><span>作者：Phil Zimmermann</span></p><p><span>PGP 已成为Internet 标准文档（RFC 3156）</span></p></blockquote><p><span>PGP 用于对文本、电子邮件、文件、目录和整个磁盘分区进行签名、加密和解密等安全服务。</span></p><ul><li><p><span>数字签名、消息加密、数据压缩、邮件兼容、数据分段</span></p></li></ul><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>PGP成功的原因：</span></p><ol start='' ><li><p><span>选用生命力和安全性已经得到公众认可的算法。</span></p></li><li><p><span>提供免费版本，且可用于多种平台，如Windows、Unix、Linux、Mac OSX，商业版本使用户得到很好的技术支持。</span></p></li><li><p><span>不由政府或标准化组织控制。</span></p></li></ol></div><h3 id='过程'><span>过程</span></h3><h4 id='签名过程'><span>签名过程</span></h4><p><img src="./信息安全引论.assets/image-20260105165657787.png" alt="image-20260105165657787" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='发送过程'><span>发送过程</span></h4><ol start='' ><li><p><span>随机产生一个对话密钥</span></p></li><li><p><span>压缩消息，并用对话密钥加密压缩后的消息（在压缩之前签名）</span></p></li><li><p><span>用对方的公钥加密对话密钥</span></p></li><li><p><span>把加密后的消息和加密后的对话密钥一起发给对方</span></p></li></ol><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p><span>如果同时给十个人发送邮件，那么只要产生一个会话密钥，用十个人的公钥分别加密后发送即可。这样内容只需要加密一次。</span></p></div><p>&nbsp;</p><h3 id='其他技术-2'><span>其他技术</span></h3><h4 id='公钥管理'><span>公钥管理</span></h4><p><span>自己选择自己信任的人</span></p><p>&nbsp;</p><h4 id='e-mail-兼容性'><span>E-mail 兼容性</span></h4><p><span>加密后是任意的8位字节，需要转换到ASCII格式。</span></p><ul><li><p><span>Radix64 将3字节输入转换到4个ASCII字符，并带CRC校验。</span><em><span>长度扩大33%</span></em></p></li><li><p><span>与压缩综合后，长度为：1.33x0.5xM = 0.665xM</span></p></li></ul><p>&nbsp;</p><h4 id='公钥环和私钥环'><span>公钥环和私钥环</span></h4><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><blockquote><p><span>一个用户有多个公钥/私钥对时，接收者如何知道发送者是用了哪个公钥来加密会话密钥？</span></p></blockquote><p><span>将公钥与消息一起传送太大了，所以传</span><strong><span>密钥标识符</span></strong><span>。</span></p><ul><li><p><span>定义KeyID 包括64个有效位：(KUa mod 2</span><sup><span>64</span></sup><span>)</span></p></li></ul><p><em><span>KeyID同样也需要PGP数字签名。</span></em></p></div><p><span>PGP在每一个节点上提供一对数据结构：</span></p><ul><li><p><span>存储该节点拥有的公钥/私钥对；（私钥环）</span></p></li><li><p><span>存储本节点知道的其他用户的公钥；（公钥环）</span></p></li></ul><p><img src="./信息安全引论.assets/image-20260106095150950.png" alt="image-20260106095150950" style="zoom:50%;" /></p><p>&nbsp;</p><h4 id='证书-2'><span>证书</span></h4><p><span>PGP支持两种形式的证书：PGP证书与X.509证书（Root CA）</span></p><h5 id='pgp信任模型'><span>PGP信任模型</span></h5><ol start='' ><li><p><span>Direct Trust</span></p><p><img src="./信息安全引论.assets/image-20260106100421267.png" alt="image-20260106100421267" style="zoom:33%;" /></p></li><li><p><span>Hierarchical Trust</span></p><p><img src="./信息安全引论.assets/image-20260106100438356.png" alt="image-20260106100438356" style="zoom:30%;" /></p></li><li><p><span>A Web of Trust</span></p><p><em><span>中间有一点的表示我对它签名了（认为它的公钥是真的）</span></em></p><p><em><span>箭头表示被签名。</span></em></p><p><em><span>灰色表示完全信任，完全信任者签名的人那我也相信它的公钥是真的。</span></em></p><p><em><span>半灰色表示半信任，两个半信任都对一人签名了（A&amp;B--&gt;H）那我就相信它的公钥是真的。</span></em></p><p><img src="./信息安全引论.assets/image-20260106095757174.png" alt="image-20260106095757174" style="zoom:50%;" /></p><hr /><p>&nbsp;</p></li></ol></div></div>
</body>
</html>